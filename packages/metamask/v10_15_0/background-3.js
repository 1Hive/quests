LavaPack.loadBundle([[2395,{"@ethereumjs/tx":409,buffer:1996,"ethereumjs-util":2437,events:1997,hdkey:2396,"trezor-connect":5879,"trezor-connect/lib/plugins/ethereum/typedData":5882},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const{EventEmitter:n}=e("events"),i=e("ethereumjs-util"),s=e("hdkey"),a=e("trezor-connect").default,{TransactionFactory:o}=e("@ethereumjs/tx"),c=e("trezor-connect/lib/plugins/ethereum/typedData"),u="m/44'/60'/0'/0",l={[u]:!0,"m/44'/1'/0'/0":!0},f="Trezor Hardware",h=1e3,d={email:"support@metamask.io",appUrl:"https://metamask.io"};function p(e){return new Promise((t=>setTimeout(t,e)))}function g(e){return"function"==typeof e.getChainId}class m extends n{constructor(e={}){super(),this.type=f,this.accounts=[],this.hdk=new s,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},this.deserialize(e),a.on("DEVICE_EVENT",(e=>{e&&e.payload&&e.payload.features&&(this.model=e.payload.features.model)})),a.init({manifest:d})}getModel(){return this.model}dispose(){a.dispose()}serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}deserialize(e={}){return this.hdPath=e.hdPath||u,this.accounts=e.accounts||[],this.page=e.page||0,this.perPage=e.perPage||5,Promise.resolve()}isUnlocked(){return Boolean(this.hdk&&this.hdk.publicKey)}unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((e,t)=>{a.getPublicKey({path:this.hdPath,coin:"ETH"}).then((n=>{n.success?(this.hdk.publicKey=r.from(n.payload.publicKey,"hex"),this.hdk.chainCode=r.from(n.payload.chainCode,"hex"),e("just unlocked")):t(new Error(n.payload&&n.payload.error||"Unknown error"))})).catch((e=>{t(new Error(e&&e.toString()||"Unknown error"))}))}))}setAccountToUnlock(e){this.unlockedAccount=parseInt(e,10)}addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((r=>{const n=this.unlockedAccount,i=n+e;for(let e=n;e<i;e++){const t=this._addressFromIndex("m",e);this.accounts.includes(t)||this.accounts.push(t),this.page=0}t(this.accounts)})).catch((e=>{r(e)}))}))}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}__getPage(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise(((e,t)=>{this.unlock().then((t=>{const r=(this.page-1)*this.perPage,n=r+this.perPage,s=[];for(let e=r;e<n;e++){const t=this._addressFromIndex("m",e);s.push({address:t,balance:null,index:e}),this.paths[i.toChecksumAddress(t)]=e}e(s)})).catch((e=>{t(e)}))}))}getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}signTransaction(e,t){return g(t)?this._signTransaction(e,t.getChainId(),t,(e=>(t.v=r.from(e.v,"hex"),t.r=r.from(e.r,"hex"),t.s=r.from(e.s,"hex"),t))):this._signTransaction(e,t.common.chainIdBN().toNumber(),t,(e=>{const r=t.toJSON();return r.type=t.type,r.v=i.addHexPrefix(e.v),r.r=i.addHexPrefix(e.r),r.s=i.addHexPrefix(e.s),o.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})}))}async _signTransaction(e,t,r,n){let s;s=g(r)?{to:this._normalize(r.to),value:this._normalize(r.value),data:this._normalize(r.data),chainId:t,nonce:this._normalize(r.nonce),gasLimit:this._normalize(r.gasLimit),gasPrice:this._normalize(r.gasPrice)}:{...r.toJSON(),chainId:t,to:this._normalize(r.to)};try{const t=await this.unlock();await p("just unlocked"===t?h:0);const r=await a.ethereumSignTransaction({path:this._pathFromAddress(e),transaction:s});if(r.success){const t=n(r.payload),s=i.toChecksumAddress(i.addHexPrefix(t.getSenderAddress().toString("hex")));if(s!==i.toChecksumAddress(e))throw new Error("signature doesn't match the right address");return t}throw new Error(r.payload&&r.payload.error||"Unknown error")}catch(e){throw new Error(e&&e.toString()||"Unknown error")}}signMessage(e,t){return this.signPersonalMessage(e,t)}signPersonalMessage(e,t){return new Promise(((r,n)=>{this.unlock().then((s=>{setTimeout((s=>{a.ethereumSignMessage({path:this._pathFromAddress(e),message:i.stripHexPrefix(t),hex:!0}).then((t=>{if(t.success){t.payload.address!==i.toChecksumAddress(e)&&n(new Error("signature doesnt match the right address"));const s=`0x${t.payload.signature}`;r(s)}else n(new Error(t.payload&&t.payload.error||"Unknown error"))})).catch((e=>{n(new Error(e&&e.toString()||"Unknown error"))}))}),"just unlocked"===s?h:0)})).catch((e=>{n(new Error(e&&e.toString()||"Unknown error"))}))}))}async signTypedData(e,t,{version:r}){const n=c(t,"V4"===r),{types:{EIP712Domain:s=[],...o}={},message:u={},domain:l={},primaryType:f,domain_separator_hash:d,message_hash:g}=n,m=await this.unlock();await p("just unlocked"===m?h:0);const _=await a.ethereumSignTypedData({path:this._pathFromAddress(e),data:{types:{EIP712Domain:s,...o},message:u,domain:l,primaryType:f},metamask_v4_compat:!0,domain_separator_hash:d,message_hash:g});if(_.success){if(i.toChecksumAddress(e)!==_.payload.address)throw new Error("signature doesnt match the right address");return _.payload.signature}throw new Error(_.payload&&_.payload.error||"Unknown error")}exportAccount(){return Promise.reject(new Error("Not supported on this device"))}forgetDevice(){this.accounts=[],this.hdk=new s,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!l[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new s,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}_normalize(e){return i.bufferToHex(e).toString()}_addressFromIndex(e,t){const r=this.hdk.derive(`${e}/${t}`),n=i.publicToAddress(r.publicKey,!0).toString("hex");return i.toChecksumAddress(`0x${n}`)}_pathFromAddress(e){const t=i.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===this._addressFromIndex("m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`}}m.type=f,t.exports=m}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-trezor-keyring"}],[2396,{assert:1615,coinstring:2039,crypto:2106,"safe-buffer":5660,secp256k1:2397},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("assert"),i=e("safe-buffer").Buffer,s=e("crypto"),a=e("coinstring"),o=e("secp256k1"),c=i.from("Bitcoin seed","utf8"),u=2147483648,l={private:76066276,public:76067358};function f(e){this.versions=e||l,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function h(e,t,r){var n=i.allocUnsafe(78);n.writeUInt32BE(t,0),n.writeUInt8(e.depth,4);var s=e.depth?e.parentFingerprint:0;return n.writeUInt32BE(s,5),n.writeUInt32BE(e.index,9),e.chainCode.copy(n,13),r.copy(n,45),n}function d(e){var t=s.createHash("sha256").update(e).digest();return s.createHash("rmd160").update(t).digest()}Object.defineProperty(f.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(f.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(f.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(f.prototype,"privateKey",{get:function(){return this._privateKey},set:function(e){n.equal(e.length,32,"Private key must be 32 bytes."),n(!0===o.privateKeyVerify(e),"Invalid private key"),this._privateKey=e,this._publicKey=o.publicKeyCreate(e,!0),this._identifier=d(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(f.prototype,"publicKey",{get:function(){return this._publicKey},set:function(e){n(33===e.length||65===e.length,"Public key must be 33 or 65 bytes."),n(!0===o.publicKeyVerify(e),"Invalid public key"),this._publicKey=o.publicKeyConvert(e,!0),this._identifier=d(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(f.prototype,"privateExtendedKey",{get:function(){return this._privateKey?a.encode(h(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(f.prototype,"publicExtendedKey",{get:function(){return a.encode(h(this,this.versions.public,this.publicKey))}}),f.prototype.derive=function(e){if("m"===e||"M"===e||"m'"===e||"M'"===e)return this;var t=e.split("/"),r=this;return t.forEach((function(e,t){if(0!==t){var i=e.length>1&&"'"===e[e.length-1],s=parseInt(e,10);n(s<u,"Invalid index"),i&&(s+=u),r=r.deriveChild(s)}else n(e,"m","Invalid path")})),r},f.prototype.deriveChild=function(e){var t,r=e>=u,a=i.allocUnsafe(4);if(a.writeUInt32BE(e,0),r){n(this.privateKey,"Could not derive hardened child key");var c=this.privateKey,l=i.alloc(1,0);c=i.concat([l,c]),t=i.concat([c,a])}else t=i.concat([this.publicKey,a]);var h=s.createHmac("sha512",this.chainCode).update(t).digest(),d=h.slice(0,32),p=h.slice(32),g=new f(this.versions);if(this.privateKey)try{g.privateKey=o.privateKeyTweakAdd(this.privateKey,d)}catch(t){return this.derive(e+1)}else try{g.publicKey=o.publicKeyTweakAdd(this.publicKey,d,!0)}catch(t){return this.derive(e+1,r)}return g.chainCode=p,g.depth=this.depth+1,g.parentFingerprint=this.fingerprint,g.index=e,g},f.prototype.sign=function(e){return o.sign(e,this.privateKey).signature},f.prototype.verify=function(e,t){return o.verify(e,t,this.publicKey)},f.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},f.fromMasterSeed=function(e,t){var r=s.createHmac("sha512",c).update(e).digest(),n=r.slice(0,32),i=r.slice(32),a=new f(t);return a.chainCode=i,a.privateKey=n,a},f.fromExtendedKey=function(e,t){var r=new f(t=t||l),i=a.decode(e),s=i.readUInt32BE(0);n(s===t.private||s===t.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var o=i.slice(45);return 0===o.readUInt8(0)?(n(s===t.private,"Version mismatch: version does not match private"),r.privateKey=o.slice(1)):(n(s===t.public,"Version mismatch: version does not match public"),r.publicKey=o),r},f.fromJSON=function(e){return f.fromExtendedKey(e.xpriv)},f.HARDENED_OFFSET=u,t.exports=f}}},{package:"eth-trezor-keyring>hdkey"}],[2397,{"./lib":2401,"./lib/elliptic":2400},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"eth-trezor-keyring>hdkey>secp256k1"}],[2398,{"../../../../is-buffer/index.js":4601},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var t=Object.prototype.toString;r.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},r.isBoolean=function(e,r){if("[object Boolean]"!==t.call(e))throw TypeError(r)},r.isBuffer=function(t,r){if(!e.isBuffer(t))throw TypeError(r)},r.isFunction=function(e,r){if("[object Function]"!==t.call(e))throw TypeError(r)},r.isNumber=function(e,r){if("[object Number]"!==t.call(e))throw TypeError(r)},r.isObject=function(e,r){if("[object Object]"!==t.call(e))throw TypeError(r)},r.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},r.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},r.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},r.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}}).call(this)}).call(this,{isBuffer:e("../../../../is-buffer/index.js")})}}},{package:"eth-trezor-keyring>hdkey>secp256k1"}],[2399,{bip66:1885,"safe-buffer":5660},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("bip66"),s=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(e,t,r){var i=n.from(r?s:a);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},r.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2||t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},r.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,s=0;r>1&&0===t[s]&&!(128&t[s+1]);--r,++s);for(var a=n.concat([n.from([0]),e.s]),o=33,c=0;o>1&&0===a[c]&&!(128&a[c+1]);--o,++c);return i.encode(t.slice(s),a.slice(c))},r.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var s=i.decode(e);if(33===s.r.length&&0===s.r[0]&&(s.r=s.r.slice(1)),s.r.length>32)throw new Error("R length is too long");if(33===s.s.length&&0===s.s[0]&&(s.s=s.s.slice(1)),s.s.length>32)throw new Error("S length is too long")}catch(e){return}return s.r.copy(t,32-s.r.length),s.s.copy(r,32-s.s.length),{r:t,s:r}},r.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,s=0;if(48===e[s++]){var a=e[s++];if(!(128&a&&(s+=a-128)>i)&&2===e[s++]){var o=e[s++];if(128&o){if(s+(a=o-128)>i)return;for(;a>0&&0===e[s];s+=1,a-=1);for(o=0;a>0;s+=1,a-=1)o=(o<<8)+e[s]}if(!(o>i-s)){var c=s;if(s+=o,2===e[s++]){var u=e[s++];if(128&u){if(s+(a=u-128)>i)return;for(;a>0&&0===e[s];s+=1,a-=1);for(u=0;a>0;s+=1,a-=1)u=(u<<8)+e[s]}if(!(u>i-s)){var l=s;for(s+=u;o>0&&0===e[c];o-=1,c+=1);if(!(o>32)){var f=e.slice(c,c+o);for(f.copy(t,32-f.length);u>0&&0===e[l];u-=1,l+=1);if(!(u>32)){var h=e.slice(l,l+u);return h.copy(r,32-h.length),{r:t,s:r}}}}}}}}}}}},{package:"eth-trezor-keyring>hdkey>secp256k1"}],[24,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WALLET_PREFIX=r.NOTIFICATION_NAMES=r.LOG_METHOD_TYPES=r.LOG_LIMIT=r.LOG_IGNORE_METHODS=void 0;r.WALLET_PREFIX="wallet_";r.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"};r.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"];r.LOG_METHOD_TYPES={restricted:"restricted",internal:"internal"};r.LOG_LIMIT=100}}},{package:"$root$"}],[240,{multihashes:235},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i={checkCIDComponents:function(e){if(null==e)return"null values are not valid CIDs";if(0!==e.version&&1!==e.version)return"Invalid version, must be a number equal to 1 or 0";if("string"!=typeof e.codec)return"codec must be string";if(0===e.version){if("dag-pb"!==e.codec)return"codec must be 'dag-pb' for CIDv0";if("base58btc"!==e.multibaseName)return"multibaseName must be 'base58btc' for CIDv0"}if(!(e.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{n.validate(e.multihash)}catch(e){let t=e.message;return t||(t="Multihash validation failed"),t}}};t.exports=i}}},{package:"@ensdomains/content-hash>cids"}],[2400,{"../messages.json":2402,"bn.js":1952,"create-hash":2099,elliptic:2230,"safe-buffer":5660},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=e("create-hash"),s=e("bn.js"),a=e("elliptic").ec,o=e("../messages.json"),c=new a("secp256k1"),u=c.curve;function l(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(u.p)>=0)return null;var n=(r=r.toRed(u.red)).redSqr().redIMul(r).redIAdd(u.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),c.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(u.p)>=0||i.cmp(u.p)>=0)return null;if(n=n.toRed(u.red),i=i.toRed(u.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var a=n.redSqr().redIMul(n);return i.redSqr().redISub(a.redIAdd(u.b)).isZero()?c.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}r.privateKeyVerify=function(e){var t=new s(e);return t.cmp(u.n)<0&&!t.isZero()},r.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(o.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(c.keyFromPrivate(e).getPublic(t,!0))},r.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):u.n.sub(t).umod(u.n).toArrayLike(n,"be",32)},r.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(u.n)>=0||t.isZero())throw new Error(o.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(u.n).toArrayLike(n,"be",32)},r.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(u.n)>=0)throw new Error(o.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(u.n)>=0&&r.isub(u.n),r.isZero())throw new Error(o.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},r.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(u.n)>=0||r.isZero())throw new Error(o.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(u.n)&&(r=r.umod(u.n)),r.toArrayLike(n,"be",32)},r.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(o.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(c.keyFromPrivate(e).getPublic(t,!0))},r.publicKeyConvert=function(e,t){var r=l(e);if(null===r)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},r.publicKeyVerify=function(e){return null!==l(e)},r.publicKeyTweakAdd=function(e,t,r){var i=l(e);if(null===i)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(u.n)>=0)throw new Error(o.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var a=u.g.mul(t).add(i.pub);if(a.isInfinity())throw new Error(o.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(a.encode(!0,r))},r.publicKeyTweakMul=function(e,t,r){var i=l(e);if(null===i)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(u.n)>=0||t.isZero())throw new Error(o.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},r.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=l(e[i]),null===r[i])throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,a=1;a<r.length;++a)s=s.add(r[a].pub);if(s.isInfinity())throw new Error(o.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},r.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(u.n)>=0||r.cmp(u.n)>=0)throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(c.nh)&&u.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},r.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(u.n)>=0||new s(r).cmp(u.n)>=0)throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},r.signatureImport=function(e){var t=new s(e.r);t.cmp(u.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(u.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},r.sign=function(e,t,r,i){if("function"==typeof r){var a=r;r=function(r){var c=a(e,t,null,i,r);if(!n.isBuffer(c)||32!==c.length)throw new Error(o.ECDSA_SIGN_FAIL);return new s(c)}}var l=new s(t);if(l.cmp(u.n)>=0||l.isZero())throw new Error(o.ECDSA_SIGN_FAIL);var f=c.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([f.r.toArrayLike(n,"be",32),f.s.toArrayLike(n,"be",32)]),recovery:f.recoveryParam}},r.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),a=new s(n.s);if(i.cmp(u.n)>=0||a.cmp(u.n)>=0)throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);if(1===a.cmp(c.nh)||i.isZero()||a.isZero())return!1;var f=l(r);if(null===f)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);return c.verify(e,n,{x:f.pub.x,y:f.pub.y})},r.recover=function(e,t,r,i){var a={r:t.slice(0,32),s:t.slice(32,64)},l=new s(a.r),f=new s(a.s);if(l.cmp(u.n)>=0||f.cmp(u.n)>=0)throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);try{if(l.isZero()||f.isZero())throw new Error;var h=c.recoverPubKey(e,a,r);return n.from(h.encode(!0,i))}catch(e){throw new Error(o.ECDSA_RECOVER_FAIL)}},r.ecdh=function(e,t){var n=r.ecdhUnsafe(e,t,!0);return i("sha256").update(n).digest()},r.ecdhUnsafe=function(e,t,r){var i=l(e);if(null===i)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);var a=new s(t);if(a.cmp(u.n)>=0||a.isZero())throw new Error(o.ECDH_FAIL);return n.from(i.pub.mul(a).encode(!0,r))}}}},{package:"eth-trezor-keyring>hdkey>secp256k1"}],[2401,{"./assert":2398,"./der":2399,"./messages.json":2402},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./assert"),i=e("./der"),s=e("./messages.json");function a(e,t){return e===undefined?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}t.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=a(r,!0);var o=e.privateKeyExport(t,r);return i.privateKeyExport(t,o,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=a(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=a(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=a(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=a(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=a(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var a=null,o=null;return i!==undefined&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),i.data!==undefined&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),a=i.data),i.noncefn!==undefined&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),o=i.noncefn)),e.sign(t,r,o,a)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,o){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),o=a(o,!0),e.recover(t,r,i,o)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=a(i,!0),e.ecdhUnsafe(t,r,i)}}}}}},{package:"eth-trezor-keyring>hdkey>secp256k1"}],[2402,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={COMPRESSED_TYPE_INVALID:"compressed should be a boolean",EC_PRIVATE_KEY_TYPE_INVALID:"private key should be a Buffer",EC_PRIVATE_KEY_LENGTH_INVALID:"private key length is invalid",EC_PRIVATE_KEY_RANGE_INVALID:"private key range is invalid",EC_PRIVATE_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting private key is invalid",EC_PRIVATE_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PRIVATE_KEY_EXPORT_DER_FAIL:"couldn't export to DER format",EC_PRIVATE_KEY_IMPORT_DER_FAIL:"couldn't import from DER format",EC_PUBLIC_KEYS_TYPE_INVALID:"public keys should be an Array",EC_PUBLIC_KEYS_LENGTH_INVALID:"public keys Array should have at least 1 element",EC_PUBLIC_KEY_TYPE_INVALID:"public key should be a Buffer",EC_PUBLIC_KEY_LENGTH_INVALID:"public key length is invalid",EC_PUBLIC_KEY_PARSE_FAIL:"the public key could not be parsed or is invalid",EC_PUBLIC_KEY_CREATE_FAIL:"private was invalid, try again",EC_PUBLIC_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting public key is invalid",EC_PUBLIC_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PUBLIC_KEY_COMBINE_FAIL:"the sum of the public keys is not valid",ECDH_FAIL:"scalar was invalid (zero or overflow)",ECDSA_SIGNATURE_TYPE_INVALID:"signature should be a Buffer",ECDSA_SIGNATURE_LENGTH_INVALID:"signature length is invalid",ECDSA_SIGNATURE_PARSE_FAIL:"couldn't parse signature",ECDSA_SIGNATURE_PARSE_DER_FAIL:"couldn't parse DER signature",ECDSA_SIGNATURE_SERIALIZE_DER_FAIL:"couldn't serialize signature to DER format",ECDSA_SIGN_FAIL:"nonce generation function failed or private key is invalid",ECDSA_RECOVER_FAIL:"couldn't recover public key from signature",MSG32_TYPE_INVALID:"message should be a Buffer",MSG32_LENGTH_INVALID:"message length is invalid",OPTIONS_TYPE_INVALID:"options should be an Object",OPTIONS_DATA_TYPE_INVALID:"options.data should be a Buffer",OPTIONS_DATA_LENGTH_INVALID:"options.data length is invalid",OPTIONS_NONCEFN_TYPE_INVALID:"options.noncefn should be a Function",RECOVERY_ID_TYPE_INVALID:"recovery should be a Number",RECOVERY_ID_VALUE_INVALID:"recovery should have value between -1 and 4",TWEAK_TYPE_INVALID:"tweak should be a Buffer",TWEAK_LENGTH_INVALID:"tweak length is invalid"}}}},{package:"eth-trezor-keyring>hdkey>secp256k1"}],[241,{"./cid-util":240,multibase:223,multicodec:231,multihashes:235,"uint8arrays/concat":236,"uint8arrays/equals":237,"uint8arrays/to-string":239},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i=e("multibase"),s=e("multicodec"),a=e("./cid-util"),o=e("uint8arrays/concat"),c=e("uint8arrays/to-string"),u=e("uint8arrays/equals"),l=s.nameToCode,f=Object.keys(l).reduce(((e,t)=>(e[l[t]]=t,e)),{}),h=Symbol.for("@ipld/js-cid/CID");class d{constructor(e,t,r,a){if(this.version,this.codec,this.multihash,Object.defineProperty(this,h,{value:!0}),d.isCID(e)){const t=e;return this.version=t.version,this.codec=t.codec,this.multihash=t.multihash,void(this.multibaseName=t.multibaseName||(0===t.version?"base58btc":"base32"))}if("string"==typeof e){const t=i.isEncoded(e);if(t){const r=i.decode(e);this.version=parseInt(r[0].toString(),16),this.codec=s.getCodec(r.slice(1)),this.multihash=s.rmPrefix(r.slice(1)),this.multibaseName=t}else this.version=0,this.codec="dag-pb",this.multihash=n.fromB58String(e),this.multibaseName="base58btc";return d.validateCID(this),void Object.defineProperty(this,"string",{value:e})}if(e instanceof Uint8Array){const t=parseInt(e[0].toString(),16);if(1===t){const r=e;this.version=t,this.codec=s.getCodec(r.slice(1)),this.multihash=s.rmPrefix(r.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";d.validateCID(this)}else this.version=e,"number"==typeof t&&(t=f[t]),this.codec=t,this.multihash=r,this.multibaseName=a||(0===e?"base58btc":"base32"),d.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");{const t=s.getCodeVarint(this.codec);e=o([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}}Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){const e=s.getCodeVarint(this.codec),t=n.prefix(this.multihash);return o([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return l[this.codec]}toV0(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:e,length:t}=n.decode(this.multihash);if("sha2-256"!==e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==t)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new d(0,this.codec,this.multihash)}toV1(){return new d(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&0!==this.string.length&&e===this.multibaseName)return this.string;let t;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=n.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=c(i.encode(e,this.bytes))}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&u(this.multihash,e.multihash)}static validateCID(e){const t=a.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof d||Boolean(e&&e[h])}}d.codecs=l,t.exports=d}}},{package:"@ensdomains/content-hash>cids"}],[242,{buffer:1996},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer");t.exports=class{constructor(e,t,r,i){this.name=e,this.code=t,this.codeBuf=n.from(this.code),this.alphabet=i,this.engine=r(i)}encode(e){return this.engine.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.engine.decode(e)}}}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[243,{"./base.js":242,"./rfc4648":245,"./util":246,"base-x":1865},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("base-x"),i=e("./base.js"),s=e("./rfc4648"),{decodeText:a,encodeText:o}=e("./util"),c=[["identity","\0",()=>({encode:a,decode:o}),""],["base2","0",s(1),"01"],["base8","7",s(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",s(4),"0123456789abcdef"],["base16upper","F",s(4),"0123456789ABCDEF"],["base32hex","v",s(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",s(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",s(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",s(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",s(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=c.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=u[t[0]],e)),{});t.exports={names:u,codes:l}}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[244,{"./constants":243,"./util":246,buffer:1996},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("./constants"),{decodeText:s,asBuffer:a}=e("./util");function o(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=t.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");const{name:r,codeBuf:i}=o(e);!function(e,t){o(e).decode(s(t))}(r,t);const a=n.alloc(i.length+t.length);return a.set(i,0),a.set(t,i.length),a}).encode=function(e,t){const r=o(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},r.decode=function(e){ArrayBuffer.isView(e)&&(e=s(e));const t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());const r=o(e[0]);return a(r.decode(e.substring(1)))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=s(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return o(e[0]).name}catch(e){return!1}},r.encoding=o,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=s(e)),o(e[0])},r.names=Object.freeze(i.names),r.codes=Object.freeze(i.codes)}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[2443,{bs58check:2005,crypto:2106,"ethereumjs-util":2448,randombytes:5476,"safe-buffer":5660,scryptsy:5670,"uuid/v4":2457},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("safe-buffer").Buffer,s=e("ethereumjs-util"),a=e("crypto"),o=e("randombytes"),c=e("scryptsy"),u=e("uuid/v4"),l=e("bs58check");function f(e,t){if(!e)throw new Error(t||"Assertion failed")}function h(e,t){return i.concat([e.update(t),e.final()])}var d=function(e,t){if(e&&t)throw new Error("Cannot supply both a private and a public key to the constructor");if(e&&!s.isValidPrivate(e))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(t&&!s.isValidPublic(t))throw new Error("Invalid public key");this._privKey=e,this._pubKey=t};Object.defineProperty(d.prototype,"privKey",{get:function(){return f(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(d.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=s.privateToPublic(this.privKey)),this._pubKey}}),d.generate=function(e){if(!e)return new d(o(32));for(var t=new s.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var r=o(32);if(new s.BN(s.privateToAddress(r)).lte(t))return new d(r)}},d.generateVanityAddress=function(e){for("object"!==(void 0===e?"undefined":n(e))&&(e=new RegExp(e));;){var t=o(32),r=s.privateToAddress(t);if(e.test(r.toString("hex")))return new d(t)}},d.prototype.getPrivateKey=function(){return this.privKey},d.prototype.getPrivateKeyString=function(){return s.bufferToHex(this.getPrivateKey())},d.prototype.getPublicKey=function(){return this.pubKey},d.prototype.getPublicKeyString=function(){return s.bufferToHex(this.getPublicKey())},d.prototype.getAddress=function(){return s.publicToAddress(this.pubKey)},d.prototype.getAddressString=function(){return s.bufferToHex(this.getAddress())},d.prototype.getChecksumAddressString=function(){return s.toChecksumAddress(this.getAddressString())},d.prototype.toV3=function(e,t){f(this._privKey,"This is a public key only wallet");var r,n=(t=t||{}).salt||o(32),l=t.iv||o(16),d=t.kdf||"scrypt",p={dklen:t.dklen||32,salt:n.toString("hex")};if("pbkdf2"===d)p.c=t.c||262144,p.prf="hmac-sha256",r=a.pbkdf2Sync(i.from(e),n,p.c,p.dklen,"sha256");else{if("scrypt"!==d)throw new Error("Unsupported kdf");p.n=t.n||262144,p.r=t.r||8,p.p=t.p||1,r=c(i.from(e),n,p.n,p.r,p.p,p.dklen)}var g=a.createCipheriv(t.cipher||"aes-128-ctr",r.slice(0,16),l);if(!g)throw new Error("Unsupported cipher");var m=h(g,this.privKey),_=s.keccak256(i.concat([r.slice(16,32),i.from(m,"hex")]));return{version:3,id:u({random:t.uuid||o(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:m.toString("hex"),cipherparams:{iv:l.toString("hex")},cipher:t.cipher||"aes-128-ctr",kdf:d,kdfparams:p,mac:_.toString("hex")}}},d.prototype.getV3Filename=function(e){return["UTC--",(e?new Date(e):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},d.prototype.toV3String=function(e,t){return JSON.stringify(this.toV3(e,t))},d.fromPublicKey=function(e,t){return t&&(e=s.importPublic(e)),new d(null,e)},d.fromExtendedPublicKey=function(e){return f("xpub"===e.slice(0,4),"Not an extended public key"),e=l.decode(e).slice(45),d.fromPublicKey(e,!0)},d.fromPrivateKey=function(e){return new d(e)},d.fromExtendedPrivateKey=function(e){f("xprv"===e.slice(0,4),"Not an extended private key");var t=l.decode(e);return f(0===t[45],"Invalid extended private key"),d.fromPrivateKey(t.slice(46))},d.fromV1=function(e,t){f("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if("1"!==r.Version)throw new Error("Not a V1 wallet");if("scrypt"!==r.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var o=r.Crypto.KeyHeader.KdfParams,u=c(i.from(t),i.from(r.Crypto.Salt,"hex"),o.N,o.R,o.P,o.DkLen),l=i.from(r.Crypto.CipherText,"hex");if(s.keccak256(i.concat([u.slice(16,32),l])).toString("hex")!==r.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var p=h(a.createDecipheriv("aes-128-cbc",s.keccak256(u.slice(0,16)).slice(0,16),i.from(r.Crypto.IV,"hex")),l);return new d(p)},d.fromV3=function(e,t,r){f("string"==typeof t);var o,u,l="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(r?e.toLowerCase():e);if(3!==l.version)throw new Error("Not a V3 wallet");if("scrypt"===l.crypto.kdf)u=l.crypto.kdfparams,o=c(i.from(t),i.from(u.salt,"hex"),u.n,u.r,u.p,u.dklen);else{if("pbkdf2"!==l.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(u=l.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");o=a.pbkdf2Sync(i.from(t),i.from(u.salt,"hex"),u.c,u.dklen,"sha256")}var p=i.from(l.crypto.ciphertext,"hex");if(s.keccak256(i.concat([o.slice(16,32),p])).toString("hex")!==l.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var g=h(a.createDecipheriv(l.crypto.cipher,o.slice(0,16),i.from(l.crypto.cipherparams.iv,"hex")),p);return new d(g)},d.fromEthSale=function(e,t){f("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e),o=i.from(r.encseed,"hex"),c=a.pbkdf2Sync(t,t,2e3,32,"sha256").slice(0,16),u=h(a.createDecipheriv("aes-128-cbc",c,o.slice(0,16)),o.slice(16)),l=new d(s.keccak256(u));if(l.getAddress().toString("hex")!==r.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return l},t.exports=d}}},{package:"ethereumjs-wallet"}],[2444,{"./bytes":2445,"./hash":2447,"./secp256k1v3-adapter":2450,assert:1615,"bn.js":1952,buffer:1996,"ethjs-util":2454},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("./secp256k1v3-adapter"),a=e("bn.js"),o=e("./bytes"),c=e("./hash");r.zeroAddress=function(){var e=o.zeros(20);return o.bufferToHex(e)},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===o.addHexPrefix(e)},r.toChecksumAddress=function(e,t){e=i.stripHexPrefix(e).toLowerCase();for(var r=t!==undefined?t.toString()+"0x":"",n=c.keccak(r+e).toString("hex"),s="0x",a=0;a<e.length;a++)parseInt(n[a],16)>=8?s+=e[a].toUpperCase():s+=e[a];return s},r.isValidChecksumAddress=function(e,t){return r.isValidAddress(e)&&r.toChecksumAddress(e,t)===e},r.generateAddress=function(e,r){e=o.toBuffer(e);var n=new a(r);return n.isZero()?c.rlphash([e,null]).slice(-20):c.rlphash([e,t.from(n.toArray())]).slice(-20)},r.generateAddress2=function(e,r,i){var s=o.toBuffer(e),a=o.toBuffer(r),u=o.toBuffer(i);return n(20===s.length),n(32===a.length),c.keccak256(t.concat([t.from("ff","hex"),s,a,c.keccak256(u)])).slice(-20)},r.isPrecompiled=function(e){var t=o.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.isValidPrivate=function(e){return s.privateKeyVerify(e)},r.isValidPublic=function(e,r){return void 0===r&&(r=!1),64===e.length?s.publicKeyVerify(t.concat([t.from([4]),e])):!!r&&s.publicKeyVerify(e)},r.pubToAddress=function(e,t){return void 0===t&&(t=!1),e=o.toBuffer(e),t&&64!==e.length&&(e=s.publicKeyConvert(e,!1).slice(1)),n(64===e.length),c.keccak(e).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(e){return r.publicToAddress(r.privateToPublic(e))},r.privateToPublic=function(e){return e=o.toBuffer(e),s.publicKeyCreate(e,!1).slice(1)},r.importPublic=function(e){return 64!==(e=o.toBuffer(e)).length&&(e=s.publicKeyConvert(e,!1).slice(1)),e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2445,{"bn.js":1952,buffer:1996,"ethjs-util":2454},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=e("ethjs-util"),i=e("bn.js");r.zeros=function(e){return t.allocUnsafe(e).fill(0)},r.setLengthLeft=function(e,t,n){void 0===n&&(n=!1);var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLength=r.setLengthLeft,r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=function(e){for(var t=(e=n.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.stripZeros=r.unpad,r.toBuffer=function(e){if(!t.isBuffer(e))if(Array.isArray(e))e=t.from(e);else if("string"==typeof e){if(!n.isHexString(e))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+e);e=t.from(n.padToEven(n.stripHexPrefix(e)),"hex")}else if("number"==typeof e)e=n.intToBuffer(e);else if(null===e||e===undefined)e=t.allocUnsafe(0);else if(i.isBN(e))e=e.toArrayLike(t);else{if(!e.toArray)throw new Error("invalid type");e=t.from(e.toArray())}return e},r.bufferToInt=function(e){return new i(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new i(e).fromTwos(256)},r.toUnsigned=function(e){return t.from(e.toTwos(256).toArray())},r.addHexPrefix=function(e){return"string"!=typeof e||n.isHexPrefixed(e)?e:"0x"+e},r.baToJSON=function(e){if(t.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var n=[],i=0;i<e.length;i++)n.push(r.baToJSON(e[i]));return n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2446,{"bn.js":1952,buffer:1996},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=e("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=t.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=t.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=t.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2447,{"./bytes":2445,buffer:1996,"create-hash":2099,"ethereum-cryptography/keccak":2406,"ethjs-util":2454,rlp:5658},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=e("ethereum-cryptography/keccak"),i=n.keccak224,s=n.keccak384,a=n.keccak256,o=n.keccak512,c=e("create-hash"),u=e("ethjs-util"),l=e("rlp"),f=e("./bytes");r.keccak=function(e,r){switch(void 0===r&&(r=256),e="string"!=typeof e||u.isHexString(e)?f.toBuffer(e):t.from(e,"utf8"),r||(r=256),r){case 224:return i(e);case 256:return a(e);case 384:return s(e);case 512:return o(e);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(e){return r.keccak(e)},r.sha256=function(e){return e=f.toBuffer(e),c("sha256").update(e).digest()},r.ripemd160=function(e,t){e=f.toBuffer(e);var r=c("rmd160").update(e).digest();return!0===t?f.setLength(r,32):r},r.rlphash=function(e){return r.keccak(l.encode(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2448,{"./account":2444,"./bytes":2445,"./constants":2446,"./hash":2447,"./object":2449,"./secp256k1v3-adapter":2450,"./signature":2453,"bn.js":1952,"ethjs-util":2454,rlp:5658},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var s=e("./secp256k1v3-adapter");r.secp256k1=s;var a=e("ethjs-util"),o=e("bn.js");r.BN=o;var c=e("rlp");r.rlp=c,Object.assign(r,a),i(e("./constants"),r),i(e("./account"),r),i(e("./hash"),r),i(e("./signature"),r),i(e("./bytes"),r),i(e("./object"),r)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2449,{"./bytes":2445,assert:1615,buffer:1996,"ethjs-util":2454,rlp:5658},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=e("assert"),i=e("ethjs-util"),s=e("rlp"),a=e("./bytes");r.defineProperties=function(e,r,o){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(void 0===t&&(t=!1),t){var r={};return e._fields.forEach((function(t){r[t]="0x"+e[t].toString("hex")})),r}return a.baToJSON(e.raw)},e.serialize=function(){return s.encode(e.raw)},r.forEach((function(r,i){function s(){return e.raw[i]}function o(s){"00"!==(s=a.toBuffer(s)).toString("hex")||r.allowZero||(s=t.allocUnsafe(0)),r.allowLess&&r.length?(s=a.stripZeros(s),n(r.length>=s.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===s.length||!r.length||n(r.length===s.length,"The field "+r.name+" must have byte length of "+r.length),e.raw[i]=s}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:s,set:o}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:o,get:s})})),o)if("string"==typeof o&&(o=t.from(i.stripHexPrefix(o),"hex")),t.isBuffer(o)&&(o=s.decode(o)),Array.isArray(o)){if(o.length>e._fields.length)throw new Error("wrong number of fields in data");o.forEach((function(t,r){e[e._fields[r]]=a.toBuffer(t)}))}else{if("object"!=typeof o)throw new Error("invalid data");var c=Object.keys(o);r.forEach((function(t){-1!==c.indexOf(t.name)&&(e[t.name]=o[t.name]),-1!==c.indexOf(t.alias)&&(e[t.alias]=o[t.alias])}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[245,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",a=0,o=0;for(let n=0;n<e.length;++n)for(o=o<<8|e[n],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*r/8|0);let a=0,o=0,c=0;for(let t=0;t<i;++t){const i=n[e[t]];if(i===undefined)throw new SyntaxError("Invalid character "+e[t]);o=o<<r|i,a+=r,a>=8&&(a-=8,s[c++]=255&o>>a)}if(a>=r||255&o<<8-a)throw new SyntaxError("Unexpected end of data");return s})(r,t,e)})}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[2450,{"./secp256k1v3-lib/der":2451,"./secp256k1v3-lib/index":2452,buffer:1996,"ethereum-cryptography/secp256k1":2414},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=e("ethereum-cryptography/secp256k1"),i=e("./secp256k1v3-lib/index"),s=e("./secp256k1v3-lib/der");r.privateKeyVerify=function(e){return 32===e.length&&n.privateKeyVerify(Uint8Array.from(e))},r.privateKeyExport=function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(e,t);return s.privateKeyExport(e,r,t)},r.privateKeyImport=function(e){if(null!==(e=s.privateKeyImport(e))&&32===e.length&&r.privateKeyVerify(e))return e;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(e){return t.from(n.privateKeyNegate(Uint8Array.from(e)))},r.privateKeyModInverse=function(e){if(32!==e.length)throw new Error("private key length is invalid");return t.from(i.privateKeyModInverse(Uint8Array.from(e)))},r.privateKeyTweakAdd=function(e,r){return t.from(n.privateKeyTweakAdd(Uint8Array.from(e),r))},r.privateKeyTweakMul=function(e,r){return t.from(n.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r)))},r.publicKeyCreate=function(e,r){return t.from(n.publicKeyCreate(Uint8Array.from(e),r))},r.publicKeyConvert=function(e,r){return t.from(n.publicKeyConvert(Uint8Array.from(e),r))},r.publicKeyVerify=function(e){return(33===e.length||65===e.length)&&n.publicKeyVerify(Uint8Array.from(e))},r.publicKeyTweakAdd=function(e,r,i){return t.from(n.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(e,r,i){return t.from(n.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyCombine=function(e,r){var i=[];return e.forEach((function(e){i.push(Uint8Array.from(e))})),t.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(e){return t.from(n.signatureNormalize(Uint8Array.from(e)))},r.signatureExport=function(e){return t.from(n.signatureExport(Uint8Array.from(e)))},r.signatureImport=function(e){return t.from(n.signatureImport(Uint8Array.from(e)))},r.signatureImportLax=function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=s.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return i.signatureImport(t)},r.sign=function(e,r,i){if(null===i)throw new TypeError("options should be an Object");var s=undefined;if(i){if(s={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");s.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(s.noncefn=function(e,r,n,s,a){var o=null!=n?t.from(n):null,c=null!=s?t.from(s):null,u=t.from("");return i.noncefn&&(u=i.noncefn(t.from(e),t.from(r),o,c,a)),new Uint8Array(u)})}var a=n.ecdsaSign(Uint8Array.from(e),Uint8Array.from(r),s);return{signature:t.from(a.signature),recovery:a.recid}},r.verify=function(e,t,r){return n.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},r.recover=function(e,r,i,s){return t.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(e),s))},r.ecdh=function(e,r){return t.from(n.ecdh(Uint8Array.from(e),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(e,r,n){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return t.from(i.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(r),n))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2451,{buffer:1996},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=e.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,s){void 0===s&&(s=!0);var a=e.from(s?t:n);return r.copy(a,s?8:9),i.copy(a,s?181:214),a},r.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||48!==e[r])return null;if(t<(r+=1)+1||!(128&e[r]))return null;var n=127&e[r];if(n<1||n>2)return null;if(t<(r+=1)+n)return null;var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]?null:e.slice(r+2,r+2+e[r+1])},r.signatureImportLax=function(t){var r=e.alloc(32,0),n=e.alloc(32,0),i=t.length,s=0;if(48!==t[s++])return null;var a=t[s++];if(128&a&&(s+=a-128)>i)return null;if(2!==t[s++])return null;var o=t[s++];if(128&o){if(s+(a=o-128)>i)return null;for(;a>0&&0===t[s];s+=1,a-=1);for(o=0;a>0;s+=1,a-=1)o=(o<<8)+t[s]}if(o>i-s)return null;var c=s;if(s+=o,2!==t[s++])return null;var u=t[s++];if(128&u){if(s+(a=u-128)>i)return null;for(;a>0&&0===t[s];s+=1,a-=1);for(u=0;a>0;s+=1,a-=1)u=(u<<8)+t[s]}if(u>i-s)return null;var l=s;for(s+=u;o>0&&0===t[c];o-=1,c+=1);if(o>32)return null;var f=t.slice(c,c+o);for(f.copy(r,32-f.length);u>0&&0===t[l];u-=1,l+=1);if(u>32)return null;var h=t.slice(l,l+u);return h.copy(n,32-h.length),{r:r,s:n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2452,{"bn.js":1952,buffer:1996,elliptic:2230},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("bn.js"),i=new(0,e("elliptic").ec)("secp256k1"),s=i.curve;r.privateKeyExport=function(e,t){void 0===t&&(t=!0);var r=new n(e);if(r.ucmp(s.n)>=0)throw new Error("couldn't export to DER format");var o=i.g.mul(r);return a(o.getX(),o.getY(),t)},r.privateKeyModInverse=function(e){var r=new n(e);if(r.ucmp(s.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(s.n).toArrayLike(t,"be",32)},r.signatureImport=function(e){var r=new n(e.r);r.ucmp(s.n)>=0&&(r=new n(0));var i=new n(e.s);return i.ucmp(s.n)>=0&&(i=new n(0)),t.concat([r.toArrayLike(t,"be",32),i.toArrayLike(t,"be",32)])},r.ecdhUnsafe=function(e,t,r){void 0===r&&(r=!0);var o=i.keyFromPublic(e),c=new n(t);if(c.ucmp(s.n)>=0||c.isZero())throw new Error("scalar was invalid (zero or overflow)");var u=o.pub.mul(c);return a(u.getX(),u.getY(),r)};var a=function(e,r,n){var i;return n?((i=t.alloc(33))[0]=r.isOdd()?3:2,e.toArrayLike(t,"be",32).copy(i,1)):((i=t.alloc(65))[0]=4,e.toArrayLike(t,"be",32).copy(i,1),r.toArrayLike(t,"be",32).copy(i,33)),i}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2453,{"./bytes":2445,"./hash":2447,"./secp256k1v3-adapter":2450,"bn.js":1952,buffer:1996},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=e("./secp256k1v3-adapter"),i=e("bn.js"),s=e("./bytes"),a=e("./hash");function o(e,t){return t?e-(2*t+35):e-27}function c(e){return 0===e||1===e}r.ecsign=function(e,t,r){var i=n.sign(e,t),s=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?s+(2*r+35):s+27}},r.ecrecover=function(e,r,i,a,u){var l=t.concat([s.setLength(i,32),s.setLength(a,32)],64),f=o(r,u);if(!c(f))throw new Error("Invalid signature v value");var h=n.recover(e,l,f);return n.publicKeyConvert(h,!1).slice(1)},r.toRpcSig=function(e,r,n,i){if(!c(o(e,i)))throw new Error("Invalid signature v value");return s.bufferToHex(t.concat([s.setLengthLeft(r,32),s.setLengthLeft(n,32),s.toBuffer(e)]))},r.fromRpcSig=function(e){var t=s.toBuffer(e);if(65!==t.length)throw new Error("Invalid signature length");var r=t[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}},r.isValidSignature=function(e,t,r,n,s){void 0===n&&(n=!0);var a=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),u=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==t.length||32!==r.length)return!1;if(!c(o(e,s)))return!1;var l=new i(t),f=new i(r);return!(l.isZero()||l.gt(u)||f.isZero()||f.gt(u))&&(!n||1!==f.cmp(a))},r.hashPersonalMessage=function(e){var r=t.from("Ethereum Signed Message:\n"+e.length.toString(),"utf-8");return a.keccak(t.concat([r,e]))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2454,{buffer:1996,"is-hex-prefixed":4609,"strip-hex-prefix":5820},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function a(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=a(e);return new r(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:s,intToHex:a,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+s(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(s(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var s=e[i][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");n.push(s)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util>ethjs-util"}],[2455,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}}}},{package:"ethereumjs-wallet>uuid"}],[2456,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var s=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}}}},{package:"ethereumjs-wallet>uuid"}],[2457,{"./lib/bytesToUuid":2455,"./lib/rng":2456},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}}}},{package:"ethereumjs-wallet>uuid"}],[2458,{"./index.js":2443,"aes-js":1590,crypto:2106,"ethereumjs-util":2448,"safe-buffer":5660,scryptsy:5670,utf8:5928},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./index.js"),s=e("ethereumjs-util"),a=e("crypto"),o=e("scryptsy"),c=e("utf8"),u=e("aes-js"),l=e("safe-buffer").Buffer;function f(e,t){if(!e)throw new Error(t||"Assertion failed")}var h={};h.fromEtherWallet=function(e,t){var r,s="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if(s.locked){if("string"!=typeof t)throw new Error("Password required");if(t.length<7)throw new Error("Password must be at least 7 characters");var o=s.encrypted?s.private.slice(0,128):s.private;if(o=function(e){var t=l.from(e,"base64");return"Salted__"===t.slice(0,8).toString()?{salt:t.slice(8,16),ciphertext:t.slice(16)}:{ciphertext:t}}(o),!o.salt)throw new Error("Unsupported EtherWallet key format");var u=function(e,t,r){function n(n){var i=a.createHash(r.digest||"md5");i.update(n),i.update(e),i.update(t),n=i.digest();for(var s=1;s<(r.count||1);s++)(i=a.createHash(r.digest||"md5")).update(n),n=i.digest();return n}for(var i=r.keysize||16,s=r.ivsize||16,o=[],c=0;l.concat(o).length<i+s;)o[c]=n(0===c?l.alloc(0):o[c-1]),c++;var u=l.concat(o);return{key:u.slice(0,i),iv:u.slice(i,i+s)}}(l.from(t),o.salt,{keysize:32,ivsize:16});r=function(e,t){return l.concat([e.update(t),e.final()])}(a.createDecipheriv("aes-256-cbc",u.key,u.iv),l.from(o.ciphertext)),r=l.from(c.decode(r.toString()),"hex")}else{if(64!==s.private.length)throw new Error("Invalid private key length");r=l.from(s.private,"hex")}var f=new i(r);if(f.getAddressString()!==s.address)throw new Error("Invalid private key or address");return f},h.fromEtherCamp=function(e){return new i(s.keccak256(l.from(e)))},h.fromKryptoKit=function(e,t){"#"===e[0]&&(e=e.slice(1));var r,n=e[0];if(e=e.slice(1),"d"===n)r=s.sha256(l.from(e));else{if("q"!==n)throw new Error("Unsupported or invalid entropy type");if("string"!=typeof t)throw new Error("Password required");var a=s.sha256(l.from(e.slice(0,30))),c=e.slice(30,46),f=function(e){function t(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}for(var r="",n="",i=0;i<e.length;i++)e[i]<=127?(r+=t(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16);return l.from(r+t(n))}(a),h=o(l.from(t,"utf8"),f,16384,8,1,32),d=new u.ModeOfOperation.ecb(h);if(r=l.concat([l.from(d.decrypt(a.slice(0,16))),l.from(d.decrypt(a.slice(16,32)))]),c.length>0&&c!==s.sha256(s.sha256(r)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase")}return new i(r)},h.fromQuorumWallet=function(e,t){f(e.length>=10),f(t.length>=10);var r=e+t;return r=a.pbkdf2Sync(r,r,2e3,32,"sha256"),new i(r)},t.exports=h}}},{package:"ethereumjs-wallet"}],[246,{buffer:1996,"web-encoding":5956},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),{TextEncoder:i,TextDecoder:s}=e("web-encoding"),a=new s,o=new i;t.exports={decodeText:e=>a.decode(e),encodeText:e=>o.encode(e),asBuffer:({buffer:e,byteLength:t,byteOffset:r})=>n.from(e,r,t)}}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[247,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r){var n,i=0,s=0,a=r=r||0,o=t.length;do{if(a>=o||s>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[a++],i+=s<28?(127&n)<<s:(127&n)*Math.pow(2,s),s+=7}while(n>=128);return e.bytes=a-r,i}}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[248,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r,i){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");r=r||[];var s=i=i||0;for(;t>=n;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-s+1,r};var n=Math.pow(2,31)}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[249,{"./decode.js":247,"./encode.js":248,"./length.js":250},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[2498,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.hasOwnProperty,i="~";function s(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,n,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new a(r,n||e,s),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function u(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=new Array(s);n<s;n++)a[n]=r[n].fn;return a},u.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,s,a){var o=i?i+e:e;if(!this._events[o])return!1;var c,u,l=this._events[o],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,undefined,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,s),!0;case 6:return l.fn.call(l.context,t,r,n,s,a),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,undefined,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,n);break;default:if(!c)for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var s=i?i+e:e;if(!this._events[s])return this;if(!t)return c(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||n&&!a.once||r&&a.context!==r||c(this,s);else{for(var o=0,u=[],l=a.length;o<l;o++)(a[o].fn!==t||n&&!a[o].once||r&&a[o].context!==r)&&u.push(a[o]);u.length?this._events[s]=1===u.length?u[0]:u:c(this,s)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new s,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,void 0!==t&&(t.exports=u)}}},{package:"mockttp>@httptoolkit/subscriptions-transport-ws>eventemitter3"}],[25,{"./background-api":22,"./caveat-mutators":23,"./enums":24,"./permission-log":26,"./selectors":27,"./specifications":28},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./caveat-mutators");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=e("./background-api");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===i[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}}))}));var s=e("./enums");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}}))}));var a=e("./permission-log");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===a[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}}))}));var o=e("./specifications");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===o[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}}))}));var c=e("./selectors");Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===c[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return c[e]}}))}))}}},{package:"$root$"}],[250,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Math.pow(2,7),i=Math.pow(2,14),s=Math.pow(2,21),a=Math.pow(2,28),o=Math.pow(2,35),c=Math.pow(2,42),u=Math.pow(2,49),l=Math.pow(2,56),f=Math.pow(2,63);t.exports=function(e){return e<n?1:e<i?2:e<s?3:e<a?4:e<o?5:e<c?6:e<u?7:e<l?8:e<f?9:10}}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[251,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});t.exports={baseTable:n}}}},{package:"@ensdomains/content-hash>multicodec"}],[252,{"./base-table":251},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n)){i[e.toUpperCase().replace(/-/g,"_")]=t}t.exports=Object.freeze(i)}}},{package:"@ensdomains/content-hash>multicodec"}],[253,{"./constants":252,"./int-table":254,"./print":255,"./util":256,"./varint-table":257,"uint8arrays/concat":260,varint:249},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("./int-table"),s=e("./varint-table"),a=e("./util"),o=e("uint8arrays/concat");const c=e("./constants"),u=e("./print");t.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=a.varintUint8ArrayEncode(e);else{if(!s[e])throw new Error("multicodec not recognized");r=s[e]}return o([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getCodec:function(e){const t=n.decode(e),r=i.get(t);if(r===undefined)throw new Error(`Code ${t} not found`);return r},getName:function(e){return i.get(e)},getNumber:function(e){const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return n.decode(t)},getCode:function(e){return n.decode(e)},getCodeVarint:function(e){const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return t},getVarint:function(e){return n.encode(e)},print:u,...c}}}},{package:"@ensdomains/content-hash>multicodec"}],[254,{"./base-table":251},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=new Map;for(const e in n){const t=n[e];i.set(t,e)}t.exports=Object.freeze(i)}}},{package:"@ensdomains/content-hash>multicodec"}],[255,{"./base-table":251},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n))i[t]===undefined&&(i[t]=e);t.exports=Object.freeze(i)}}},{package:"@ensdomains/content-hash>multicodec"}],[256,{"uint8arrays/from-string":261,"uint8arrays/to-string":266,varint:249},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("uint8arrays/to-string"),s=e("uint8arrays/from-string");function a(e){return parseInt(i(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return s(t,"base16")},uint8ArrayToNumber:a,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(a(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}}}},{package:"@ensdomains/content-hash>multicodec"}],[257,{"./base-table":251,"./util":256},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=e("./util").varintEncode,s={};for(const e in n){const t=n[e];s[e]=i(t)}t.exports=Object.freeze(s)}}},{package:"@ensdomains/content-hash>multicodec"}],[258,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});t.exports={names:n}}}},{package:"@ensdomains/content-hash>multihashes"}],[259,{"./constants":258,buffer:1996,multibase:244,varint:5952,"web-encoding":5956},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("multibase"),s=e("varint"),{names:a}=e("./constants"),{TextDecoder:o}=e("web-encoding"),c=new o,u={};for(const e in a)u[a[e]]=e;function l(e){r.decode(e)}r.names=a,r.codes=Object.freeze(u),r.toHexString=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return(n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength)).toString("hex")},r.fromHexString=function(e){return n.from(e,"hex")},r.toB58String=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return c.decode(i.encode("base58btc",e)).slice(1)},r.fromB58String=function(e){const t=e instanceof Uint8Array?c.decode(e):e;return i.decode("z"+t)},r.decode=function(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");let t=n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength);if(t.length<2)throw new Error("multihash too short. must be > 2 bytes.");const i=s.decode(t);if(!r.isValidCode(i))throw new Error(`multihash unknown function code: 0x${i.toString(16)}`);t=t.slice(s.decode.bytes);const a=s.decode(t);if(a<0)throw new Error(`multihash invalid length: ${a}`);if(t=t.slice(s.decode.bytes),t.length!==a)throw new Error(`multihash length inconsistent: 0x${t.toString("hex")}`);return{code:i,name:u[i],length:a,digest:t}},r.encode=function(e,t,i){if(!e||t===undefined)throw new Error("multihash encode requires at least two args: digest, code");const a=r.coerceCode(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");const o=s.encode(a),c=s.encode(i),u=n.alloc(o.length+c.length+e.length);return u.set(o,0),u.set(c,o.length),u.set(e,o.length+c.length),u},r.coerceCode=function(e){let t=e;if("string"==typeof e){if(a[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=a[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(u[t]===undefined&&!r.isAppCode(t))throw new Error(`Unrecognized function code: ${t}`);return t},r.isAppCode=function(e){return e>0&&e<16},r.isValidCode=function(e){return!!r.isAppCode(e)||!!u[e]},r.validate=l,r.prefix=function(e){return l(e),n.from(e.buffer,e.byteOffset,2)}}}},{package:"@ensdomains/content-hash>multihashes"}],[26,{"../../../../shared/constants/permissions":6111,"./enums":24,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/obs-store":1197},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogController=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),a=e("../../../../shared/constants/permissions"),o=e("./enums");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){return e.reduce(((e,r)=>u(u({},e),{},{[r]:t})),{})}r.PermissionLogController=class{constructor({restrictedMethods:e,initState:t}){this.restrictedMethods=e,this.store=new s.ObservableStore(u({permissionHistory:{},permissionActivityLog:[]},t))}getActivityLog(){return this.store.getState().permissionActivityLog}updateActivityLog(e){this.store.updateState({permissionActivityLog:e})}getHistory(){return this.store.getState().permissionHistory}updateHistory(e){this.store.updateState({permissionHistory:e})}updateAccountsHistory(e,t){if(0===t.length)return;const r=l(t,Date.now());this.commitNewHistory(e,{eth_accounts:{accounts:r}})}createMiddleware(){return(e,t,r,n)=>{let i,s;const{origin:a,method:c}=e,u=c.startsWith(o.WALLET_PREFIX);if(o.LOG_IGNORE_METHODS.includes(c)||!u&&!this.restrictedMethods.has(c)){if("eth_requestAccounts"!==c)return void r();i=this.logRequest(e,u),s=["eth_accounts"]}else i=this.logRequest(e,u),c===`${o.WALLET_PREFIX}requestPermissions`&&(s=this.getRequestedMethods(e));r((e=>{const r=Date.now();this.logResponse(i,t,r),s&&!t.error&&t.result&&this.logPermissionsHistory(s,a,t.result,r,"eth_requestAccounts"===c),e()}))}}logRequest(e,t){const r={id:e.id,method:e.method,methodType:t?o.LOG_METHOD_TYPES.internal:o.LOG_METHOD_TYPES.restricted,origin:e.origin,requestTime:Date.now(),responseTime:null,success:null};return this.commitNewActivity(r),r}logResponse(e,t,r){e&&t&&(e.success=Object.hasOwnProperty.call(t,"result"),e.responseTime=r)}commitNewActivity(e){const t=this.getActivityLog();t.push(e),t.length>o.LOG_LIMIT&&t.shift(),this.updateActivityLog(t)}logPermissionsHistory(e,t,r,n,i){let s,a;if(i){s=r;a={eth_accounts:{accounts:l(s,n),lastApproved:n}}}else a=r.map((e=>("eth_accounts"===e.parentCapability&&(s=this.getAccountsFromPermission(e)),e.parentCapability))).reduce(((t,r)=>{if(e.includes(r))if("eth_accounts"===r){const e=l(s,n);t[r]={lastApproved:n,accounts:e}}else t[r]={lastApproved:n};return t}),{});Object.keys(a).length>0&&this.commitNewHistory(t,a)}commitNewHistory(e,t){const r=this.getHistory(),n=u(u({},r[e]),t),i=r[e]&&r[e].eth_accounts,s=t.eth_accounts;if(i&&s){const e=s.lastApproved||i.lastApproved;n.eth_accounts={lastApproved:e,accounts:u(u({},i.accounts),s.accounts)}}r[e]=n,this.updateHistory(r)}getRequestedMethods(e){return e.params&&e.params[0]&&"object"==typeof e.params[0]&&!Array.isArray(e.params[0])?Object.keys(e.params[0]):null}getAccountsFromPermission(e){if("eth_accounts"!==e.parentCapability||!e.caveats)return[];const t=new Set;for(const r of e.caveats)if(r.type===a.CaveatTypes.restrictReturnedAccounts&&Array.isArray(r.value))for(const e of r.value)t.add(e);return[...t]}}}}},{package:"$root$"}],[260,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays"}],[261,{"multibase/src/constants":263,"web-encoding":5956},function(){with(this)return function(){"use strict";return function(e,t,r){const{names:n}=e("multibase/src/constants"),{TextEncoder:i}=e("web-encoding"),s=new i;t.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return s.encode(e);if("ascii"===t)return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.decode(e)}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays"}],[262,{"./util":265},function(){with(this)return function(){"use strict";return function(e,t,r){const{encodeText:n}=e("./util");t.exports=class{constructor(e,t,r,i){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=i,this.codec=r(i)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[263,{"./base.js":262,"./rfc4648":264,"./util":265,"@multiformats/base-x":1371},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("@multiformats/base-x"),i=e("./base.js"),{rfc4648:s}=e("./rfc4648"),{decodeText:a,encodeText:o}=e("./util"),c=[["identity","\0",()=>({encode:a,decode:o}),""],["base2","0",s(1),"01"],["base8","7",s(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",s(4),"0123456789abcdef"],["base16upper","F",s(4),"0123456789ABCDEF"],["base32hex","v",s(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",s(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",s(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",s(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",s(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",s(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",s(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",s(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=c.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=u[t[0]],e)),{});t.exports={names:u,codes:l}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[264,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",a=0,o=0;for(let n=0;n<e.length;++n)for(o=o<<8|e[n],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*r/8|0);let a=0,o=0,c=0;for(let t=0;t<i;++t){const i=n[e[t]];if(i===undefined)throw new SyntaxError("Invalid character "+e[t]);o=o<<r|i,a+=r,a>=8&&(a-=8,s[c++]=255&o>>a)}if(a>=r||255&o<<8-a)throw new SyntaxError("Unexpected end of data");return s})(r,t,e)})}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[265,{"web-encoding":5956},function(){with(this)return function(){"use strict";return function(e,t,r){const{TextEncoder:n,TextDecoder:i}=e("web-encoding"),s=new i,a=new n;t.exports={decodeText:e=>s.decode(e),encodeText:e=>a.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[266,{"multibase/src/constants":263,"web-encoding":5956},function(){with(this)return function(){"use strict";return function(e,t,r){const{names:n}=e("multibase/src/constants"),{TextDecoder:i}=e("web-encoding"),s=new i("utf8");t.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return s.decode(e);if("ascii"===t)return function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.encode(e)}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays"}],[267,{cids:241},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("cids");r.cidForWeb=e=>{let t=new n(e);0===t.version&&(t=t.toV1());let r=t.toString("base32");if(r.length>63){const e=t.toString("base36");if(e.length<=63)return e;throw new TypeError("CID is longer than DNS limit of 63 characters and is not compatible with public gateways")}return r};r.cidV0ToV1Base32=e=>{let t=new n(e);return 0===t.version&&(t=t.toV1()),t.toString("base32")}}}},{package:"@ensdomains/content-hash"}],[268,{"./helpers":267,"./profiles":269,multicodec:253,multihashes:259},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multicodec"),i=e("multihashes"),{hexStringToBuffer:s,profiles:a}=e("./profiles"),{cidForWeb:o,cidV0ToV1Base32:c}=e("./helpers");t.exports={helpers:{cidForWeb:o,cidV0ToV1Base32:c},decode:function(e){const t=s(e),r=n.getCodec(t),i=n.rmPrefix(t);let o=a[r];return o||(o=a.default),o.decode(i)},fromIpfs:function(e){return this.encode("ipfs-ns",e)},fromSkylink:function(e){return this.encode("skynet-ns",e)},fromSwarm:function(e){return this.encode("swarm-ns",e)},encode:function(e,t){let r=a[e];r||(r=a.default);const s=r.encode(t);return i.toHexString(n.addPrefix(e,s))},getCodec:function(e){let t=s(e);return n.getCodec(t)}}}}},{package:"@ensdomains/content-hash"}],[269,{buffer:1996,cids:241,"js-base64":4631,multihashes:259},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("cids"),i=e("multihashes"),s=e("js-base64"),a=e=>{let t=e.slice(0,2),r=e.slice(2),n="";return n="0x"===t?r:e,i.fromHexString(n)},o=e=>{try{const{multihash:t}=e;if(t.length<38){const e=i.decode(t);if("identity"===e.name&&e.length<36)return!1}return!0}catch(e){return!1}return!1},c={skynet:e=>s.toUint8Array(e),swarm:e=>{const t=i.encode(a(e),"keccak-256");return new n(1,"swarm-manifest",t).bytes},ipfs:e=>new n(e).toV1().bytes,ipns:e=>{const t=new n(e);if(!o(t))throw Error("ipns-ns allows only valid cryptographic libp2p-key identifiers, try using ED25519 pubkey instead");return new n(1,"libp2p-key",t.multihash).bytes},utf8:e=>t.from(e,"utf8")},u={hexMultiHash:e=>{const t=new n(e);return i.decode(t.multihash).digest.toString("hex")},ipfs:e=>{const t=new n(e).toV1();return t.toString("libp2p-key"===t.codec?"base36":"base32")},ipns:e=>{const t=new n(e).toV1();return o(t)?t.toString("base36"):(console.warn("[ensdomains/content-hash] use of non-cryptographic identifiers in ipns-ns is deprecated and will be removed, migrate to ED25519 libp2p-key"),String(i.decode(new n(e).multihash).digest))},utf8:e=>e.toString("utf8"),base64:e=>s.fromUint8Array(e,!0)},l={"skynet-ns":{encode:c.skynet,decode:u.base64},"swarm-ns":{encode:c.swarm,decode:u.hexMultiHash},"ipfs-ns":{encode:c.ipfs,decode:u.ipfs},"ipns-ns":{encode:c.ipns,decode:u.ipns},default:{encode:c.utf8,decode:u.utf8}};r.hexStringToBuffer=a,r.profiles=l}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ensdomains/content-hash"}],[27,{"../../../../shared/constants/permissions":6111,reselect:5651},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var n=e("reselect"),i=e("../../../../shared/constants/permissions");const s=(0,n.createSelector)((e=>e.subjects),(e=>Object.values(e).reduce(((e,t)=>{var r,n;const s=null===(r=t.permissions)||void 0===r||null===(n=r.eth_accounts)||void 0===n?void 0:n.caveats.find((({type:e})=>e===i.CaveatTypes.restrictReturnedAccounts));return s&&e.set(t.origin,s.value),e}),new Map)));r.getPermittedAccountsByOrigin=s;r.getChangedAccounts=(e,t)=>{if(t===undefined)return e;const r=new Map;if(e===t)return r;const n=new Set([...e.keys()]);for(const s of t.keys()){var i;const a=null!==(i=e.get(s))&&void 0!==i?i:[];t.get(s)!==a&&r.set(s,a),n.delete(s)}for(const t of n.keys())r.set(t,e.get(t));return r}}}},{package:"$root$"}],[28,{"../../../../shared/constants/permissions":6111,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/controllers":1047},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/controllers"),a=e("../../../../shared/constants/permissions");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const u=Object.freeze(c({},a.RestrictedMethods)),l=Object.freeze({[a.CaveatTypes.restrictReturnedAccounts]:e=>({type:a.CaveatTypes.restrictReturnedAccounts,value:e})});r.getCaveatSpecifications=({getIdentities:e})=>({[a.CaveatTypes.restrictReturnedAccounts]:{type:a.CaveatTypes.restrictReturnedAccounts,decorator:(e,t)=>async r=>(await e(r)).filter((e=>t.value.includes(e))).slice(0,1),validator:(t,r,n)=>function(e,t){if(!Array.isArray(e)||0===e.length)throw new Error(`${u.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=t();e.forEach((e=>{if(!e||"string"!=typeof e)throw new Error(`${u.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${e}".`);if(!r[e])throw new Error(`${u.eth_accounts} error: Received unrecognized address: "${e}".`)}))}(t.value,e)}});r.getPermissionSpecifications=({getAllAccounts:e,getIdentities:t,captureKeyringTypesWithMissingIdentities:r})=>({[u.eth_accounts]:{permissionType:s.PermissionType.RestrictedMethod,targetKey:u.eth_accounts,allowedCaveats:[a.CaveatTypes.restrictReturnedAccounts],factory:(e,t)=>{if(Array.isArray(e.caveats))throw new Error(`${u.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!t.approvedAccounts)throw new Error(`${u.eth_accounts} error: No approved accounts specified.`);return(0,s.constructPermission)(c(c({},e),{},{caveats:[l[a.CaveatTypes.restrictReturnedAccounts](t.approvedAccounts)]}))},methodImplementation:async n=>{const i=await e(),s=t();return i.sort(((e,t)=>{if(!s[e])throw r(s,i),new Error(`Missing identity for address: "${e}".`);if(!s[t])throw r(s,i),new Error(`Missing identity for address: "${t}".`);return s[e].lastSelected===s[t].lastSelected?0:s[e].lastSelected===undefined?1:s[t].lastSelected===undefined?-1:s[t].lastSelected-s[e].lastSelected}))},validator:(e,t,r)=>{const{caveats:n}=e;if(!n||1!==n.length||n[0].type!==a.CaveatTypes.restrictReturnedAccounts)throw new Error(`${u.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${a.CaveatTypes.restrictReturnedAccounts}".`)}}});const f=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3"]);r.unrestrictedMethods=f}}},{package:"$root$"}],[29,{"../../../shared/constants/hardware-wallets":6107,"../../../shared/constants/network":6110,"../../../shared/modules/network.utils":6121,"./network":17,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/obs-store":1197,assert:1615,"eth-sig-util":2373,ethers:2461,loglevel:5104},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("assert"),a=e("@metamask/obs-store"),o=e("eth-sig-util"),c=e("ethers"),u=n(e("loglevel")),l=e("../../../shared/constants/network"),f=e("../../../shared/modules/network.utils"),h=e("../../../shared/constants/hardware-wallets"),d=e("./network");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.default=class{constructor(e={}){const t=g({frequentRpcListDetail:[],useBlockie:!1,useNonceField:!1,usePhishDetect:!0,dismissSeedBackUpReminder:!1,useTokenDetection:Boolean(!1),useCollectibleDetection:!1,openSeaEnabled:!1,advancedGasFee:null,featureFlags:{showIncomingTransactions:!0},knownMethodData:{},currentLocale:e.initLangCode,identities:{},lostIdentities:{},forgottenPassword:!1,preferences:{autoLockTimeLimit:undefined,showFiatInTestnets:!1,showTestNetworks:!1,useNativeCurrencyAsPrimaryCurrency:!0,hideZeroBalanceTokens:!1},ipfsGateway:l.IPFS_DEFAULT_GATEWAY_URL,infuraBlocked:null,ledgerTransportType:window.navigator.hid?h.LEDGER_TRANSPORT_TYPES.WEBHID:h.LEDGER_TRANSPORT_TYPES.U2F,theme:"light"},e.initState);this.network=e.network,this.ethersProvider=new c.ethers.providers.Web3Provider(e.provider),this.store=new a.ObservableStore(t),this.store.setMaxListeners(12),this.openPopup=e.openPopup,this.migrateAddressBookState=e.migrateAddressBookState,this._subscribeToInfuraAvailability(),global.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.store.updateState({forgottenPassword:e})}setUseBlockie(e){this.store.updateState({useBlockie:e})}setUseNonceField(e){this.store.updateState({useNonceField:e})}setUsePhishDetect(e){this.store.updateState({usePhishDetect:e})}setUseTokenDetection(e){this.store.updateState({useTokenDetection:e})}setUseCollectibleDetection(e){this.store.updateState({useCollectibleDetection:e})}setOpenSeaEnabled(e){this.store.updateState({openSeaEnabled:e})}setAdvancedGasFee(e){this.store.updateState({advancedGasFee:e})}setEIP1559V2Enabled(e){this.store.updateState({eip1559V2Enabled:e})}setTheme(e){this.store.updateState({theme:e})}addKnownMethodData(e,t){const{knownMethodData:r}=this.store.getState();r[e]=t,this.store.updateState({knownMethodData:r})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.store.updateState({currentLocale:e,textDirection:t}),t}setAddresses(e){const t=this.store.getState().identities,r=e.reduce(((e,r,n)=>{const i=t[r]||{};return e[r]=g({name:`Account ${n+1}`,address:r},i),e}),{});this.store.updateState({identities:r})}removeAddress(e){const{identities:t}=this.store.getState();if(!t[e])throw new Error(`${e} can't be deleted cause it was not found`);if(delete t[e],this.store.updateState({identities:t}),e===this.getSelectedAddress()){const e=Object.keys(t)[0];this.setSelectedAddress(e)}return e}addAddresses(e){const{identities:t}=this.store.getState();e.forEach((e=>{if(t[e])return;const r=Object.keys(t).length;t[e]={name:`Account ${r+1}`,address:e}})),this.store.updateState({identities:t})}syncAddresses(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array of addresses. Error #11201");const{identities:t,lostIdentities:r}=this.store.getState(),n={};Object.keys(t).forEach((r=>{e.includes(r)||(n[r]=t[r],delete t[r])})),Object.keys(n).length>0&&Object.keys(n).forEach((e=>{r[e]=n[e]})),this.store.updateState({identities:t,lostIdentities:r}),this.addAddresses(e);let i=this.getSelectedAddress();return e.includes(i)||(i=e[0],this.setSelectedAddress(i)),i}setSelectedAddress(e){const t=(0,o.normalize)(e),{identities:r}=this.store.getState(),n=r[t];if(!n)throw new Error(`Identity for '${t} not found`);n.lastSelected=Date.now(),this.store.updateState({identities:r,selectedAddress:t})}getSelectedAddress(){return this.store.getState().selectedAddress}setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const r=(0,o.normalize)(e),{identities:n}=this.store.getState();return n[r]=n[r]||{},n[r].name=t,this.store.updateState({identities:n}),Promise.resolve(t)}async updateRpc(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e.rpcUrl));if(r>-1){const n=t[r],i=g(g({},n),e);if(n.chainId!==i.chainId){let r=n.chainId;if(!r)try{r=await this.ethersProvider.send("net_version"),(0,s.strict)("string"==typeof r)}catch(e){u.default.debug(e),u.default.warn(`Failed to get networkId from ${n.rpcUrl}; skipping address book migration`)}let a=!1;const o=Object.values(l.NETWORK_TYPE_TO_ID_MAP).map((e=>e.networkId)),c=t.filter((t=>t.rpcUrl!==e.rpcUrl));(o.includes(r)||c.some((e=>e.chainId===r)))&&(a=!0),this.migrateAddressBookState(r,i.chainId,a)}t[r]=i,this.store.updateState({frequentRpcListDetail:t})}else{const{rpcUrl:t,chainId:r,ticker:n,nickname:i,rpcPrefs:s={}}=e;this.addToFrequentRpcList(t,r,n,i,s)}}addToFrequentRpcList(e,t,r="ETH",n="",i={}){const s=this.getFrequentRpcListDetail(),a=s.findIndex((t=>t.rpcUrl===e));if(-1!==a&&s.splice(a,1),!(0,f.isPrefixedFormattedHexString)(t))throw new Error(`Invalid chainId: "${t}"`);s.push({rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:i}),this.store.updateState({frequentRpcListDetail:s})}removeFromFrequentRpcList(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e));return-1!==r&&t.splice(r,1),this.store.updateState({frequentRpcListDetail:t}),Promise.resolve(t)}getFrequentRpcListDetail(){return this.store.getState().frequentRpcListDetail}setFeatureFlag(e,t){const r=g(g({},this.store.getState().featureFlags),{},{[e]:t});return this.store.updateState({featureFlags:r}),Promise.resolve(r)}setPreference(e,t){const r=g(g({},this.getPreferences()),{},{[e]:t});return this.store.updateState({preferences:r}),Promise.resolve(r)}getPreferences(){return this.store.getState().preferences}getIpfsGateway(){return this.store.getState().ipfsGateway}setIpfsGateway(e){return this.store.updateState({ipfsGateway:e}),Promise.resolve(e)}setLedgerTransportPreference(e){return this.store.updateState({ledgerTransportType:e}),e}getLedgerTransportPreference(){return this.store.getState().ledgerTransportType}async setDismissSeedBackUpReminder(e){await this.store.updateState({dismissSeedBackUpReminder:e})}_subscribeToInfuraAvailability(){this.network.on(d.NETWORK_EVENTS.INFURA_IS_BLOCKED,(()=>{this._setInfuraBlocked(!0)})),this.network.on(d.NETWORK_EVENTS.INFURA_IS_UNBLOCKED,(()=>{this._setInfuraBlocked(!1)}))}_setInfuraBlocked(e){const{infuraBlocked:t}=this.store.getState();t!==e&&this.store.updateState({infuraBlocked:e})}}}}},{package:"$root$"}],[30,{"../../../shared/constants/gas":6106,"../../../shared/constants/swaps":6112,"../../../shared/constants/time":6113,"../../../shared/modules/conversion.utils":6117,"../../../shared/modules/string-utils":6124,"../../../shared/modules/swaps.utils":6125,"../../../ui/helpers/utils/fetch-with-cache":6652,"../../../ui/helpers/utils/token-util":6666,"../../../ui/pages/send/send.utils":6907,"../../../ui/pages/swaps/swaps.util":7018,"./network":17,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/obs-store":1197,"bignumber.js":1875,ethers:2461,"human-standard-token-abi":4300,lodash:5091,loglevel:5104},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("ethers"),a=n(e("loglevel")),o=n(e("bignumber.js")),c=e("@metamask/obs-store"),u=e("lodash"),l=n(e("human-standard-token-abi")),f=e("../../../ui/helpers/utils/token-util"),h=e("../../../ui/pages/send/send.utils"),d=e("../../../shared/modules/conversion.utils"),p=e("../../../shared/constants/swaps"),g=e("../../../shared/constants/gas"),m=e("../../../shared/modules/swaps.utils"),_=e("../../../ui/pages/swaps/swaps.util"),b=n(e("../../../ui/helpers/utils/fetch-with-cache")),y=e("../../../shared/constants/time"),v=e("../../../shared/modules/string-utils"),w=e("./network");function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const S=25e5,T=y.MINUTE,A=10*y.SECOND;function x(e=25e5,t=0,r=0){const n=new o.default(e,10).minus(t,10);return!n.lt(0)&&n.lt(r,16)?`0x${n.toString(16)}`:r}const P={swapsState:{quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:T,swapsQuotePrefetchingRefreshTime:T,swapsStxBatchStatusRefreshTime:A,swapsStxGetTransactionsRefreshTime:A,swapsFeatureFlags:{}}};function I(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort(((e,t)=>{const r=new o.default(e.overallValueOfQuote,10),n=new o.default(t.overallValueOfQuote,10);return r.equals(n)?0:r.lessThan(n)?-1:1})),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return N(t.filter((t=>e===t.overallValueOfQuote)))}const r=t.length/2,n=r-1,i=t[r].overallValueOfQuote,s=t[n].overallValueOfQuote,a=t.filter((e=>i===e.overallValueOfQuote)),c=t.filter((e=>s===e.overallValueOfQuote)),u=N(a),l=N(c);return{ethFee:new o.default(u.ethFee,10).plus(l.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new o.default(u.metaMaskFeeInEth,10).plus(l.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new o.default(u.ethValueOfTokens,10).plus(l.ethValueOfTokens,10).dividedBy(2).toString(10)}}function N(e){const t=e.reduce(((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)})),{ethFee:new o.default(0,10),metaMaskFeeInEth:new o.default(0,10),ethValueOfTokens:new o.default(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}r.default=class{constructor({getBufferedGasLimit:e,networkController:t,provider:r,getProviderConfig:n,getTokenRatesState:i,fetchTradesInfo:a=_.fetchTradesInfo,getCurrentChainId:o,getEIP1559GasFeeEstimates:u}){this.store=new c.ObservableStore({swapsState:k({},P.swapsState)}),this._fetchTradesInfo=a,this._getCurrentChainId=o,this._getEIP1559GasFeeEstimates=u,this.getBufferedGasLimit=e,this.getTokenRatesState=i,this.pollCount=0,this.getProviderConfig=n,this.indexOfNewestCallInFlight=0,this.ethersProvider=new s.ethers.providers.Web3Provider(r),this._currentNetwork=t.store.getState().network,t.on(w.NETWORK_EVENTS.NETWORK_DID_CHANGE,(e=>{"loading"!==e&&e!==this._currentNetwork&&(this._currentNetwork=e,this.ethersProvider=new s.ethers.providers.Web3Provider(r))}))}async fetchSwapsRefreshRates(e){const t=await(0,b.default)((0,_.getBaseApi)("network",e),{method:"GET"},{cacheRefreshTime:6e5}),{refreshRates:r}=t||{};if(!r||"number"!=typeof r.quotes||"number"!=typeof r.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*r.quotes,quotesPrefetching:1e3*r.quotesPrefetching,stxGetTransactions:1e3*r.stxGetTransactions,stxBatchStatus:1e3*r.stxBatchStatus,stxStatusDeadline:r.stxStatusDeadline}}async _setSwapsRefreshRates(){var e,t,r,n,i;const s=this._getCurrentChainId();let a;try{a=await this.fetchSwapsRefreshRates(s)}catch(e){console.error("Request for swaps quote refresh time failed: ",e)}const{swapsState:o}=this.store.getState();this.store.updateState({swapsState:k(k({},o),{},{swapsQuoteRefreshTime:(null===(e=a)||void 0===e?void 0:e.quotes)||T,swapsQuotePrefetchingRefreshTime:(null===(t=a)||void 0===t?void 0:t.quotesPrefetching)||T,swapsStxGetTransactionsRefreshTime:(null===(r=a)||void 0===r?void 0:r.stxGetTransactions)||A,swapsStxBatchStatusRefreshTime:(null===(n=a)||void 0===n?void 0:n.stxBatchStatus)||A,swapsStxStatusDeadline:(null===(i=a)||void 0===i?void 0:i.stxStatusDeadline)||180})})}pollForNewQuotes(){const{swapsState:{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:r}}=this.store.getState(),n=r?e:t;this.pollingTimeout=setTimeout((()=>{var e;const{swapsState:t}=this.store.getState();this.fetchAndSetQuotes(t.fetchParams,null===(e=t.fetchParams)||void 0===e?void 0:e.metaData,!0)}),n)}stopPollingForQuotes(){this.pollingTimeout&&clearTimeout(this.pollingTimeout)}async fetchAndSetQuotes(e,t={},r){const{chainId:n}=t,{swapsState:{quotesPollingLimitEnabled:i,saveFetchedQuotes:s}}=this.store.getState();if(!e)return null;r||(this.pollCount=0),clearTimeout(this.pollingTimeout),r||this.setSwapsErrorKey("");const a=this.indexOfNewestCallInFlight+1;this.indexOfNewestCallInFlight=a,s||this.setSaveFetchedQuotes(!0);let[o]=await Promise.all([this._fetchTradesInfo(e,k({},t)),this._setSwapsRefreshRates()]);const{swapsState:{saveFetchedQuotes:c}}=this.store.getState();if(!c)return[{},null];o=(0,u.mapValues)(o,(e=>k(k({},e),{},{sourceTokenInfo:t.sourceTokenInfo,destinationTokenInfo:t.destinationTokenInfo})));const l=Date.now();let f=!1;if(!(0,m.isSwapsDefaultTokenAddress)(e.sourceToken,n)&&Object.values(o).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,n),[i]=Object.values(o);if(f=i.approvalNeeded&&t.eq(0)&&"wrappedNative"!==i.aggregator,f){if(!r){const{gasLimit:e}=await this.timedoutGasReturn(i.approvalNeeded);o=(0,u.mapValues)(o,(t=>k(k({},t),{},{approvalNeeded:k(k({},t.approvalNeeded),{},{gas:e||p.DEFAULT_ERC20_APPROVE_GAS})})))}}else o=(0,u.mapValues)(o,(e=>k(k({},e),{},{approvalNeeded:null})))}let h=null;if(f||null!=e&&e.balanceError||(o=await this.getAllQuotesWithGasEstimates(o)),0===Object.values(o).length)this.setSwapsErrorKey(p.QUOTES_NOT_AVAILABLE_ERROR);else{const[e,t]=await this._findTopQuoteAndCalculateSavings(o);h=e,o=t}if(this.indexOfNewestCallInFlight!==a)throw new Error(p.SWAPS_FETCH_ORDER_CONFLICT);const{swapsState:d}=this.store.getState();let{selectedAggId:g}=d;return o[g]||(g=null),this.store.updateState({swapsState:k(k({},d),{},{quotes:o,fetchParams:k(k({},e),{},{metaData:t}),quotesLastFetched:l,selectedAggId:g,topAggId:h})}),i&&(this.pollCount+=1),!i||this.pollCount<4?(this.pollForNewQuotes(),[o,h]):(this.resetPostFetchState(),this.setSwapsErrorKey(p.QUOTES_EXPIRED_ERROR),null)}safeRefetchQuotes(){const{swapsState:e}=this.store.getState();!this.pollingTimeout&&e.fetchParams&&this.fetchAndSetQuotes(e.fetchParams)}setSelectedQuoteAggId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{selectedAggId:e})})}setSwapsTokens(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{tokens:e})})}clearSwapsQuotes(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:k(k({},e),{},{quotes:{}})})}setSwapsErrorKey(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{errorKey:e})})}async getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map((async e=>{const{gasLimit:t,simulationFails:r}=await this.timedoutGasReturn(e.trade);return[t,r,e.aggregator]}))),r={};return t.forEach((([t,n,i])=>{if(t&&!n){const n=x(e[i].maxGas,e[i].estimatedRefund,t);r[i]=k(k({},e[i]),{},{gasEstimate:t,gasEstimateWithRefund:n})}else e[i].approvalNeeded&&(r[i]=e[i])})),r}timedoutGasReturn(e){return new Promise((t=>{let r=!1;const n=setTimeout((()=>{r=!0,t({gasLimit:null,simulationFails:!0})}),5*y.SECOND),i={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:i},1).then((({gasLimit:e,simulationFails:i})=>{r||(clearTimeout(n),t({gasLimit:e,simulationFails:i}))})).catch((e=>{a.default.error(e),r||(clearTimeout(n),t({gasLimit:null,simulationFails:!0}))}))}))}async setInitialGasEstimate(e){const{swapsState:t}=this.store.getState(),r=k({},t.quotes[e]),{gasLimit:n,simulationFails:i}=await this.timedoutGasReturn(r.trade);if(n&&!i){const e=x(r.maxGas,r.estimatedRefund,n);r.gasEstimate=n,r.gasEstimateWithRefund=e}this.store.updateState({swapsState:k(k({},t),{},{quotes:k(k({},t.quotes),{},{[e]:r})})})}setApproveTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{approveTxId:e})})}setTradeTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{tradeTxId:e})})}setQuotesLastFetched(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{quotesLastFetched:e})})}setSwapsTxGasPrice(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customGasPrice:e})})}setSwapsTxMaxFeePerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customMaxFeePerGas:e})})}setSwapsUserFeeLevel(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{swapsUserFeeLevel:e})})}setSwapsQuotesPollingLimitEnabled(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{quotesPollingLimitEnabled:e})})}setSwapsTxMaxFeePriorityPerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customMaxPriorityFeePerGas:e})})}setSwapsTxGasLimit(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customMaxGas:e})})}setCustomApproveTxData(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{customApproveTxData:e})})}setBackgroundSwapRouteState(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{routeState:e})})}setSaveFetchedQuotes(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{saveFetchedQuotes:e})})}setSwapsLiveness(e){const{swapsState:t}=this.store.getState(),{swapsFeatureIsLive:r}=e;this.store.updateState({swapsState:k(k({},t),{},{swapsFeatureIsLive:r})})}setSwapsFeatureFlags(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:k(k({},t),{},{swapsFeatureFlags:e})})}resetPostFetchState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:k(k({},P.swapsState),{},{tokens:e.tokens,fetchParams:e.fetchParams,swapsFeatureIsLive:e.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsFeatureFlags})}),clearTimeout(this.pollingTimeout)}resetSwapsState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:k(k({},P.swapsState),{},{swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime})}),clearTimeout(this.pollingTimeout)}async _findTopQuoteAndCalculateSavings(e={}){const{contractExchangeRates:t}=this.getTokenRatesState(),{swapsState:{customGasPrice:r,customMaxPriorityFeePerGas:n}}=this.store.getState(),i=this._getCurrentChainId();if(!Object.keys(e).length)return{};const s=(0,u.cloneDeep)(e),{gasFeeEstimates:a,gasEstimateType:c}=await this._getEIP1559GasFeeEstimates();let l="0x0";if(c===g.GAS_ESTIMATE_TYPES.FEE_MARKET){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=a;l=(0,d.addCurrencies)(n||(0,d.decGWEIToHexWEI)(e),(0,d.decGWEIToHexWEI)(t),{aBase:16,bBase:16,toNumericBase:"hex",numberOfDecimals:6})}else c===g.GAS_ESTIMATE_TYPES.LEGACY?l=r||(0,d.decGWEIToHexWEI)(a.high):c===g.GAS_ESTIMATE_TYPES.ETH_GASPRICE&&(l=r||(0,d.decGWEIToHexWEI)(a.gasPrice));let p=null,_=null;Object.values(s).forEach((e=>{const{aggregator:r,approvalNeeded:n,averageGas:s,destinationAmount:a=0,destinationToken:c,destinationTokenInfo:u,gasEstimate:g,sourceAmount:b,sourceToken:y,trade:w,fee:E}=e,k=(g?new o.default(g,16):new o.default(s||S,10)).plus((null==n?void 0:n.gas)||"0x0",16).toString(16),T=(0,h.calcGasTotal)(k,l),A=new o.default(T,16).plus(w.value,16),x=(0,d.conversionUtil)(A,{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}),P=(0,m.isSwapsDefaultTokenAddress)(y,i)?(0,d.conversionUtil)(A.minus(b,10),{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}):x,I=(0,f.calcTokenAmount)(a,u.decimals),N=new o.default(100,10).minus(E,10).div(100),C=I.div(N).minus(I),R=t[Object.keys(t).find((e=>(0,v.isEqualCaseInsensitive)(e,c)))],O=R||1,L=I.times(O.toString(10),10),D=(0,m.isSwapsDefaultTokenAddress)(c,i)?1:R,B=D===undefined?L:L.minus(P,10);e.ethFee=P.toString(10),D!==undefined&&(e.ethValueOfTokens=L.toString(10),e.overallValueOfQuote=B.toString(10),e.metaMaskFeeInEth=C.times(D.toString(10)).toString(10)),(null===_||B.gt(_))&&(p=r,_=B)}));let b=null;if((0,m.isSwapsDefaultTokenAddress)(s[p].destinationToken,i)||Boolean(t[Object.keys(t).find((e=>{var t;return(0,v.isEqualCaseInsensitive)(e,null===(t=s[p])||void 0===t?void 0:t.destinationToken)}))])){const e=s[p];b={};const{ethFee:t,metaMaskFeeInEth:r,ethValueOfTokens:n}=I(Object.values(s));b.performance=new o.default(e.ethValueOfTokens,10).minus(n,10),b.fee=new o.default(t).minus(e.ethFee,10),b.metaMaskFee=e.metaMaskFeeInEth,b.total=b.performance.plus(b.fee).minus(b.metaMaskFee).toString(10),b.performance=b.performance.toString(10),b.fee=b.fee.toString(10),b.medianMetaMaskFee=r,s[p].isBestQuote=!0,s[p].savings=b}return[p,s]}async _getERC20Allowance(e,t,r){const n=new s.ethers.Contract(e,l.default,this.ethersProvider);return await n.allowance(t,p.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[r])}};const C={getMedianEthValueQuote:I,meansOfQuotesFeesAndValue:N};r.utils=C}}},{package:"$root$"}],[31,{"../../../development/mock-3box":160,"../lib/createOriginMiddleware":47,"../lib/migrator":63,"../migrations":156,"./network/createMetamaskMiddleware":16,"3box":166,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/obs-store":1197,_process:5342,"eth-json-rpc-middleware":2321,"json-rpc-engine":4641,loglevel:5104},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),a=n(e("loglevel")),o=e("json-rpc-engine"),c=e("eth-json-rpc-middleware"),u=n(e("../lib/migrator")),l=n(e("../migrations")),f=n(e("../lib/createOriginMiddleware")),h=n(e("./network/createMetamaskMiddleware"));function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const g=t.env.IN_TEST?e("../../../development/mock-3box"):e("3box");r.default=class{constructor(e={}){const{preferencesController:t,keyringController:r,addressBookController:n,version:i,getKeyringControllerState:a,trackMetaMetricsEvent:o}=e;this.preferencesController=t,this.addressBookController=n,this.keyringController=r,this.provider=this._createProvider({version:i,getAccounts:async({origin:e})=>{if("3Box"!==e)return[];const{isUnlocked:t}=a(),r=await this.keyringController.getAccounts();if(t&&r[0]){return[await this.keyringController.getAppKeyAddress(r[0],"wallet://3box.metamask.io")]}return[]},processPersonalMessage:async e=>{const t=await this.keyringController.getAccounts();return r.signPersonalMessage(p(p({},e),{},{from:t[0]}),{withAppKeyOrigin:"wallet://3box.metamask.io"})}}),this._trackMetaMetricsEvent=o;const c=p(p({threeBoxSyncingAllowed:!1,showRestorePrompt:!0,threeBoxLastUpdated:0},e.initState),{},{threeBoxAddress:null,threeBoxSynced:!1,threeBoxDisabled:!1});this.store=new s.ObservableStore(c),this.registeringUpdates=!1,this.lastMigration=l.default.sort(((e,t)=>e.version-t.version)).slice(-1)[0],c.threeBoxSyncingAllowed&&this.init()}async init(){const e=await this.keyringController.getAccounts();this.address=e[0],this._trackMetaMetricsEvent({event:"3Box Initiated",category:"3Box"}),!this.address||this.box&&this.store.getState().threeBoxSynced||await this.new3Box()}async _update3Box(){try{const{threeBoxSyncingAllowed:e,threeBoxSynced:t}=this.store.getState();if(e&&t){const e={preferences:this.preferencesController.store.getState(),addressBook:this.addressBookController.state,lastUpdated:Date.now(),lastMigration:this.lastMigration};await this.space.private.set("metamaskBackup",JSON.stringify(e)),await this.setShowRestorePromptToFalse()}}catch(e){console.error(e)}}_createProvider(e){const t=(0,h.default)(e),r=new o.JsonRpcEngine;r.push((0,f.default)({origin:"3Box"})),r.push(t);return(0,c.providerFromEngine)(r)}_waitForOnSyncDone(){return new Promise((e=>{this.box.onSyncDone((()=>(a.default.debug("3Box box sync done"),e())))}))}async new3Box(){const e=await this.keyringController.getAccounts();let t;this.address=await this.keyringController.getAppKeyAddress(e[0],"wallet://3box.metamask.io");try{const e=await g.getConfig(this.address);t=e.spaces&&e.spaces.metamask}catch(e){if(!e.message.match(/^Error: Invalid response \(404\)/u))throw this._trackMetaMetricsEvent({event:"3Box Config Error",category:"3Box"}),e;this._trackMetaMetricsEvent({event:"3Box Backup does not exist",category:"3Box"}),t=!1}if(this.getThreeBoxSyncingState()||t){this.store.updateState({threeBoxSynced:!1});let e=!1;const t=setTimeout((()=>{a.default.error("3Box sync timed out after 60000 ms"),e=!0,this.store.updateState({threeBoxDisabled:!0,threeBoxSyncingAllowed:!1})}),6e4);try{this.box=await g.openBox(this.address,this.provider),await this._waitForOnSyncDone(),this.space=await this.box.openSpace("metamask",{onSyncDone:async()=>{const r={threeBoxSynced:!0,threeBoxAddress:this.address};e&&(a.default.info("3Box sync completed after timeout; no longer disabled"),r.threeBoxDisabled=!1),clearTimeout(t),this.store.updateState(r),a.default.debug("3Box space sync done"),this._trackMetaMetricsEvent({event:"3Box Synced",category:"3Box"})}})}catch(e){throw this._trackMetaMetricsEvent({event:"3Box Initiation Error",category:"3Box"}),console.error(e),e}}}async getLastUpdated(){const e=await this.space.private.get("metamaskBackup");return JSON.parse(e||"{}").lastUpdated}async migrateBackedUpState(e){const t=new u.default({migrations:l.default}),{preferences:r,addressBook:n}=JSON.parse(e),i={PreferencesController:r,AddressBookController:n},s=t.generateInitialState(i),a=await t.migrateData(s);return{preferences:a.data.PreferencesController,addressBook:a.data.AddressBookController}}async restoreFromThreeBox(){const e=await this.space.private.get("metamaskBackup"),{preferences:t,addressBook:r}=await this.migrateBackedUpState(e);this.store.updateState({threeBoxLastUpdated:e.lastUpdated}),t&&this.preferencesController.store.updateState(t),r&&this.addressBookController.update(r,!0),this.setShowRestorePromptToFalse(),this._trackMetaMetricsEvent({event:"3Box Restored Data",category:"3Box"})}turnThreeBoxSyncingOn(){this._trackMetaMetricsEvent({event:"3Box Sync Turned On",category:"3Box"}),this._registerUpdates()}turnThreeBoxSyncingOff(){this._trackMetaMetricsEvent({event:"3Box Sync Turned Off",category:"3Box"}),this.box.logout()}setShowRestorePromptToFalse(){this.store.updateState({showRestorePrompt:!1})}setThreeBoxSyncingPermission(e){this.store.getState().threeBoxDisabled||(this.store.updateState({threeBoxSyncingAllowed:e}),e&&this.box&&this.turnThreeBoxSyncingOn(),!e&&this.box&&this.turnThreeBoxSyncingOff())}getThreeBoxSyncingState(){return this.store.getState().threeBoxSyncingAllowed}_registerUpdates(){if(!this.registeringUpdates){const e=this._update3Box.bind(this);this.preferencesController.store.subscribe(e);const t=this._update3Box.bind(this);this.addressBookController.subscribe(t),this.registeringUpdates=!0}}}}).call(this)}).call(this,e("_process"))}}},{package:"$root$"}],[32,{"../../../../shared/constants/app":6105,"../../../../shared/constants/gas":6106,"../../../../shared/constants/metametrics":6109,"../../../../shared/constants/network":6110,"../../../../shared/constants/transaction":6114,"../../../../shared/modules/conversion.utils":6117,"../../../../shared/modules/transaction.utils":6126,"../../../../ui/helpers/constants/error-keys":6632,"../../../../ui/helpers/constants/transactions":6637,"../../../../ui/helpers/utils/conversions.util":6651,"../../../../ui/pages/swaps/swaps.util":7018,"../../lib/cleanErrorStack":43,"../../lib/util":83,"../../metamask-controller":84,"./lib/util":34,"./pending-tx-tracker":35,"./tx-gas-utils":36,"./tx-state-manager":37,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@ethereumjs/common":405,"@ethereumjs/tx":409,"@metamask/obs-store":1197,"bignumber.js":1875,"eth-rpc-errors":2371,"ethereumjs-util":2437,"ethjs-query":2486,lodash:5091,loglevel:5104,"nonce-tracker":5218,"safe-event-emitter":5661},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),a=e("@metamask/obs-store"),o=e("ethereumjs-util"),c=n(e("ethjs-query")),u=e("eth-rpc-errors"),l=n(e("@ethereumjs/common")),f=e("@ethereumjs/tx"),h=n(e("nonce-tracker")),d=n(e("loglevel")),p=n(e("bignumber.js")),g=e("lodash"),m=n(e("../../lib/cleanErrorStack")),_=e("../../lib/util"),b=e("../../../../ui/helpers/constants/error-keys"),y=e("../../../../ui/pages/swaps/swaps.util"),v=e("../../../../ui/helpers/utils/conversions.util"),w=e("../../../../shared/constants/transaction"),E=e("../../../../ui/helpers/constants/transactions"),k=e("../../metamask-controller"),S=e("../../../../shared/constants/gas"),T=e("../../../../shared/modules/conversion.utils"),A=e("../../../../shared/constants/metametrics"),x=e("../../../../shared/constants/network"),P=e("../../../../shared/modules/transaction.utils"),I=e("../../../../shared/constants/app"),N=n(e("./tx-state-manager")),C=n(e("./tx-gas-utils")),R=n(e("./pending-tx-tracker")),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=L(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(e("./lib/util"));function L(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(L=function(e){return e?r:t})(e)}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const M=[w.TRANSACTION_TYPES.SWAP,w.TRANSACTION_TYPES.SWAP_APPROVAL],U=[...M,w.TRANSACTION_TYPES.SIMPLE_SEND,w.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER,w.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM],F="failed on-chain";class G extends s.default{constructor(e){super(),this.networkStore=e.networkStore||new a.ObservableStore({}),this._getCurrentChainId=e.getCurrentChainId,this.getProviderConfig=e.getProviderConfig,this._getCurrentNetworkEIP1559Compatibility=e.getCurrentNetworkEIP1559Compatibility,this._getCurrentAccountEIP1559Compatibility=e.getCurrentAccountEIP1559Compatibility,this.preferencesStore=e.preferencesStore||new a.ObservableStore({}),this.provider=e.provider,this.getPermittedAccounts=e.getPermittedAccounts,this.blockTracker=e.blockTracker,this.signEthTx=e.signTransaction,this.inProcessOfSigning=new Set,this._trackMetaMetricsEvent=e.trackMetaMetricsEvent,this._getParticipateInMetrics=e.getParticipateInMetrics,this._getEIP1559GasFeeEstimates=e.getEIP1559GasFeeEstimates,this.createEventFragment=e.createEventFragment,this.updateEventFragment=e.updateEventFragment,this.finalizeEventFragment=e.finalizeEventFragment,this.getEventFragmentById=e.getEventFragmentById,this.getDeviceModel=e.getDeviceModel,this.getAccountType=e.getAccountType,this.getTokenStandardAndDetails=e.getTokenStandardAndDetails,this.memStore=new a.ObservableStore({}),this.query=new c.default(this.provider),this.txGasUtil=new C.default(this.provider),this._mapMethods(),this.txStateManager=new N.default({initState:e.initState,txHistoryLimit:e.txHistoryLimit,getNetwork:this.getNetwork.bind(this),getCurrentChainId:e.getCurrentChainId}),this._onBootCleanUp(),this.store=this.txStateManager.store,this.nonceTracker=new h.default({provider:this.provider,blockTracker:this.blockTracker,getPendingTransactions:(...t)=>[...this.txStateManager.getPendingTransactions(...t),...e.getExternalPendingTransactions(...t)],getConfirmedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.pendingTxTracker=new R.default({provider:this.provider,nonceTracker:this.nonceTracker,publishTransaction:e=>this.query.sendRawTransaction(e),getPendingTransactions:()=>[...this.txStateManager.getPendingTransactions(),...this.txStateManager.getApprovedTransactions()],approveTransaction:this.approveTransaction.bind(this),getCompletedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.txStateManager.store.subscribe((()=>this.emit(k.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE))),this._setupListeners(),this._updateMemstore(),this.txStateManager.store.subscribe((()=>this._updateMemstore())),this.networkStore.subscribe((()=>{this._onBootCleanUp(),this._updateMemstore()})),this._updatePendingTxsAfterFirstBlock()}getChainId(){const e=this.networkStore.getState(),t=this._getCurrentChainId(),r=parseInt(t,16);return"loading"===e||Number.isNaN(r)?0:r}async getEIP1559Compatibility(e){const t=await this._getCurrentNetworkEIP1559Compatibility(),r=await this._getCurrentAccountEIP1559Compatibility(e);return t&&r}async getCommonConfiguration(e){const{type:t,nickname:r}=this.getProviderConfig(),n=await this.getEIP1559Compatibility(e)?x.HARDFORKS.LONDON:x.HARDFORKS.BERLIN;if(t!==x.NETWORK_TYPE_RPC)return new l.default({chain:t,hardfork:n});const i=parseInt(this._getCurrentChainId(),16),s=this.networkStore.getState(),a={name:r,chainId:i,networkId:"loading"===s?0:parseInt(s,10)};return l.default.forCustomChain(x.MAINNET,a,n)}addTransaction(e){this.txStateManager.addTransaction(e),this.emit(`${e.id}:unapproved`,e),this._trackTransactionMetricsEvent(e,w.TRANSACTION_EVENTS.ADDED)}wipeTransactions(e){this.txStateManager.wipeTransactions(e)}async newUnapprovedTransaction(e,t={}){d.default.debug(`MetaMaskController newUnapprovedTransaction ${JSON.stringify(e)}`);const r=await this.addUnapprovedTransaction(e,t.origin);return new Promise(((e,t)=>{this.txStateManager.once(`${r.id}:finished`,(r=>{switch(r.status){case w.TRANSACTION_STATUSES.SUBMITTED:return e(r.hash);case w.TRANSACTION_STATUSES.REJECTED:return t((0,m.default)(u.ethErrors.provider.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.")));case w.TRANSACTION_STATUSES.FAILED:return t((0,m.default)(u.ethErrors.rpc.internal(r.err.message)));default:return t((0,m.default)(u.ethErrors.rpc.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(r.txParams)}`)))}}))}))}_getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}_isUnapprovedTransaction(e){return this.txStateManager.getTransaction(e).status===w.TRANSACTION_STATUSES.UNAPPROVED}_throwErrorIfNotUnapprovedTx(e,t){if(!this._isUnapprovedTransaction(e))throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n         Current tx status: ${this.txStateManager.getTransaction(e).status}`)}_updateTransaction(e,t,r){const n=this.txStateManager.getTransaction(e),i=(0,g.merge)(n,t);this.txStateManager.updateTransaction(i,r)}updatePreviousGasParams(e,{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}){const i={previousGas:{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}};i.previousGas=(0,g.pickBy)(i.previousGas);const s=`Update Previous Gas for ${e}`;return this._updateTransaction(e,i,s),this._getTransaction(e)}updateEditableParams(e,{data:t,from:r,to:n,value:i,gas:s,gasPrice:a}){this._throwErrorIfNotUnapprovedTx(e,"updateEditableParams");const o={txParams:{data:t,from:r,to:n,value:i,gas:s,gasPrice:a}};o.txParams=(0,g.pickBy)(o.txParams);const c=`Update Editable Params for ${e}`;return this._updateTransaction(e,o,c),this._getTransaction(e)}updateTransactionGasFees(e,{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:s,estimateUsed:a,estimateSuggested:o,defaultGasEstimates:c,originalGasEstimate:u,userEditedGasLimit:l,userFeeLevel:f}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionGasFees");let h={txParams:{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:s},estimateUsed:a,estimateSuggested:o,defaultGasEstimates:c,originalGasEstimate:u,userEditedGasLimit:l,userFeeLevel:f};h.txParams=(0,g.pickBy)(h.txParams),h=(0,g.pickBy)(h);const d=`Update Transaction Gas Fees for ${e}`;return this._updateTransaction(e,h,d),this._getTransaction(e)}updateTransactionEstimatedBaseFee(e,{estimatedBaseFee:t,decEstimatedBaseFee:r}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionEstimatedBaseFee");let n={estimatedBaseFee:t,decEstimatedBaseFee:r};n=(0,g.pickBy)(n);const i=`Update Transaction Estimated Base Fees for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateSwapApprovalTransaction(e,{type:t,sourceTokenSymbol:r}){this._throwErrorIfNotUnapprovedTx(e,"updateSwapApprovalTransaction");let n={type:t,sourceTokenSymbol:r};n=(0,g.pickBy)(n);const i=`Update Swap Approval Transaction for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateSwapTransaction(e,{sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:s,swapMetaData:a,swapTokenValue:o,estimatedBaseFee:c,approvalTxId:u}){this._throwErrorIfNotUnapprovedTx(e,"updateSwapTransaction");let l={sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:s,swapMetaData:a,swapTokenValue:o,estimatedBaseFee:c,approvalTxId:u};l=(0,g.pickBy)(l);const f=`Update Swap Transaction for ${e}`;return this._updateTransaction(e,l,f),this._getTransaction(e)}updateTransactionUserSettings(e,{userEditedGasLimit:t,userFeeLevel:r}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionUserSettings");let n={userEditedGasLimit:t,userFeeLevel:r};n=(0,g.pickBy)(n);const i=`Update User Settings for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateTransactionSendFlowHistory(e,t){var r;this._throwErrorIfNotUnapprovedTx(e,"updateTransactionSendFlowHistory");const n=this._getTransaction(e),i=`Update sendFlowHistory for ${e}`;return this.txStateManager.updateTransaction(B(B({},n),{},{sendFlowHistory:[...null!==(r=null==n?void 0:n.sendFlowHistory)&&void 0!==r?r:[],...t]}),i),this._getTransaction(e)}async addUnapprovedTransaction(e,t,r,n=[]){if(r!==undefined&&!U.includes(r))throw new Error(`TransactionController - invalid transactionType value: ${r}`);const i=O.normalizeTxParams(e),s=await this.getEIP1559Compatibility();O.validateTxParams(i,s);let a=this.txStateManager.generateTxMeta({txParams:i,origin:t,sendFlowHistory:n});if(t===I.ORIGIN_METAMASK){if(i.from!==this.getSelectedAddress())throw u.ethErrors.rpc.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:t,fromAddress:i.from,selectedAddress:this.getSelectedAddress()}})}else{if(!(await this.getPermittedAccounts(t)).includes(i.from))throw u.ethErrors.provider.unauthorized({data:{origin:t}})}const{type:o,getCodeResponse:c}=await(0,P.determineTransactionType)(e,this.query);a.type=r||o,a.txParams.value=a.txParams.value?(0,_.addHexPrefix)(a.txParams.value):"0x0",this.addTransaction(a),this.emit("newUnapprovedTx",a);try{a=await this.addTxGasDefaults(a,c)}catch(e){throw d.default.warn(e),a=this.txStateManager.getTransaction(a.id),a.loadingDefaults=!1,this.txStateManager.updateTransaction(a,"Failed to calculate gas defaults."),e}return a.loadingDefaults=!1,this.txStateManager.updateTransaction(a,"Added new unapproved transaction."),a}async addTxGasDefaults(e,t){const r=e.txParams.type!==w.TRANSACTION_ENVELOPE_TYPES.LEGACY&&await this.getEIP1559Compatibility(),{gasPrice:n,maxFeePerGas:i,maxPriorityFeePerGas:s}=await this._getDefaultGasFees(e,r),{gasLimit:a,simulationFails:o}=await this._getDefaultGasLimit(e,t);if(e=this.txStateManager.getTransaction(e.id),o&&(e.simulationFails=o),r){const{eip1559V2Enabled:t}=this.preferencesStore.getState(),r=this.getAdvancedGasFee();t&&Boolean(r)&&!M.includes(e.type)?(e.userFeeLevel=S.CUSTOM_GAS_ESTIMATE,e.txParams.maxFeePerGas=(0,T.decGWEIToHexWEI)(r.maxBaseFee),e.txParams.maxPriorityFeePerGas=(0,T.decGWEIToHexWEI)(r.priorityFee)):!e.txParams.gasPrice||e.txParams.maxFeePerGas||e.txParams.maxPriorityFeePerGas?(i&&s&&!e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas||e.origin===I.ORIGIN_METAMASK?e.userFeeLevel=S.GAS_RECOMMENDATIONS.MEDIUM:e.userFeeLevel=t?S.PRIORITY_LEVELS.DAPP_SUGGESTED:S.CUSTOM_GAS_ESTIMATE,i&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=i),s&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=s),n&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=n),e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=e.txParams.maxFeePerGas)):(e.txParams.maxFeePerGas=e.txParams.gasPrice,e.txParams.maxPriorityFeePerGas=e.txParams.gasPrice,t&&e.origin!==I.ORIGIN_METAMASK?e.userFeeLevel=S.PRIORITY_LEVELS.DAPP_SUGGESTED:e.userFeeLevel=S.CUSTOM_GAS_ESTIMATE),delete e.txParams.gasPrice}else delete e.txParams.maxPriorityFeePerGas,delete e.txParams.maxFeePerGas;return!n||e.txParams.gasPrice||e.txParams.maxPriorityFeePerGas||e.txParams.maxFeePerGas||(e.txParams.gasPrice=n),a&&!e.txParams.gas&&(e.txParams.gas=a,e.originalGasEstimate=a),e.defaultGasEstimates={estimateType:e.userFeeLevel,gas:e.txParams.gas,gasPrice:e.txParams.gasPrice,maxFeePerGas:e.txParams.maxFeePerGas,maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas},e}async _getDefaultGasFees(e,t){if(!t&&e.txParams.gasPrice||t&&e.txParams.maxFeePerGas&&e.txParams.maxPriorityFeePerGas)return{};try{const{gasFeeEstimates:e,gasEstimateType:r}=await this._getEIP1559GasFeeEstimates();if(t&&r===S.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:r}={}}=e;if(t&&r)return{maxFeePerGas:(0,T.decGWEIToHexWEI)(r),maxPriorityFeePerGas:(0,T.decGWEIToHexWEI)(t)}}else{if(r===S.GAS_ESTIMATE_TYPES.LEGACY)return{gasPrice:(0,T.decGWEIToHexWEI)(e.medium)};if(r===S.GAS_ESTIMATE_TYPES.ETH_GASPRICE)return{gasPrice:(0,T.decGWEIToHexWEI)(e.gasPrice)}}}catch(e){console.error(e)}const r=await this.query.gasPrice();return{gasPrice:r&&(0,_.addHexPrefix)(r.toString(16))}}async _getDefaultGasLimit(e,t){const r=this._getCurrentChainId(),n=x.CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP[r],i=(0,_.getChainType)(r);if(e.txParams.gas)return{};if(e.txParams.to&&e.type===w.TRANSACTION_TYPES.SIMPLE_SEND&&"custom"!==i){if(e.txParams.data){const e=new Error("TxGasUtil - Trying to call a function on a non-contract address");throw e.errorKey=b.TRANSACTION_NO_CONTRACT_ERROR_KEY,e.getCodeResponse=t,e}return{gasLimit:S.GAS_LIMITS.SIMPLE}}const{blockGasLimit:s,estimatedGasHex:a,simulationFails:o}=await this.txGasUtil.analyzeGasUsage(e);return{gasLimit:this.txGasUtil.addGasBuffer((0,_.addHexPrefix)(a),s,n),simulationFails:o}}generateNewGasParams(e,t={},r=11){const{txParams:n}=e,i={},s={};var a;t.gasLimit&&(s.gas=null!==(a=null==t?void 0:t.gas)&&void 0!==a?a:S.GAS_LIMITS.SIMPLE);return t.estimateSuggested&&(s.estimateSuggested=t.estimateSuggested),t.estimateUsed&&(s.estimateUsed=t.estimateUsed),(0,P.isEIP1559Transaction)(e)?(i.maxFeePerGas=n.maxFeePerGas,i.maxPriorityFeePerGas=n.maxPriorityFeePerGas,s.maxFeePerGas=(null==t?void 0:t.maxFeePerGas)||(0,_.bnToHex)((0,_.BnMultiplyByFraction)((0,_.hexToBn)(n.maxFeePerGas),r,10)),s.maxPriorityFeePerGas=(null==t?void 0:t.maxPriorityFeePerGas)||(0,_.bnToHex)((0,_.BnMultiplyByFraction)((0,_.hexToBn)(n.maxPriorityFeePerGas),r,10))):(i.gasPrice=n.gasPrice,s.gasPrice=(null==t?void 0:t.gasPrice)||(0,_.bnToHex)((0,_.BnMultiplyByFraction)((0,_.hexToBn)(n.gasPrice),r,10))),{previousGasParams:i,newGasParams:s}}async createCancelTransaction(e,t,{estimatedBaseFee:r}={}){const n=this.txStateManager.getTransaction(e),{txParams:i}=n,{from:s,nonce:a}=i,{previousGasParams:o,newGasParams:c}=this.generateNewGasParams(n,B(B({},t),{},{gasLimit:t.gasLimit||S.GAS_LIMITS.SIMPLE})),u=this.txStateManager.generateTxMeta({txParams:B({from:s,to:s,nonce:a,value:"0x0"},c),previousGasParams:o,loadingDefaults:!1,status:w.TRANSACTION_STATUSES.APPROVED,type:w.TRANSACTION_TYPES.CANCEL});return r&&(u.estimatedBaseFee=r),this.addTransaction(u),await this.approveTransaction(u.id),u}async createSpeedUpTransaction(e,t,{estimatedBaseFee:r}={}){const n=this.txStateManager.getTransaction(e),{txParams:i}=n,{previousGasParams:s,newGasParams:a}=this.generateNewGasParams(n,t),o=this.txStateManager.generateTxMeta({txParams:B(B({},i),a),previousGasParams:s,loadingDefaults:!1,status:w.TRANSACTION_STATUSES.APPROVED,type:w.TRANSACTION_TYPES.RETRY});return r&&(o.estimatedBaseFee=r),this.addTransaction(o),await this.approveTransaction(o.id),o}async updateTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user updated transaction")}async updateAndApproveTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user approved transaction"),await this.approveTransaction(e.id)}async approveTransaction(e){if(this.inProcessOfSigning.has(e))return;let t;this.inProcessOfSigning.add(e);try{this.txStateManager.setTxStatusApproved(e);const r=this.txStateManager.getTransaction(e),n=r.txParams.from;let{customNonceValue:i}=r;i=Number(i),t=await this.nonceTracker.getNonceLock(n);const s=r.previousGasParams?r.txParams.nonce:t.nextNonce,a=0===i?i:i||s;r.txParams.nonce=(0,_.addHexPrefix)(a.toString(16)),r.nonceDetails=t.nonceDetails,i&&(r.nonceDetails.customNonceValue=i),this.txStateManager.updateTransaction(r,"transactions#approveTransaction");const o=await this.signTransaction(e);await this.publishTransaction(e,o),this._trackTransactionMetricsEvent(r,w.TRANSACTION_EVENTS.APPROVED),t.releaseLock()}catch(r){try{this._failTransaction(e,r)}catch(e){d.default.error(e)}throw t&&t.releaseLock(),r}finally{this.inProcessOfSigning.delete(e)}}async approveTransactionsWithSameNonce(e=[]){if(0===e.length)return"";const t=e[0],r=await this.getCommonConfiguration(t.from),n=f.TransactionFactory.fromTxData(t,{common:r}),i=(0,o.bufferToHex)(n.serialize());if(this.inProcessOfSigning.has(i))return"";let s,a;this.inProcessOfSigning.add(i);try{const r=t.from;a=await this.nonceTracker.getNonceLock(r);const n=a.nextNonce;s=await Promise.all(e.map((e=>(e.nonce=(0,_.addHexPrefix)(n.toString(16)),this.signExternalTransaction(e)))))}catch(e){throw d.default.error(e),e}finally{a&&a.releaseLock(),this.inProcessOfSigning.delete(i)}return s}async signExternalTransaction(e){const t=O.normalizeTxParams(e),r=this.getChainId(),n=(0,P.isEIP1559Transaction)({txParams:t})?w.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:w.TRANSACTION_ENVELOPE_TYPES.LEGACY,i=B(B({},t),{},{type:n,gasLimit:t.gas,chainId:(0,_.addHexPrefix)((0,v.decimalToHex)(r))}),s=i.from,a=await this.getCommonConfiguration(s),c=f.TransactionFactory.fromTxData(i,{common:a}),u=await this.signEthTx(c,s);return(0,o.bufferToHex)(u.serialize())}async signTransaction(e){const t=this.txStateManager.getTransaction(e),r=this.getChainId(),n=(0,P.isEIP1559Transaction)(t)?w.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:w.TRANSACTION_ENVELOPE_TYPES.LEGACY,i=B(B({},t.txParams),{},{type:n,chainId:r,gasLimit:t.txParams.gas}),s=i.from,a=await this.getCommonConfiguration(i.from),c=f.TransactionFactory.fromTxData(i,{common:a}),u=await this.signEthTx(c,s);t.r=(0,o.bufferToHex)(u.r),t.s=(0,o.bufferToHex)(u.s),t.v=(0,o.bufferToHex)(u.v),this.txStateManager.updateTransaction(t,"transactions#signTransaction: add r, s, v values"),this.txStateManager.setTxStatusSigned(t.id);return(0,o.bufferToHex)(u.serialize())}async publishTransaction(e,t){const r=this.txStateManager.getTransaction(e);if(r.rawTx=t,r.type===w.TRANSACTION_TYPES.SWAP){const e=await this.query.getBalance(r.txParams.from);r.preTxBalance=e.toString(16)}let n;this.txStateManager.updateTransaction(r,"transactions#publishTransaction");try{n=await this.query.sendRawTransaction(t)}catch(e){if(!e.message.toLowerCase().includes("known transaction"))throw e;n=(0,o.keccak)((0,o.toBuffer)((0,_.addHexPrefix)(t),"hex")).toString("hex"),n=(0,_.addHexPrefix)(n)}this.setTxHash(e,n),this.txStateManager.setTxStatusSubmitted(e),this._trackTransactionMetricsEvent(r,w.TRANSACTION_EVENTS.SUBMITTED)}async confirmTransaction(e,t,r,n){const i=this.txStateManager.getTransaction(e);if(i)try{const s=O.normalizeTxReceiptGasUsed(t.gasUsed);i.txReceipt=B(B({},t),{},{gasUsed:s}),r&&(i.baseFeePerGas=r),n&&(i.blockTimestamp=n),this.txStateManager.setTxStatusConfirmed(e),this._markNonceDuplicatesDropped(e);const{submittedTime:a}=i,o={gas_used:s};if(a&&(o.completion_time=this._getTransactionCompletionTime(a)),"0x0"===t.status&&(o.status=F),this._trackTransactionMetricsEvent(i,w.TRANSACTION_EVENTS.FINALIZED,o),this.txStateManager.updateTransaction(i,"transactions#confirmTransaction - add txReceipt"),i.type===w.TRANSACTION_TYPES.SWAP){const t=await this.query.getBalance(i.txParams.from),r=this.txStateManager.getTransaction(e),n=r.approvalTxId?this.txStateManager.getTransaction(r.approvalTxId):null;r.postTxBalance=t.toString(16),this.txStateManager.updateTransaction(r,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(r,n)}}catch(e){d.default.error(e)}}async confirmExternalTransaction(e,t,r){if(await this.txStateManager.addExternalTransaction(e),!e)return;const n=e.id;try{const i=O.normalizeTxReceiptGasUsed(t.gasUsed);e.txReceipt=B(B({},t),{},{gasUsed:i}),r&&(e.baseFeePerGas=r),this.txStateManager.setTxStatusConfirmed(n),this._markNonceDuplicatesDropped(n);const{submittedTime:s}=e,a={gas_used:i};if(s&&(a.completion_time=this._getTransactionCompletionTime(s)),"0x0"===t.status&&(a.status=F),this._trackTransactionMetricsEvent(e,w.TRANSACTION_EVENTS.FINALIZED,a),this.txStateManager.updateTransaction(e,"transactions#confirmTransaction - add txReceipt"),e.type===w.TRANSACTION_TYPES.SWAP){const t=await this.query.getBalance(e.txParams.from),r=this.txStateManager.getTransaction(n),i=r.approvalTxId?this.txStateManager.getTransaction(r.approvalTxId):null;r.postTxBalance=t.toString(16),this.txStateManager.updateTransaction(r,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(r,i)}}catch(e){d.default.error(e)}}async cancelTransaction(e){const t=this.txStateManager.getTransaction(e);this.txStateManager.setTxStatusRejected(e),this._trackTransactionMetricsEvent(t,w.TRANSACTION_EVENTS.REJECTED)}setTxHash(e,t){const r=this.txStateManager.getTransaction(e);r.hash=t,this.txStateManager.updateTransaction(r,"transactions#setTxHash")}async createTransactionEventFragment(e,t){const r=this.txStateManager.getTransaction(e),{properties:n,sensitiveProperties:i}=await this._buildEventFragmentProperties(r);this._createTransactionEventFragment(r,t,n,i)}_mapMethods(){this.getState=()=>this.memStore.getState(),this.getNetwork=()=>this.networkStore.getState(),this.getSelectedAddress=()=>this.preferencesStore.getState().selectedAddress,this.getUnapprovedTxCount=()=>Object.keys(this.txStateManager.getUnapprovedTxList()).length,this.getPendingTxCount=e=>this.txStateManager.getPendingTransactions(e).length,this.getTransactions=e=>this.txStateManager.getTransactions(e),this.getAdvancedGasFee=()=>this.preferencesStore.getState().advancedGasFee}async _updatePendingTxsAfterFirstBlock(){await this.blockTracker.getLatestBlock(),await this.pendingTxTracker.updatePendingTxs()}_onBootCleanUp(){this.txStateManager.getTransactions({searchCriteria:{status:w.TRANSACTION_STATUSES.UNAPPROVED,loadingDefaults:!0}}).forEach((e=>{this.addTxGasDefaults(e).then((e=>{e.loadingDefaults=!1,this.txStateManager.updateTransaction(e,"transactions: gas estimation for tx on boot")})).catch((t=>{const r=this.txStateManager.getTransaction(e.id);r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"failed to estimate gas during boot cleanup."),this._failTransaction(r.id,t)}))})),this.txStateManager.getTransactions({searchCriteria:{status:w.TRANSACTION_STATUSES.APPROVED}}).forEach((e=>{const t=new Error('Transaction found as "approved" during boot - possibly stuck during signing');this._failTransaction(e.id,t)}))}_setupListeners(){this.txStateManager.on("tx:status-update",this.emit.bind(this,"tx:status-update")),this._setupBlockTrackerListener(),this.pendingTxTracker.on("tx:warning",(e=>{this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:warning")})),this.pendingTxTracker.on("tx:failed",((e,t)=>{this._failTransaction(e,t)})),this.pendingTxTracker.on("tx:confirmed",((e,t,r,n)=>this.confirmTransaction(e,t,r,n))),this.pendingTxTracker.on("tx:dropped",(e=>{this._dropTransaction(e)})),this.pendingTxTracker.on("tx:block-update",((e,t)=>{e.firstRetryBlockNumber||(e.firstRetryBlockNumber=t,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:block-update"))})),this.pendingTxTracker.on("tx:retry",(e=>{"retryCount"in e||(e.retryCount=0),e.retryCount+=1,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:retry")}))}_markNonceDuplicatesDropped(e){const t=this.txStateManager.getTransaction(e),{nonce:r,from:n}=t.txParams,i=this.txStateManager.getTransactions({searchCriteria:{nonce:r,from:n}});i.length&&i.forEach((r=>{r.id!==e&&(r.replacedBy=t.hash,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce"),r.status!==w.TRANSACTION_STATUSES.FAILED&&this._dropTransaction(r.id))}))}_setupBlockTrackerListener(){let e=!1;const t=this._onLatestBlock.bind(this),{blockTracker:r,txStateManager:n}=this;function i(){const i=n.getPendingTransactions();!e&&i.length>0?(r.on("latest",t),e=!0):e&&!i.length&&(r.removeListener("latest",t),e=!1)}n.on("tx:status-update",i),i()}async _onLatestBlock(e){try{await this.pendingTxTracker.updatePendingTxs()}catch(e){d.default.error(e)}try{await this.pendingTxTracker.resubmitPendingTxs(e)}catch(e){d.default.error(e)}}_updateMemstore(){const e=this.txStateManager.getUnapprovedTxList(),t=this.txStateManager.getTransactions({limit:100});this.memStore.updateState({unapprovedTxs:e,currentNetworkTxList:t})}_trackSwapsMetrics(e,t){if(this._getParticipateInMetrics()&&e.swapMetaData)if("0x0"===e.txReceipt.status)this._trackMetaMetricsEvent({event:"Swap Failed",sensitiveProperties:B({},e.swapMetaData),category:A.EVENT.CATEGORIES.SWAPS});else{const r=(0,y.getSwapsTokensReceivedFromTxMeta)(e.destinationTokenSymbol,e,e.destinationTokenAddress,e.txParams.from,e.destinationTokenDecimals,t,e.chainId),n=r?`${new p.default(r,10).div(e.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,i=e.txReceipt.gasUsed&&e.swapMetaData.estimated_gas?`${new p.default(e.txReceipt.gasUsed,16).div(e.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null;this._trackMetaMetricsEvent({event:"Swap Completed",category:A.EVENT.CATEGORIES.SWAPS,sensitiveProperties:B(B({},e.swapMetaData),{},{token_to_amount_received:r,quote_vs_executionRatio:n,estimated_vs_used_gasRatio:i})})}}async _buildEventFragmentProperties(e,t){const{type:r,time:n,status:i,chainId:s,origin:a,txParams:{gasPrice:o,gas:c,maxFeePerGas:u,maxPriorityFeePerGas:l,estimateSuggested:f,estimateUsed:h},defaultGasEstimates:d,metamaskNetworkId:p}=e,g=a===I.ORIGIN_METAMASK?"user":"dapp",{assetType:m,tokenStandard:_}=await(0,P.determineTransactionAssetType)(e,this.query,this.getTokenStandardAndDetails),b={};if((0,P.isEIP1559Transaction)(e)?(b.max_fee_per_gas=u,b.max_priority_fee_per_gas=l):b.gas_price=o,d){const{estimateType:t}=d;if(t){b.default_estimate=t;let r=e.defaultGasEstimates.maxFeePerGas,n=e.defaultGasEstimates.maxPriorityFeePerGas;if([S.GAS_RECOMMENDATIONS.LOW,S.GAS_RECOMMENDATIONS.MEDIUM,S.GAS_RECOMMENDATIONS.MEDIUM.HIGH].includes(t)){var y,v;const{gasFeeEstimates:e}=await this._getEIP1559GasFeeEstimates();var w,k;if(null!=e&&null!==(y=e[t])&&void 0!==y&&y.suggestedMaxFeePerGas)r=null===(w=e[t])||void 0===w?void 0:w.suggestedMaxFeePerGas,b.default_max_fee_per_gas=r;if(null!=e&&null!==(v=e[t])&&void 0!==v&&v.suggestedMaxPriorityFeePerGas)n=null===(k=e[t])||void 0===k?void 0:k.suggestedMaxPriorityFeePerGas,b.default_max_priority_fee_per_gas=n}}e.defaultGasEstimates.gas&&(b.default_gas=e.defaultGasEstimates.gas),e.defaultGasEstimates.gasPrice&&(b.default_gas_price=e.defaultGasEstimates.gasPrice)}f&&(b.estimate_suggested=f),h&&(b.estimate_used=h);const T=this._getGasValuesInGWEI(b);let A="0";if(e.txParams.maxFeePerGas){const{eip1559V2Enabled:e}=this.preferencesStore.getState();A=e?"2":"1"}return{properties:{chain_id:s,referrer:a,source:g,network:p,type:r,eip_1559_version:A,gas_edit_type:"none",gas_edit_attempted:"none",account_type:await this.getAccountType(this.getSelectedAddress()),device_model:await this.getDeviceModel(this.getSelectedAddress()),asset_type:m,token_standard:_},sensitiveProperties:B(B({status:i,transaction_envelope_type:(0,P.isEIP1559Transaction)(e)?E.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:E.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:n,gas_limit:c},T),t)}}_createTransactionEventFragment(e,t,r,n){const i=`transaction-${[w.TRANSACTION_EVENTS.FINALIZED,w.TRANSACTION_EVENTS.SUBMITTED].includes(t)?"submitted":"added"}-${e.id}`;if(void 0===this.getEventFragmentById(i))switch(t){case w.TRANSACTION_EVENTS.ADDED:this.createEventFragment({category:A.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:w.TRANSACTION_EVENTS.ADDED,successEvent:w.TRANSACTION_EVENTS.APPROVED,failureEvent:w.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i});break;case w.TRANSACTION_EVENTS.APPROVED:case w.TRANSACTION_EVENTS.REJECTED:this.createEventFragment({category:A.EVENT.CATEGORIES.TRANSACTIONS,successEvent:w.TRANSACTION_EVENTS.APPROVED,failureEvent:w.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i});break;case w.TRANSACTION_EVENTS.SUBMITTED:this.createEventFragment({category:A.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:w.TRANSACTION_EVENTS.SUBMITTED,successEvent:w.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i});break;case w.TRANSACTION_EVENTS.FINALIZED:this.createEventFragment({category:A.EVENT.CATEGORIES.TRANSACTIONS,successEvent:w.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:i})}}async _trackTransactionMetricsEvent(e,t,r={}){if(!e)return;const{properties:n,sensitiveProperties:i}=await this._buildEventFragmentProperties(e,r);let s;switch(this._createTransactionEventFragment(e,t,n,i),t){case w.TRANSACTION_EVENTS.APPROVED:s=`transaction-added-${e.id}`,this.updateEventFragment(s,{properties:n,sensitiveProperties:i}),this.finalizeEventFragment(s);break;case w.TRANSACTION_EVENTS.REJECTED:s=`transaction-added-${e.id}`,this.updateEventFragment(s,{properties:n,sensitiveProperties:i}),this.finalizeEventFragment(s,{abandoned:!0});break;case w.TRANSACTION_EVENTS.FINALIZED:s=`transaction-submitted-${e.id}`,this.updateEventFragment(s,{properties:n,sensitiveProperties:i}),this.finalizeEventFragment(`transaction-submitted-${e.id}`)}}_getTransactionCompletionTime(e){return Math.round((Date.now()-e)/1e3).toString()}_getGasValuesInGWEI(e){const t={};for(const r in e)(0,o.isHexString)(e[r])?t[r]=(0,v.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}_failTransaction(e,t){this.txStateManager.setTxStatusFailed(e,t);const r=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(r,w.TRANSACTION_EVENTS.FINALIZED,{error:t.message})}_dropTransaction(e){this.txStateManager.setTxStatusDropped(e);const t=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(t,w.TRANSACTION_EVENTS.FINALIZED)}}r.default=G}}},{package:"$root$"}],[33,{"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"fast-json-patch":4211,lodash:5091},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.generateHistoryEntry=c,r.migrateFromSnapshotsToDiffs=function(e){return e.map(((t,r)=>0===r?t:c(e[r-1],t)))},r.replayHistory=function(e){return(0,a.cloneDeep)(e).reduce(((e,t)=>s.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);return delete t.history,(0,a.cloneDeep)(t)};var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("fast-json-patch")),a=e("lodash");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){const n=s.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}}}},{package:"$root$"}],[34,{"../../../../../shared/constants/transaction":6114,"../../../../../shared/modules/hexstring-utils":6120,"../../../../../shared/modules/transaction.utils":6126,"../../../lib/util":83,"eth-rpc-errors":2371},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFinalStates=function(){return[s.TRANSACTION_STATUSES.REJECTED,s.TRANSACTION_STATUSES.CONFIRMED,s.TRANSACTION_STATUSES.FAILED,s.TRANSACTION_STATUSES.DROPPED]},r.normalizeAndValidateTxParams=function(e,t=!0){const r=u(e,t);return d(r),r},r.normalizeTxParams=u,r.normalizeTxReceiptGasUsed=function(e){return"string"==typeof e?e:e.toString(16)},r.validateConfirmedExternalTransaction=void 0,r.validateFrom=p,r.validateRecipient=g,r.validateTxParams=d;var n=e("eth-rpc-errors"),i=e("../../../lib/util"),s=e("../../../../../shared/constants/transaction"),a=e("../../../../../shared/modules/transaction.utils"),o=e("../../../../../shared/modules/hexstring-utils");const c={from:i.addHexPrefix,to:(e,t)=>t?(0,i.addHexPrefix)(e).toLowerCase():(0,i.addHexPrefix)(e),nonce:i.addHexPrefix,value:i.addHexPrefix,data:i.addHexPrefix,gas:i.addHexPrefix,gasPrice:i.addHexPrefix,maxFeePerGas:i.addHexPrefix,maxPriorityFeePerGas:i.addHexPrefix,type:i.addHexPrefix,estimateSuggested:e=>e,estimateUsed:e=>e};function u(e,t=!0){const r={};for(const n in c)e[n]&&(r[n]=c[n](e[n],t));return r}function l(e,t,r){if(void 0!==e[r])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: specified ${t} but also included ${r}, these cannot be mixed`)}function f(e,t){if("string"!=typeof e[t])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}function h(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&e.type!==s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET}"`);break;default:if(e.type&&e.type===s.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function d(e,t=!0){if(!e||"object"!=typeof e||Array.isArray(e))throw n.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!e.to&&!e.data)throw n.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');if((0,a.isEIP1559Transaction)({txParams:e})&&!t)throw n.ethErrors.rpc.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559");Object.entries(e).forEach((([t,r])=>{switch(t){case"from":p(e);break;case"to":g(e);break;case"gasPrice":h(e,"gasPrice"),l(e,"gasPrice","maxFeePerGas"),l(e,"gasPrice","maxPriorityFeePerGas"),f(e,"gasPrice");break;case"maxFeePerGas":h(e,"maxFeePerGas"),l(e,"maxFeePerGas","gasPrice"),f(e,"maxFeePerGas");break;case"maxPriorityFeePerGas":h(e,"maxPriorityFeePerGas"),l(e,"maxPriorityFeePerGas","gasPrice"),f(e,"maxPriorityFeePerGas");break;case"value":if(f(e,"value"),r.toString().includes("-"))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value "${r}": not a positive number.`);if(r.toString().includes("."))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": number must be in wei.`);if(!r.match(/^0x[a-fA-F0-9]+$/u))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": not a valid hex string.`);break;case"chainId":if("number"!=typeof r&&"string"!=typeof r)throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a Number or hex string. got: (${r})`);break;default:f(e,t)}}))}function p(e){if("string"!=typeof e.from)throw n.ethErrors.rpc.invalidParams(`Invalid "from" address "${e.from}": not a string.`);if(!(0,o.isValidHexAddress)(e.from,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "from" address.')}function g(e){if("0x"===e.to||null===e.to){if(!e.data)throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,o.isValidHexAddress)(e.to,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');return e}r.validateConfirmedExternalTransaction=({txMeta:e,pendingTransactions:t,confirmedTransactions:r}={})=>{if(!e||!e.txParams)throw n.ethErrors.rpc.invalidParams('"txMeta" or "txMeta.txParams" is missing');if(e.status!==s.TRANSACTION_STATUSES.CONFIRMED)throw n.ethErrors.rpc.invalidParams('External transaction status should be "confirmed"');const i=e.txParams.nonce;if(t&&t.length>0){if(t.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in pending txs")}if(r&&r.length>0){if(r.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"$root$"}],[35,{"../../../../shared/constants/transaction":6114,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"ethjs-query":2486,loglevel:5104,"safe-event-emitter":5661},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),a=n(e("loglevel")),o=n(e("ethjs-query")),c=e("../../../../shared/constants/transaction");class u extends s.default{constructor(e){super(),(0,i.default)(this,"DROPPED_BUFFER_COUNT",3),(0,i.default)(this,"droppedBlocksBufferByHash",new Map),this.query=e.query||new o.default(e.provider),this.nonceTracker=e.nonceTracker,this.getPendingTransactions=e.getPendingTransactions,this.getCompletedTransactions=e.getCompletedTransactions,this.publishTransaction=e.publishTransaction,this.approveTransaction=e.approveTransaction,this.confirmTransaction=e.confirmTransaction}async updatePendingTxs(){const e=await this.nonceTracker.getGlobalLock();try{const e=this.getPendingTransactions();await Promise.all(e.map((e=>this._checkPendingTx(e))))}catch(e){a.default.error("PendingTransactionTracker - Error updating pending transactions"),a.default.error(e)}e.releaseLock()}async resubmitPendingTxs(e){const t=this.getPendingTransactions();if(t.length)for(const i of t)try{await this._resubmitTx(i,e)}catch(e){var r,n;const t=(null===(r=e.value)||void 0===r||null===(n=r.message)||void 0===n?void 0:n.toLowerCase())||e.message.toLowerCase();if(t.includes("replacement transaction underpriced")||t.includes("known transaction")||t.includes("gas price too low to replace")||t.includes("transaction with the same hash was already imported")||t.includes("gateway timeout")||t.includes("nonce too low"))return;i.warning={error:t,message:"There was an error when resubmitting this transaction."},this.emit("tx:warning",i,e)}}async _resubmitTx(e,t){e.firstRetryBlockNumber||this.emit("tx:block-update",e,t);const r=e.firstRetryBlockNumber||t,n=Number.parseInt(t,16)-Number.parseInt(r,16),i=e.retryCount||0;if(n<Math.min(50,Math.pow(2,i)))return undefined;if(!("rawTx"in e))return this.approveTransaction(e.id);const{rawTx:s}=e,a=await this.publishTransaction(s);return this.emit("tx:retry",e),a}async _checkPendingTx(e){const t=e.hash,r=e.id;if(e.status===c.TRANSACTION_STATUSES.SUBMITTED){if(!t){const e=new Error("We had an error while submitting this transaction, please try again.");return e.name="NoTxHashError",void this.emit("tx:failed",r,e)}if(await this._checkIfNonceIsTaken(e))this.emit("tx:dropped",r);else{try{const e=await this.query.getTransactionReceipt(t);if(null!=e&&e.blockNumber){const{baseFeePerGas:t,timestamp:n}=await this.query.getBlockByHash(null==e?void 0:e.blockHash,!1);return void this.emit("tx:confirmed",r,e,t,n)}}catch(t){return e.warning={error:t.message,message:"There was a problem loading this transaction."},void this.emit("tx:warning",e,t)}await this._checkIfTxWasDropped(e)&&this.emit("tx:dropped",r)}}}async _checkIfTxWasDropped(e){const{hash:t,txParams:{nonce:r,from:n}}=e,i=await this.query.getTransactionCount(n);if(parseInt(r,16)>=i.toNumber())return!1;this.droppedBlocksBufferByHash.has(t)||this.droppedBlocksBufferByHash.set(t,0);const s=this.droppedBlocksBufferByHash.get(t);return s<this.DROPPED_BUFFER_COUNT?(this.droppedBlocksBufferByHash.set(t,s+1),!1):(this.droppedBlocksBufferByHash.delete(t),!0)}async _checkIfNonceIsTaken(e){const t=e.txParams.from;return this.getCompletedTransactions(t).some((t=>!(t.id===e.id)&&t.txParams.nonce===e.txParams.nonce))}}r.default=u}}},{package:"$root$"}],[36,{"../../lib/util":83,"@babel/runtime/helpers/interopRequireDefault":199,"ethereumjs-util":2437,"ethjs-query":2486,lodash:5091,loglevel:5104},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("ethjs-query")),s=n(e("loglevel")),a=e("ethereumjs-util"),o=e("lodash"),c=e("../../lib/util");r.default=class{constructor(e){this.query=new i.default(e)}async analyzeGasUsage(e){const t=await this.query.getBlockByNumber("latest",!1),r=(0,c.hexToBn)(t.gasLimit),n=(0,c.BnMultiplyByFraction)(r,19,20);let i,a=(0,c.bnToHex)(n);try{a=await this.estimateTxGas(e)}catch(e){s.default.warn(e),i={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:t.number,blockGasLimit:t.gasLimit}}}return{blockGasLimit:t.gasLimit,estimatedGasHex:a,simulationFails:i}}async estimateTxGas(e){const t=(0,o.cloneDeep)(e.txParams);return delete t.gasPrice,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,await this.query.estimateGas(t)}addGasBuffer(e,t,r=1.5){const n=(0,c.hexToBn)(e),i=(0,c.hexToBn)(t).muln(.9),s=n.muln(r);return n.gt(i)?(0,c.bnToHex)(n):s.lt(i)?(0,c.bnToHex)(s):(0,c.bnToHex)(i)}async getBufferedGasLimit(e,t){const{blockGasLimit:r,estimatedGasHex:n,simulationFails:i}=await this.analyzeGasUsage(e);return{gasLimit:this.addGasBuffer((0,a.addHexPrefix)(n),r,t),simulationFails:i}}}}}},{package:"$root$"}],[37,{"../../../../shared/constants/app":6105,"../../../../shared/constants/transaction":6114,"../../../../shared/modules/random-id":6122,"../../../../shared/modules/transaction.utils":6126,"../../metamask-controller":84,"./lib/tx-state-history-helpers":33,"./lib/util":34,"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/obs-store":1197,lodash:5091,loglevel:5104,"safe-event-emitter":5661},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("safe-event-emitter")),a=e("@metamask/obs-store"),o=n(e("loglevel")),c=e("lodash"),u=n(e("../../../../shared/modules/random-id")),l=e("../../../../shared/constants/transaction"),f=e("../../metamask-controller"),h=e("../../../../shared/modules/transaction.utils"),d=e("../../../../shared/constants/app"),p=e("./lib/tx-state-history-helpers"),g=e("./lib/util");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class b extends s.default{constructor({initState:e,txHistoryLimit:t,getNetwork:r,getCurrentChainId:n}){super(),this.store=new a.ObservableStore(_({transactions:{}},e)),this.txHistoryLimit=t,this.getNetwork=r,this.getCurrentChainId=n}generateTxMeta(e={}){var t;const r=this.getNetwork(),n=this.getCurrentChainId();if("loading"===r)throw new Error("MetaMask is having trouble connecting to the network");let i=null;return e.txParams&&"string"==typeof e.origin&&e.origin!==d.ORIGIN_METAMASK&&(void 0!==e.txParams.gasPrice?i={gasPrice:e.txParams.gasPrice}:void 0===e.txParams.maxFeePerGas&&void 0===e.txParams.maxPriorityFeePerGas||(i={maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas,maxFeePerGas:e.txParams.maxFeePerGas}),void 0!==e.txParams.gas&&(i=_(_({},i),{},{gas:e.txParams.gas}))),_({id:(0,u.default)(),time:(new Date).getTime(),status:l.TRANSACTION_STATUSES.UNAPPROVED,metamaskNetworkId:r,originalGasEstimate:null===(t=e.txParams)||void 0===t?void 0:t.gas,userEditedGasLimit:!1,chainId:n,loadingDefaults:!0,dappSuggestedGasFees:i,sendFlowHistory:[]},e)}getUnapprovedTxList(){const e=this.getCurrentChainId(),t=this.getNetwork();return(0,c.pickBy)(this.store.getState().transactions,(r=>r.status===l.TRANSACTION_STATUSES.UNAPPROVED&&(0,h.transactionMatchesNetwork)(r,e,t)))}getApprovedTransactions(e){const t={status:l.TRANSACTION_STATUSES.APPROVED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getPendingTransactions(e){const t={status:l.TRANSACTION_STATUSES.SUBMITTED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getConfirmedTransactions(e){const t={status:l.TRANSACTION_STATUSES.CONFIRMED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}addTransaction(e){e.txParams&&(e.txParams=(0,g.normalizeAndValidateTxParams)(e.txParams,!1)),this.once(`${e.id}:signed`,(()=>{this.removeAllListeners(`${e.id}:rejected`)})),this.once(`${e.id}:rejected`,(()=>{this.removeAllListeners(`${e.id}:signed`)})),e.history=[];const t=(0,p.snapshotFromTxMeta)(e);e.history.push(t);const r=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:n}=this,i=new Set,s=r.reverse().filter((e=>{const{nonce:t,from:r}=e.txParams,{chainId:s,metamaskNetworkId:a,status:o}=e,c=`${t}-${null!=s?s:a}-${r}`;return!i.has(c)&&(!(i.size<n-1||!1===(0,g.getFinalStates)().includes(o))||(i.add(c),!1))})).map((e=>e.id));return this._deleteTransactions(s),this._addTransactionsToState([e]),e}addExternalTransaction(e){var t;const r=null==e||null===(t=e.txParams)||void 0===t?void 0:t.from,n=this.getConfirmedTransactions(r),i=this.getPendingTransactions(r);return(0,g.validateConfirmedExternalTransaction)({txMeta:e,pendingTransactions:i,confirmedTransactions:n}),this._addTransactionsToState([e]),e}getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}updateTransaction(e,t){e.txParams&&(e.txParams=(0,g.normalizeAndValidateTxParams)(e.txParams,!1));const r=(0,p.snapshotFromTxMeta)(e),n=(0,p.replayHistory)(e.history),i=(0,p.generateHistoryEntry)(n,r,t);i.length&&e.history.push(i);const s=e.id;this.store.updateState({transactions:_(_({},this.store.getState().transactions),{},{[s]:e})})}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:r=!0,limit:n}={}){const i=this.getCurrentChainId(),s=this.getNetwork(),a=(0,c.mapValues)(e,(e=>"function"==typeof e?e:t=>t===e)),o=t?(0,c.keyBy)(t,"id"):this.store.getState().transactions,u=(0,c.sortBy)((0,c.pickBy)(o,(e=>{if(r&&!1===(0,h.transactionMatchesNetwork)(e,i,s))return!1;for(const[t,r]of Object.entries(a))if(t in e.txParams){if(!1===r(e.txParams[t]))return!1}else if(!1===r(e[t]))return!1;return!0})),"time");if(n!==undefined){const e=new Set,t=[];for(let r=u.length-1;r>-1;r--){const i=u[r],{nonce:s}=i.txParams;if(!e.has(s)){if(!(e.size<n))continue;e.add(s)}t.unshift(i)}return t}return u}setTxStatusRejected(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.REJECTED),this._deleteTransaction(e)}setTxStatusUnapproved(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.UNAPPROVED)}setTxStatusApproved(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.APPROVED)}setTxStatusSigned(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.SIGNED)}setTxStatusSubmitted(e){const t=this.getTransaction(e);t.submittedTime=(new Date).getTime(),this.updateTransaction(t,"txStateManager - add submitted time stamp"),this._setTransactionStatus(e,l.TRANSACTION_STATUSES.SUBMITTED)}setTxStatusConfirmed(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.CONFIRMED)}setTxStatusDropped(e){this._setTransactionStatus(e,l.TRANSACTION_STATUSES.DROPPED)}setTxStatusFailed(e,t){var r;const n=t||new Error("Internal metamask failure"),i=this.getTransaction(e);i.err={message:(null===(r=n.message)||void 0===r?void 0:r.toString())||n.toString(),rpc:n.value,stack:n.stack},this.updateTransaction(i,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(e,l.TRANSACTION_STATUSES.FAILED)}wipeTransactions(e){const{transactions:t}=this.store.getState(),r=this.getNetwork(),n=this.getCurrentChainId();this.store.updateState({transactions:(0,c.omitBy)(t,(t=>t.txParams.from===e&&(0,h.transactionMatchesNetwork)(t,n,r)))})}clearUnapprovedTxs(){this.store.updateState({transactions:(0,c.omitBy)(this.store.getState().transactions,(e=>e.status===l.TRANSACTION_STATUSES.UNAPPROVED))})}_setTransactionStatus(e,t){const r=this.getTransaction(e);if(r){r.status=t;try{this.updateTransaction(r,`txStateManager: setting status to ${t}`),this.emit(`${r.id}:${t}`,e),this.emit("tx:status-update",e,t),[l.TRANSACTION_STATUSES.SUBMITTED,l.TRANSACTION_STATUSES.REJECTED,l.TRANSACTION_STATUSES.FAILED].includes(t)&&this.emit(`${r.id}:finished`,r),this.emit(f.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}catch(e){o.default.error(e)}}}_addTransactionsToState(e){this.store.updateState({transactions:e.reduce(((e,t)=>(e[t.id]=t,e)),this.store.getState().transactions)})}_deleteTransaction(e){const{transactions:t}=this.store.getState();delete t[e],this.store.updateState({transactions:t})}_deleteTransactions(e){const{transactions:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({transactions:t})}}r.default=b}}},{package:"$root$"}],[38,{"../../shared/constants/app":6105,"./lib/util":83,"@babel/runtime/helpers/interopRequireDefault":199,"webextension-polyfill":6080},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.onMessageReceived=r.checkForMultipleVersionsRunning=void 0;var i=n(e("webextension-polyfill")),s=e("../../shared/constants/app"),a=e("./lib/util");const o="isRunning";r.onMessageReceived=e=>{e===o&&console.warn("Warning! You have multiple instances of MetaMask running!")};r.checkForMultipleVersionsRunning=async()=>{if((0,a.getPlatform)()!==s.PLATFORM_CHROME&&(0,a.getPlatform)()!==s.PLATFORM_FIREFOX)return;const e=(0,a.getPlatform)()===s.PLATFORM_CHROME?s.CHROME_BUILD_IDS:s.FIREFOX_BUILD_IDS,t=i.default.runtime.id;for(const r of e)if(r!==t)try{await i.default.runtime.sendMessage(r,o)}catch(e){}}}}},{package:"$root$"}],[39,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={config:{},PreferencesController:{frequentRpcListDetail:[{rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}]}};r.default=n}}},{package:"$root$"}],[4,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN=r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY=r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39";r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY="0x9f510b19f1ad66f0dcf6e45559fab0d6752c1db7";r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN="0xb8e671734ce5c8d7dfbbea5574fa4cf39f7a54a4";r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN="0xb1d3fbb2f83aecd196f474c16ca5d9cffa0d0ffc"}}},{package:"$root$"}],[40,{"@babel/runtime/helpers/defineProperty":193,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/controllers":1047,"@metamask/obs-store":1197},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),a=e("@metamask/controllers");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class u extends s.ObservableStore{constructor({config:e,controllerMessenger:t,state:r,persist:n}){super(r),(0,i.default)(this,"config",{}),this.persist=n,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();for(const t of Object.keys(e)){if(!e[t])throw new Error(`Undefined '${t}'`);const r=e[t];r.subscribe?e[t].subscribe((e=>{this.updateState({[t]:e})})):this.controllerMessenger.subscribe(`${r.name}:stateChange`,(r=>{let n=r;this.persist&&(n=(0,a.getPersistentState)(r,e[t].metadata)),this.updateState({[t]:n})}))}}getFlatState(){if(!this.config)return{};let e={};for(const t of Object.keys(this.config)){const r=this.config[t],n=r.getState?r.getState():r.state;e=c(c({},e),n)}return e}}r.default=u}}},{package:"$root$"}],[41,{"../../../shared/constants/network":6110,"../constants/contracts":4,"./util":83,"@babel/runtime/helpers/interopRequireDefault":199,"@metamask/obs-store":1197,"eth-query":2367,loglevel:5104,pify:5336,"single-call-balance-checker-abi":5757,web3:6028},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("eth-query")),s=e("@metamask/obs-store"),a=n(e("loglevel")),o=n(e("pify")),c=n(e("web3")),u=n(e("single-call-balance-checker-abi")),l=e("../../../shared/constants/network"),f=e("../constants/contracts"),h=e("./util");r.default=class{constructor(e={}){this.store=new s.ObservableStore({accounts:{},currentBlockGasLimit:""}),this._provider=e.provider,this._query=(0,o.default)(new i.default(this._provider)),this._blockTracker=e.blockTracker,this._currentBlockNumber=this._blockTracker.getCurrentBlock(),this._blockTracker.once("latest",(e=>{this._currentBlockNumber=e})),this._updateForBlock=this._updateForBlock.bind(this),this.getCurrentChainId=e.getCurrentChainId,this.web3=new c.default(this._provider)}start(){this._blockTracker.removeListener("latest",this._updateForBlock),this._blockTracker.addListener("latest",this._updateForBlock),this._updateAccounts()}stop(){this._blockTracker.removeListener("latest",this._updateForBlock)}syncWithAddresses(e){const{accounts:t}=this.store.getState(),r=Object.keys(t),n=[];e.forEach((e=>{r.includes(e)||n.push(e)}));const i=[];r.forEach((t=>{e.includes(t)||i.push(t)})),this.addAccounts(n),this.removeAccount(i)}addAccounts(e){const{accounts:t}=this.store.getState();e.forEach((e=>{t[e]={}})),this.store.updateState({accounts:t}),this._currentBlockNumber&&this._updateAccounts()}removeAccount(e){const{accounts:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({accounts:t})}clearAccounts(){this.store.updateState({accounts:{}})}async _updateForBlock(e){this._currentBlockNumber=e;const t=await this._query.getBlockByNumber(e,!1);if(!t)return;const r=t.gasLimit;this.store.updateState({currentBlockGasLimit:r});try{await this._updateAccounts()}catch(e){a.default.error(e)}}async _updateAccounts(){const{accounts:e}=this.store.getState(),t=Object.keys(e);switch(this.getCurrentChainId()){case l.MAINNET_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,f.SINGLE_CALL_BALANCES_ADDRESS);break;case l.RINKEBY_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,f.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY);break;case l.ROPSTEN_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,f.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN);break;case l.KOVAN_CHAIN_ID:await this._updateAccountsViaBalanceChecker(t,f.SINGLE_CALL_BALANCES_ADDRESS_KOVAN);break;default:await Promise.all(t.map(this._updateAccount.bind(this)))}}async _updateAccount(e){const t={address:e,balance:await this._query.getBalance(e)},{accounts:r}=this.store.getState();r[e]&&(r[e]=t,this.store.updateState({accounts:r}))}async _updateAccountsViaBalanceChecker(e,t){const{accounts:r}=this.store.getState();this.web3.setProvider(this._provider);this.web3.eth.contract(u.default).at(t).balances(e,["0x0"],((t,n)=>{if(t)return a.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),void Promise.all(e.map(this._updateAccount.bind(this)));e.forEach(((e,t)=>{const i=n[t]?(0,h.bnToHex)(n[t]):"0x0";r[e]={address:e,balance:i}})),this.store.updateState({accounts:r})}))}}}}},{package:"$root$"}],[4210,{"./helpers":4212,"fast-deep-equal":4213},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("fast-deep-equal"),i=e("./helpers");r.JsonPatchError=i.PatchError,r.deepClone=i._deepClone;var s={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=o(r,this.path);n&&(n=i._deepClone(n));var s=c(r,{op:"remove",path:this.from}).removed;return c(r,{op:"add",path:this.path,value:s}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=o(r,this.from);return c(r,{op:"add",path:this.path,value:i._deepClone(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:n(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},a={add:function(e,t,r){return i.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:s.move,copy:s.copy,test:s.test,_get:s._get};function o(e,t){if(""==t)return e;var r={op:"_get",path:t};return c(e,r),r.value}function c(e,t,c,u,l,h){if(void 0===c&&(c=!1),void 0===u&&(u=!0),void 0===l&&(l=!0),void 0===h&&(h=0),c&&("function"==typeof c?c(t,0,e,t.path):f(t,0)),""===t.path){var d={newDocument:e};if("add"===t.op)return d.newDocument=t.value,d;if("replace"===t.op)return d.newDocument=t.value,d.removed=e,d;if("move"===t.op||"copy"===t.op)return d.newDocument=o(e,t.from),"move"===t.op&&(d.removed=e),d;if("test"===t.op){if(d.test=n(e,t.value),!1===d.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return d.newDocument=e,d}if("remove"===t.op)return d.removed=e,d.newDocument=null,d;if("_get"===t.op)return t.value=e,d;if(c)throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",h,t,e);return d}u||(e=i._deepClone(e));var p=(t.path||"").split("/"),g=e,m=1,_=p.length,b=undefined,y=void 0,v=void 0;for(v="function"==typeof c?c:f;;){if(y=p[m],l&&"__proto__"==y)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(c&&b===undefined&&(g[y]===undefined?b=p.slice(0,m).join("/"):m==_-1&&(b=t.path),b!==undefined&&v(t,0,e,b)),m++,Array.isArray(g)){if("-"===y)y=g.length;else{if(c&&!i.isInteger(y))throw new r.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",h,t,e);i.isInteger(y)&&(y=~~y)}if(m>=_){if(c&&"add"===t.op&&y>g.length)throw new r.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",h,t,e);if(!1===(d=a[t.op].call(t,g,y,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return d}}else if(y&&-1!=y.indexOf("~")&&(y=i.unescapePathComponent(y)),m>=_){if(!1===(d=s[t.op].call(t,g,y,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return d}g=g[y]}}function u(e,t,n,s,a){if(void 0===s&&(s=!0),void 0===a&&(a=!0),n&&!Array.isArray(t))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");s||(e=i._deepClone(e));for(var o=new Array(t.length),u=0,l=t.length;u<l;u++)o[u]=c(e,t[u],n,!0,a,u),e=o[u].newDocument;return o.newDocument=e,o}function l(e,t,n){var i=c(e,t);if(!1===i.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function f(e,t,n,a){if("object"!=typeof e||null===e||Array.isArray(e))throw new r.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!s[e.op])throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new r.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new r.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new r.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&e.value===undefined)throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&i.hasUndefined(e.value))throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var o=e.path.split("/").length,c=a.split("/").length;if(o!==c+1&&o!==c)throw new r.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==a)throw new r.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var u=h([{op:"_get",path:e.from,value:undefined}],n);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new r.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function h(e,t,n){try{if(!Array.isArray(e))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)u(i._deepClone(t),i._deepClone(e),n||!0);else{n=n||f;for(var s=0;s<e.length;s++)n(e[s],s,t,undefined)}}catch(e){if(e instanceof r.JsonPatchError)return e;throw e}}r.getValueByPointer=o,r.applyOperation=c,r.applyPatch=u,r.applyReducer=l,r.validator=f,r.validate=h,r.default={JsonPatchError:r.JsonPatchError,deepClone:r.deepClone,getValueByPointer:o,applyOperation:c,applyPatch:u,applyReducer:l,validator:f,validate:h}}}},{package:"fast-json-patch"}],[4211,{"./core":4210,"./helpers":4212},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var i=e("./helpers"),s=e("./core"),a=e("./core");r.applyOperation=a.applyOperation,r.applyPatch=a.applyPatch,r.applyReducer=a.applyReducer,r.getValueByPointer=a.getValueByPointer,r.validate=a.validate,r.validator=a.validator;var o=e("./helpers");r.JsonPatchError=o.PatchError,r.deepClone=o._deepClone,r.escapePathComponent=o.escapePathComponent,r.unescapePathComponent=o.unescapePathComponent;var c=new WeakMap,u=function(e){this.observers=new Map,this.obj=e},l=function(e,t){this.callback=e,this.observer=t};function f(e,t){t.unobserve()}function h(e,t){var r,n=function(e){return c.get(e)}(e);if(n){var s=function(e,t){return e.observers.get(t)}(n,t);r=s&&s.observer}else n=new u(e),c.set(e,n);if(r)return r;if(r={},n.value=i._deepClone(e),t){r.callback=t,r.next=null;var a=function(){d(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(a)};"undefined"!=typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=[],r.object=e,r.unobserve=function(){d(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},n.observers.set(t,new l(t,r)),r}function d(e,t){void 0===t&&(t=!1);var r=c.get(e.object);p(r.value,e.object,e.patches,"",t),e.patches.length&&s.applyPatch(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function p(e,t,r,n,s){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var a=i._objectKeys(t),o=i._objectKeys(e),c=!1,u=o.length-1;u>=0;u--){var l=e[h=o[u]];if(!i.hasOwnProperty(t,h)||t[h]===undefined&&l!==undefined&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(s&&r.push({op:"test",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(l)}),r.push({op:"remove",path:n+"/"+i.escapePathComponent(h)}),c=!0):(s&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}),!0);else{var f=t[h];"object"==typeof l&&null!=l&&"object"==typeof f&&null!=f?p(l,f,r,n+"/"+i.escapePathComponent(h),s):l!==f&&(!0,s&&r.push({op:"test",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(l)}),r.push({op:"replace",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(f)}))}}if(c||a.length!=o.length)for(u=0;u<a.length;u++){var h=a[u];i.hasOwnProperty(e,h)||t[h]===undefined||r.push({op:"add",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(t[h])})}}}function g(e,t,r){void 0===r&&(r=!1);var n=[];return p(e,t,n,"",r),n}r.unobserve=f,r.observe=h,r.generate=d,r.compare=g;var m=e("./core"),_=e("./helpers");r.default=n({},m,{unobserve:f,observe:h,generate:d,compare:g,JsonPatchError:_.PatchError,deepClone:i._deepClone,escapePathComponent:i.escapePathComponent,unescapePathComponent:_.unescapePathComponent})}}},{package:"fast-json-patch"}],[4212,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=Object.prototype.hasOwnProperty;function a(e,t){return s.call(e,t)}function o(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);t=[];for(var n in e)a(e,n)&&t.push(n);return t}function c(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function u(e,t){var r;for(var n in e)if(a(e,n)){if(e[n]===t)return c(n)+"/";if("object"==typeof e[n]&&""!=(r=u(e[n],t)))return c(n)+"/"+r}return""}function l(e,t){var r=[e];for(var n in t){var i="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==i&&r.push(n+": "+i)}return r.join("\n")}Object.defineProperty(r,"hasOwnProperty",{value:a}),r._objectKeys=o,r._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.isInteger=function(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0},r.escapePathComponent=c,r.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},r._getPathRecursive=u,r.getPath=function(e,t){if(e===t)return"/";var r=u(e,t);if(""===r)throw new Error("Object not found in root");return"/"+r},r.hasUndefined=function e(t){if(t===undefined)return!0;if(t)if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){var i=o(t),s=i.length;for(r=0;r<s;r++)if(e(t[i[r]]))return!0}return!1};var f=function(e){function t(t,r,n,i,s){var a=this.constructor,o=e.call(this,l(t,{name:r,index:n,operation:i,tree:s}))||this;return o.name=r,o.index=n,o.operation=i,o.tree=s,Object.setPrototypeOf(o,a.prototype),o.message=l(t,{name:r,index:n,operation:i,tree:s}),o}return i(t,e),t}(Error);r.PatchError=f}}},{package:"fast-json-patch"}],[4213,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Array.isArray,i=Object.keys,s=Object.prototype.hasOwnProperty;t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var a,o,c,u=n(t),l=n(r);if(u&&l){if((o=t.length)!=r.length)return!1;for(a=o;0!=a--;)if(!e(t[a],r[a]))return!1;return!0}if(u!=l)return!1;var f=t instanceof Date,h=r instanceof Date;if(f!=h)return!1;if(f&&h)return t.getTime()==r.getTime();var d=t instanceof RegExp,p=r instanceof RegExp;if(d!=p)return!1;if(d&&p)return t.toString()==r.toString();var g=i(t);if((o=g.length)!==i(r).length)return!1;for(a=o;0!=a--;)if(!s.call(r,g[a]))return!1;for(a=o;0!=a--;)if(!e(t[c=g[a]],r[c]))return!1;return!0}return t!=t&&r!=r}}}},{package:"fast-json-patch>fast-deep-equal"}],[4216,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){for(var t=n.BASE,r=0,i=e.length;r<i;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}n.BASE=2166136261,t.exports=n}}},{package:"3box>ipfs>fnv1a"}],[4218,{constants:2066},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("constants")}}},{package:"@metamask/snap-controllers>tar-stream>fs-constants"}],[4219,{assert:1615,events:1997,fsm:4220},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events").EventEmitter,i=e("assert"),s=e("fsm");t.exports=function(e,t){"object"==typeof e&&(t=e,e="START");i.equal(typeof e,"string"),i.equal(typeof t,"object"),i.ok(t[e],"invalid starting state "+e),i.ok(s.validate(t));const r=new n;return a._graph=s.reachable(t),a._emitter=r,a._events=t,a._state=e,a.emit=a,a.on=function(e,t){r.on(e,t)},a;function a(e){const t=a._events[a._state][e];if(!function(e,t,r){if(!t)return!1;if(!e)return!0;const n=r[e];return!(!n||!n[t])&&1===n[t].length}(a._state,t,a._graph)){const t="invalid transition: "+a._state+" -> "+e;return r.emit("error",t)}const n=a._state+":leave",i=t+":enter";return a._state?void(r._events[n]?r.emit(n,s):s()):s();function s(){r._events[i]?r.emit(i,o):o()}function o(){a._state=t,r.emit(t),r.emit("done")}}}}}},{package:"3box>ipfs>fsm-event"}],[4220,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){for(var r in e){t(e[r],r,e)}}function i(e){return Object.keys(e).sort()}function s(e,t){return~e.indexOf(t)}function a(e,t){return e.filter((function(e){return s(t,e)}))}r.validate=function(e){Object.keys(e);return n(e,(function(t,r){n(t,(function(t,n){if(!e[t])throw new Error("invalid transition from state:"+r+" to state:"+t+" on event:"+n)}))})),!0};var o=r.reachable=function(e){var t={},r=!1;do{r=!1,n(e,(function(e,i){var s=t[i]=t[i]||{};n(e,(function(e,t){s[e]||(s[e]=[t],r=!0)})),n(e,(function(e,i){n(t[e],(function(e,t){s[t]||(s[t]=[i].concat(e),r=!0)}))}))}))}while(r);return t};r.terminal=r.deadlock=function(e){var t=[];return n(e,(function(e,r){(function(e){for(var t in e)return!1;return!0})(e)&&t.push(r)})),t};r.livelock=function(e,t){var r=o(e),i=[];return n(r,(function(e,r){s(t,r)||n(t,(function(t){e[t]||s(i,r)||i.push(r)}))})),i.sort()};function c(e){var t=[];return n(e,(function(e,r){n(e,(function(e,r){s(t,r)||t.push(r)}))})),t.sort()}r.combine=function(e,t,r,n){var o,u,l={},f=c(e),h=c(t),d=(u=h,(o=f).filter((function(e){return!s(u,e)})).concat(u.filter((function(e){return!s(o,e)}))).sort());return function r(n,s){var o,c=n+"-"+s;l[c]||(l[c]={}),o=l[c];var u=i(e[n]),f=i(t[s]);return a(u,f).forEach((function(i){o[i]=e[n][i]+"-"+t[s][i],l[o[i]]||r(e[n][i],t[s][i])})),a(d,u).forEach((function(t){o[t]=e[n][t]+"-"+s,l[o[t]]||r(e[n][t],s)})),a(d,f).forEach((function(e){o[e]=n+"-"+t[s][e],l[o[e]]||r(n,t[s][e])})),l[c]}(r,n),l}}}},{package:"3box>ipfs>fsm-event>fsm"}],[4224,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){if("undefined"==typeof window)return null;var e={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}}}},{package:"3box>ipfs>libp2p-webrtc-star>simple-peer>get-browser-rtc"}],[4226,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}}}},{package:"3box>ipfs>async-iterator-to-pull-stream>get-iterator"}],[4234,{"./types":4235,"cross-fetch/polyfill":2103},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(a,o)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=n[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},a=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r};Object.defineProperty(r,"__esModule",{value:!0});var o=e("./types"),c=e("./types");r.ClientError=c.ClientError,e("cross-fetch/polyfill");var u=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t){return i(this,void 0,void 0,(function(){var r,i,c,u,l,h,d,p,g;return s(this,(function(s){switch(s.label){case 0:return r=this.options,i=r.headers,c=a(r,["headers"]),u=JSON.stringify({query:e,variables:t||undefined}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:u},c))];case 1:return[4,f(l=s.sent())];case 2:if(h=s.sent(),l.ok&&!h.errors&&h.data)return d=l.headers,p=l.status,[2,n({},h,{headers:d,status:p})];throw g="string"==typeof h?{error:h}:h,new o.ClientError(n({},g,{status:l.status,headers:l.headers}),{query:e,variables:t})}}))}))},e.prototype.request=function(e,t){return i(this,void 0,void 0,(function(){var r,i,c,u,l,h,d;return s(this,(function(s){switch(s.label){case 0:return r=this.options,i=r.headers,c=a(r,["headers"]),u=JSON.stringify({query:e,variables:t||undefined}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:u},c))];case 1:return[4,f(l=s.sent())];case 2:if(h=s.sent(),l.ok&&!h.errors&&h.data)return[2,h.data];throw d="string"==typeof h?{error:h}:h,new o.ClientError(n({},d,{status:l.status}),{query:e,variables:t})}}))}))},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var r,n=this.options.headers;return n?n[e]=t:this.options.headers=((r={})[e]=t,r),this},e}();function l(e,t,r){return i(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new u(e).request(t,r)]}))}))}function f(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(r){return(t=e.headers.get("Content-Type"))&&t.startsWith("application/json")?[2,e.json()]:[2,e.text()]}))}))}r.GraphQLClient=u,r.rawRequest=function(e,t,r){return i(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new u(e).rawRequest(t,r)]}))}))},r.request=l,r.default=l}}},{package:"3box>graphql-request"}],[4235,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=function(e){function t(r,n){var i=this,s=t.extractMessage(r)+": "+JSON.stringify({response:r,request:n});return(i=e.call(this,s)||this).response=r,i.request=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,t),i}return i(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);r.ClientError=s}}},{package:"3box>graphql-request"}],[4236,{"./constants":4240,bech32:4245,bs58check:2005,buffer:1996,"hash.js/lib/hash/ripemd":4281,"hash.js/lib/hash/sha":4282},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("bech32"),s=n(e("bs58check")),a=e("hash.js/lib/hash/ripemd"),o=e("hash.js/lib/hash/sha"),c=e("./constants"),u=t.from("01","hex"),l=c.BIP_CONSTANTS.PURPOSES,f=c.BIP_CONSTANTS.COINS,h=0,d=169,p=118,g=135,m=136,_=172,b=208,y=240;function v(e,r){return t.concat([e,r])}function w(e){var r=t.alloc(4);return r.writeUInt32LE(e,0),r}function E(e){var r;return e<253?(r=t.alloc(1)).writeUInt8(e,0):e<=65535?((r=t.alloc(3)).writeUInt8(253,0),r.writeUInt16LE(e,1)):e<4294967295?((r=t.alloc(5)).writeUInt8(254,0),r.writeUInt32LE(e,1)):((r=t.alloc(9)).writeUInt8(255,0),r.writeUInt32LE(e>>>0,1),r.writeUInt32LE(e/4294967296|0,5)),r}function k(e,r,n){"number"==typeof e&&(e=e.toString(16));var i=t.alloc(8),s=e.length%2==0?e.toString(16):"0".concat(e.toString(16));return t.from(s,"hex").reverse().copy(i,0),i.copy(r,n),i}function S(e){var r,n;try{r=s.default.decode(e)[0],n=s.default.decode(e).slice(1)}catch(s){try{var a=i.bech32.decode(e);if("bc"===a.prefix)r=b;else{if("tb"!==a.prefix)throw new Error("Unsupported prefix: must be bc or tb.");r=y}if(0!==a.words[0])throw new Error("Unsupported segwit version: must be 0, got ".concat(a.words[0]));n=t.from(i.bech32.fromWords(a.words.slice(1)))}catch(t){throw new Error("Unable to decode address: ".concat(e,": ").concat(t.message))}}return{versionByte:r,pkh:n}}function T(e){if(e.length<2)throw new Error("Path must be >1 index");var t=e[0],r=e[1];if(t===l.BTC_SEGWIT&&r===f.BTC)return b;if(t===l.BTC_SEGWIT&&r===f.BTC_TESTNET)return y;if(t===l.BTC_WRAPPED_SEGWIT&&r===f.BTC)return 5;if(t===l.BTC_WRAPPED_SEGWIT&&r===f.BTC_TESTNET)return 196;if(t===l.BTC_LEGACY&&r===f.BTC)return 0;if(t===l.BTC_LEGACY&&r===f.BTC_TESTNET)return 111;throw new Error("Invalid Bitcoin path provided. Cannot determine address format.")}function A(e){switch(e.signerPath[0]){case l.BTC_LEGACY:return 1;case l.BTC_WRAPPED_SEGWIT:return 3;case l.BTC_SEGWIT:return 4;default:throw new Error("Unsupported path purpose (".concat(e.signerPath[0],"): cannot determine BTC script type."))}}r.default={buildBitcoinTxRequest:function(e){try{var r=e.prevOuts,n=e.recipient,i=e.value,s=e.changePath,a=e.fee;if(!s)throw new Error("No changePath provided.");if(5!==s.length)throw new Error("Please provide a full change path.");var o=t.alloc(59+69*r.length),u=0,l=T(s);o.writeUInt8(l,0),u++,o.writeUInt32LE(s.length,u),u+=4;for(var f=0;f<s.length;f++)o.writeUInt32LE(s[f],u),u+=4;o.writeUInt32LE(a,u),u+=4;var h=S(n);o.writeUInt8(h.versionByte,u),u++,h.pkh.copy(o,u),u+=h.pkh.length,k(i,o,u),u+=8,o.writeUInt8(r.length,u),u++;var d=0;return r.forEach((function(e){if(!e.signerPath||5!==e.signerPath.length)throw new Error("Full recipient path not specified ");o.writeUInt32LE(e.signerPath.length,u),u+=4;for(var r=0;r<e.signerPath.length;r++)o.writeUInt32LE(e.signerPath[r],u),u+=4;o.writeUInt32LE(e.index,u),u+=4,k(e.value,o,u),u+=8,d+=e.value;var n=A(e);o.writeUInt8(n,u),u++,t.isBuffer(e.txHash)||(e.txHash=t.from(e.txHash,"hex")),e.txHash.copy(o,u),u+=e.txHash.length})),{payload:o,schema:c.signingSchema.BTC_TRANSFER,origData:e,changeData:{value:d-(i+a)}}}catch(e){return{err:e}}},serializeTx:function(e){var r=e.inputs,n=e.outputs,i=e.lockTime,s=void 0===i?0:i,c=t.alloc(4),f=0,T=function(e){var t=!1;return e.forEach((function(e){e.signerPath[0]!==l.BTC_SEGWIT&&e.signerPath[0]!==l.BTC_WRAPPED_SEGWIT||(t=!0)})),t}(r);c.writeUInt32LE(2,f),f+=4,T&&(c=v(c,t.from("00","hex")),c=v(c,t.from("01","hex")));var x=E(r.length);c=v(c,x),f+=x.length,r.forEach((function(e){c=v(c,e.hash.reverse()),f+=e.hash.length;var r=w(e.index);c=v(c,r),f+=r.length;var n=A(e);if(3===n){var i=function(e){var r=t.alloc(22),n=t.from((0,o.sha256)().update(e).digest("hex"),"hex"),i=t.from((0,a.ripemd160)().update(n).digest("hex"),"hex");return r.writeUInt8(h,0),r.writeUInt8(i.length,1),i.copy(r,2),r}(e.pubkey),s=E(i.length),l=E((d=t.concat([s,i])).length);c=v(c,l),f+=l.length,c=v(c,d),f+=d.length}else if(1===n){var d=function(e,r){var n=E((e=t.concat([e,u])).length),i=E(r.length),s=t.concat([n,e,i,r]),a=E(s.length);return t.concat([a,s])}(e.sig,e.pubkey);c=v(c,d),f+=d.length}else if(4===n){var p=t.from("00","hex");c=v(c,p),f+=1}var g=w(4294967295);c=v(c,g),f+=g.length}));var P=E(n.length);if(c=v(c,P),f+=P.length,n.forEach((function(e){var r,n,i=(r=e.value,n=t.alloc(8),k(r,n,0),n);c=v(c,i),f+=i.length;var s=function(e){var r=S(e);switch(r.versionByte){case b:case y:return n=r.pkh,(i=t.alloc(2+n.length)).writeUInt8(h,0),i.writeUInt8(n.length,1),n.copy(i,2),i;case 5:case 196:return function(e){var r=t.alloc(3+e.length),n=0;return r.writeUInt8(d,n),n++,r.writeUInt8(e.length,n),n++,e.copy(r,n),n+=e.length,r.writeUInt8(g,n),n++,r}(r.pkh);case 0:case 111:return function(e){var r=t.alloc(5+e.length),n=0;return r.writeUInt8(p,n),n++,r.writeUInt8(d,n),n++,r.writeUInt8(e.length,n),n++,e.copy(r,n),n+=e.length,r.writeUInt8(m,n),n++,r.writeUInt8(_,n),n++,r}(r.pkh);default:throw new Error("Unknown version byte: ".concat(r.versionByte,". Cannot build BTC transaction."))}var n,i}(e.recipient),a=E(s.length);c=v(c,a),f+=a.length,c=v(c,s),f+=s.length})),T){for(var I=[],N=[],C=0;C<r.length;C++)I.push(r[C].sig),N.push(r[C].pubkey);var R=function(e,r){var n=t.alloc(0),i=t.alloc(1);i.writeUInt8(2,0);for(var s=0;s<e.length;s++){var a=t.concat([e[s],u]),o=E(a.length),c=r[s],l=E(c.length);n=t.concat([n,i,o,a,l,c])}return n}(I,N);c=v(c,R),f+=R.length}return t.concat([c,w(s)]).toString("hex")},getBitcoinAddress:function(e,r){var n=null,a=null;if(r===b?(n="bc",a=0):r===y&&(n="tb",a=0),null!==n&&null!==a){var o=i.bech32.toWords(e);return o.unshift(a),i.bech32.encode(n,o)}return s.default.encode(t.concat([t.from([r]),e]))},getAddressFormat:T}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4237,{buffer:1996,"js-sha3":4633,rlp:4247},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.parseCanonicalName=r.parseSolidityJSONABI=void 0;var n=e("js-sha3"),i=e("rlp");r.parseSolidityJSONABI=function(e,r){e=a(e);var n=r.find((function(t){if("function"===t.type&&s(l(t).canonicalName)===e)return t}));if(n){var o=l(n).def;return t.from((0,i.encode)(o))}return null};function s(e){return"0x".concat((0,n.keccak256)(e).slice(0,8))}function a(e){if("string"!=typeof e||10!==e.length&&8!==e.length)throw new Error("`sig` must be a hex string with 4 bytes of data.");return 8===e.length&&(e="0x".concat(e)),e}function o(e){if(p(e))return d(e);if(e.indexOf(",")>-1)return e.slice(0,e.indexOf(","));if(e.indexOf(")")>-1)return e.slice(0,e.indexOf(")"));throw new Error(g)}function c(e){if(!p(e))return[u(e)];var t={szBytes:0,typeIdx:m.indexOf("tuple"),arraySzs:[]},r=d(e,!1),n=e.slice(r.length);t.arraySzs=h(n),r=r.slice(1);for(var i=[];r.length>0;){var s=o(r);r=r.slice(s.length+1),i=i.concat(c(s))}if(!i.length)throw new Error(g);return[t,i]}function u(e){var t={szBytes:0,typeIdx:0,arraySzs:[]},r=!1;if(m.forEach((function(n,i){if(e.indexOf(n)>-1&&!r){t.typeIdx=i,t.arraySzs=h(e);var s=t.arraySzs.length>0?e.indexOf("["):e.length,a=e.slice(n.length,s);if(parseInt(a)&&(t.szBytes=parseInt(a)/8,t.szBytes>32))throw new Error(g);r=!0}})),!r)throw new Error(g);return t}function l(e,t,r,n){if(void 0===t&&(t=""),void 0===r&&(r=[]),void 0===n&&(n=!1),!n){var i=e.name||"";r.push(i),t+=i}return e.inputs&&(t+="(",e.inputs.forEach((function(e){var n=function(e){if(!e.type)throw new Error("No type in input");var t=[e.name],r=function(e){var t,r={szBytes:0,typeIdx:0,arraySzs:[]};m.forEach((function(n,i){e.indexOf(n)>-1&&!t&&(t=n,r.typeIdx=i)})),r.arraySzs=h(e);var n=r.arraySzs.length>0?e.indexOf("["):e.length;if(["uint","int","bytes"].indexOf(t)>-1){var i=parseInt(e.slice(t.length,n))||0;if(i>256)throw new Error("Invalid param size");r.szBytes=i/8}else r.szBytes=0;return r}(e.type),n=r.typeIdx,i=r.szBytes,s=r.arraySzs;return t.push(n),t.push(i),t.push(s),t}(e);if(e.type.indexOf("tuple")>-1&&e.components){var i=l({inputs:e.components},t,[],!0);t=i.canonicalName,t+="".concat(e.type.slice(5),","),n.push(i.def)}else t+=e.type,t+=",";r.push(n)})),","===t[t.length-1]&&(t=t.slice(0,t.length-1)),t+=")"),{def:r,canonicalName:t}}function f(e,t){void 0===t&&(t="");var r=[],n=0;return e.forEach((function(e,i){Array.isArray(e)?r[r.length-1].push(f(e,"".concat(i,"-"))):r.push(["#".concat(t).concat(i+1-n),e.typeIdx,e.szBytes,e.arraySzs]),e.typeIdx===m.indexOf("tuple")&&(n+=1)})),r}function h(e){if("string"!=typeof e)throw new Error("Invalid type");for(var t=[],r=e;r.length>0;){var n=r.indexOf("[");if(n<0)return t;var i=r.slice(n),s=i.indexOf("]");if(s<0)throw new Error("Bad param type");var a=i.slice(1,s);0===a.length?t.push(0):t.push(parseInt(a)),r=i.slice(s+1)}return t}function d(e,t){void 0===t&&(t=!0);for(var r=0,n=!1,i=0;i<e.length;i++){"("===e[i]?(r+=1,n=!0):")"===e[i]&&(r-=1);var s=","===e[i+1]||")"===e[i+1]||i===e.length-1;if(t||"["!==e[i+1]||(s=!0),!r&&n&&s)return e.slice(0,i+1)}throw new Error(g)}function p(e){return"("===e[0]}r.parseCanonicalName=function(e,r){if((e=a(e))!==s(r))throw new Error("Name does not match provided sig.");var n=[],u=r.indexOf("(");if(u<0)throw new Error(g);n.push(r.slice(0,u)),r=r.slice(u+1);for(var l=[];r.length>1;){var h=o(r);l=l.concat(c(h)),r=r.slice(h.length+1)}var d=f(l);return t.from((0,i.encode)(n.concat(d)))};var g="Could not parse canonical function name.",m=[null,"address","bool","uint","int","bytes","string","tuple"]}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4238,{"./evm":4237},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CALLDATA=void 0;var n=e("./evm");r.CALLDATA={EVM:{type:1,parsers:{parseSolidityJSONABI:n.parseSolidityJSONABI,parseCanonicalName:n.parseCanonicalName}}}}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4239,{"./bitcoin":4236,"./constants":4240,"./ethereum":4241,"./genericSigning":4242,"./index":4243,"./util":4244,bitwise:1920,buffer:1996,"hash.js/lib/hash/sha":4282,superagent:5822},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Client=void 0;var s=i(e("bitwise")),a=i(e("superagent")),o=i(e("./bitcoin")),c=e("hash.js/lib/hash/sha"),u=e("./index"),l=e("./constants"),f=i(e("./ethereum")),h=e("./genericSigning"),d=e("./util"),p=t.alloc(32),g=function(){function e(e){var t=e.baseUrl,r=e.name,n=e.privKey,i=e.stateData,s=e.timeout,a=e.retryCount,o=e.skipRetryOnWrongWallet;if(this.ephemeralPub=null,this.deviceId=null,this.isPaired=!1,this.activeWallets={internal:{uid:p,name:null,capabilities:null,external:!1},external:{uid:p,name:null,capabilities:null,external:!0}},this.skipRetryOnWrongWallet=o||!1,i)this._unpackAndApplyStateData(i);else{if(this.baseUrl=t||l.BASE_URL,r&&(r.length<5||r.length>24))throw new Error("`name` must be 5-24 characters");this.name=r||"Unknown",this.privKey=n||(0,d.randomBytes)(32),this.key=(0,d.getP256KeyPair)(this.privKey),this.retryCount=a||3,this.timeout=s||6e4}}return e.prototype.getStateData=function(){return this._packStateData()},e.prototype.getFwVersion=function(){return this.fwVersion&&this.fwVersion.length>=3?{fix:this.fwVersion[0],minor:this.fwVersion[1],major:this.fwVersion[2]}:null},e.prototype.getAppName=function(){return this.name},e.prototype.connect=function(e,t){var r=this;return new Promise((function(n,i){var s=(0,d.promisifyCb)(n,i,t);if("function"==typeof e){if(!r.deviceId)return s("No device ID has been stored. Please connect with your device ID first.");s=e}else r.deviceId=e;var a=r._buildRequest(l.deviceCodes.CONNECT,r.pubKeyBytes());r._request(a,null,(function(e,t){return e?s(e):(r.isPaired=r._handleConnect(t)||!1,!r.isPaired||r._fwVersionGTE(0,14,1)?s(e,r.isPaired):void r.fetchActiveWallet((function(e){return s(e,r.isPaired)})))}))}))},e.prototype.pair=function(e,r){var n=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,r),o=n.pubKeyBytes(),c=t.alloc(25);if(n.name.length<5||n.name.length>24)return a("Invalid length for name provided. Must be 5-24 characters.");e.length>0&&c.write(n.name);var u=(0,d.generateAppSecret)(o,c,t.from(e)),l=n.key.sign(u),f=(0,d.toPaddedDER)(l),h=t.concat([c,f]);n._request(h,"FINALIZE_PAIRING",(function(e,t){if(e)return a(e);var r=n._handlePair(t);if(r)return a(r);n.fetchActiveWallet((function(e){return e?a(e):a(null,n.hasActiveWallet())}))}))}))},e.prototype.test=function(e,r){var n=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,r);if(!e.payload)return a("First argument must contain `testID` and `payload` fields.");var o=t.alloc(506);o.writeUInt32BE(e.testID,0),o.writeUInt16BE(e.payload.length,4),e.payload.copy(o,6),n._request(o,"TEST",(function(e,t){if(e)return a(e);var r=n._handleEncResponse(t,l.decResLengths.test);return null!==r.err?a(r.err):a(null,r.data.slice(65))}))}))},e.prototype.getAddresses=function(e,r){var n=this;return new Promise((function(i,a){var o=(0,d.promisifyCb)(i,a,r),c=e.startPath,u=e.n,f=e.flag,h=void 0===f?0:f;if(c===undefined||u===undefined)return o("Please provide `startPath` and `n` options");if(c.length<2||c.length>5)return o("Path must include between 2 and 5 indices");if(!(0,d.isUInt4)(u)||!(0,d.isUInt4)(h))return o("Parameters `n` and `flag` must be integers between 0 and 15 inclusive");if(u>10)return o("You may only request ".concat(10," addresses at once."));var p=(0,l.getFwVersionConst)(n.fwVersion);if(!((p.getAddressFlags||[]).indexOf(h)>-1&&(h===l.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB||h===l.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB))&&!(0,d.isValidAssetPath)(c,p))return o("Parent derivation path is not supported");var g=53;if(p.varAddrPathSzAllowed)g+=1;else if(5!==c.length)return o("Your Lattice firmware only supports derivation paths with 5 indices. Please upgrade.");var m=t.alloc(g),_=0,b=n.getActiveWallet();if(null===b)return o("No active wallet.");b.uid.copy(m,_),_+=32,p.varAddrPathSzAllowed&&(m.writeUInt8(c.length,_),_+=1);for(var y=0;y<5;y++)y<=c.length&&m.writeUInt32BE(c[y],_),_+=4;var v,w=0;if(p.addrFlagsAllowed){w=p.getAddressFlags&&p.getAddressFlags.indexOf(h)>-1?h:0;var E=s.default.nibble.read(w),k=s.default.nibble.read(u);v=s.default.byte.write(E.concat(k))}else v=u;return m.writeUInt8(v,_),_++,n._request(m,"GET_ADDRESSES",(function(e,t){if(e)return o(e);var r=n._handleGetAddresses(t,w);return r.err?o(r.err):o(null,r.data)}))}))},e.prototype.sign=function(e,r,i,s){var a=this;return void 0===i&&(i=null),void 0===s&&(s=null),new Promise((function(c,u){var p=(0,d.promisifyCb)(c,u,r),g=e.data;if(!g)return p("You must provide `data`");var m,_,b,y=(0,l.getFwVersionConst)(a.fwVersion);g=n({fwConstants:y},g);var v=null;if(null!==i&&null!==s)v=i.currency,m=i,_=t.concat([s,m.extraDataPayloads.shift()]),b=l.signingSchema.EXTRA_DATA;else{v=e.currency;try{var w=y.genericSigning&&y.genericSigning.encodingTypes&&y.genericSigning.encodingTypes.EVM;if("ETH"===v&&w){var E;console.warn("Using the legacy ETH signing path. This will soon be deprecated. "+"Please switch to general signing request.");try{E=f.default.ethConvertLegacyToGenericReq(g)}catch(e){return p("Could not convert legacy request. Please switch to a general signing "+"request. See gridplus-sdk docs for more information.")}g={fwConstants:y,encodingType:l.EXTERNAL.SIGNING.ENCODINGS.EVM,curveType:l.EXTERNAL.SIGNING.CURVES.SECP256K1,hashType:l.EXTERNAL.SIGNING.HASHES.KECCAK256,signerPath:g.signerPath,payload:E},v=null}m="ETH"===v?f.default.buildEthereumTxRequest(g):"ETH_MSG"===v?f.default.buildEthereumMsgRequest(g):"BTC"===v?o.default.buildBitcoinTxRequest(g):(0,h.buildGenericSigningMsgRequest)(g)}catch(e){return p("Error building signing request: ".concat(e.message))}if(m.err!==undefined)return p(m.err);if(m.payload.length>y.reqMaxDataSz)return p("Transaction is too large");_=m.payload,b=m.schema}var k=t.alloc(2+y.reqMaxDataSz),S=0,T=m.extraDataPayloads&&Number(m.extraDataPayloads.length>0);k.writeUInt8(T,S),S+=1,k.writeUInt8(b,S),S+=1;var A=a.getActiveWallet();return null===A?p("No active wallet."):(A.uid.copy(k,S),S+=A.uid.length,_.copy(k,S),a._request(k,"SIGN_TRANSACTION",(function(t,r){if(t){if(t)return p(t)}else{if(T){var n=a._handleEncResponse(r,l.decResLengths.sign);return s=n.data.slice(65,73),i||((i=m).currency=v),a.sign(e,p,i,s)}try{var o=a._handleSign(r,v,m);return p(null,o)}catch(t){return p(t.message)}}})))}))},e.prototype.addDecoders=function(e,t){return new Promise((function(e,r){return(0,d.promisifyCb)(e,r,t)("Feature currently disabled in Lattice firmware. Please include "+"calldata decoder data in the signing request itself.")}))},e.prototype.getDecoders=function(e,t){return new Promise((function(e,r){return(0,d.promisifyCb)(e,r,t)("Feature currently disabled in Lattice firmware. Please include "+"calldata decoder data in the signing request itself.")}))},e.prototype.removeDecoders=function(e,t){return new Promise((function(e,r){return(0,d.promisifyCb)(e,r,t)("Feature currently disabled in Lattice firmware. Please include "+"calldata decoder data in the signing request itself.")}))},e.prototype.addPermissionV0=function(e,t){return new Promise((function(e,r){return(0,d.promisifyCb)(e,r,t)("This feature has been deprecated and may be replaced at a later time.")}))},e.prototype.getKvRecords=function(e,r){var n=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,r),o=e.type,c=void 0===o?0:o,u=e.n,f=void 0===u?1:u,h=e.start,p=void 0===h?0:h,g=(0,l.getFwVersionConst)(n.fwVersion);if(!g.kvActionsAllowed)return a("Unsupported. Please update firmware.");if(f<1)return a("You must request at least one record.");if(f>g.kvActionMaxNum)return a("You may only request up to ".concat(g.kvActionMaxNum," records at once."));var m=t.alloc(9);return m.writeUInt32LE(c,0),m.writeUInt8(f,4),m.writeUInt32LE(p,5),n._request(m,"GET_KV_RECORDS",(function(e,t){if(!e){var r=n._handleEncResponse(t,l.decResLengths.getKvRecords);if(r.err)return a(r.err);var i=65,s=parseInt(r.data.slice(i,i+4).toString("hex"),16);i+=4;var o=parseInt(r.data.slice(i,i+1).toString("hex"),16);if(i+=1,o>g.kvActionMaxNum)return a("Too many records fetched. Firmware error.");for(var c=[],u=0;u<o;u++){var f={};f.id=parseInt(r.data.slice(i,i+4).toString("hex"),16),i+=4,f.type=parseInt(r.data.slice(i,i+4).toString("hex"),16),i+=4,f.caseSensitive=1===parseInt(r.data.slice(i,i+1).toString("hex"),16),i+=1;var h=parseInt(r.data.slice(i,i+1).toString("hex"),16);i+=1,f.key=r.data.slice(i,i+h-1).toString(),i+=g.kvKeyMaxStrSz+1;var d=parseInt(r.data.slice(i,i+1).toString("hex"),16);i+=1,f.val=r.data.slice(i,i+d-1).toString(),i+=g.kvValMaxStrSz+1,c.push(f)}return a(null,{records:c,total:s,fetched:o})}if(e)return a(e)}))}))},e.prototype.addKvRecords=function(e,r){var n=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,r),o=e.type,c=void 0===o?0:o,u=e.records,f=void 0===u?{}:u,h=e.caseSensitive,p=void 0!==h&&h,g=(0,l.getFwVersionConst)(n.fwVersion);if(!g.kvActionsAllowed)return a("Unsupported. Please update firmware.");if("object"!=typeof f||0===Object.keys(f).length)return a("One or more key-value mapping must be provided in `records` param.");if(Object.keys(f).length>g.kvActionMaxNum)return a("Too many keys provided. Please only provide up to ".concat(g.kvActionMaxNum,"."));if(Object.keys(f).length<1)return a("You must provide at least one key to add.");var m=t.alloc(1+139*g.kvActionMaxNum);m.writeUInt8(Object.keys(f).length,0);var _=1;try{Object.keys(f).forEach((function(e){if("string"!=typeof e||String(e).length>g.kvKeyMaxStrSz)throw new Error("Key ".concat(e," too large. Must be <=").concat(g.kvKeyMaxStrSz," characters."));if("string"!=typeof f[e]||String(f[e]).length>g.kvValMaxStrSz)throw new Error("Value ".concat(f[e]," too large. Must be <=").concat(g.kvValMaxStrSz," characters."));if(0===String(e).length||0===String(f[e]).length)throw new Error("Keys and values must be >0 characters.");if(!l.ASCII_REGEX.test(e)||!l.ASCII_REGEX.test(f[e]))throw new Error("Unicode characters are not supported.");m.writeUInt32LE(0,_),_+=4,m.writeUInt32LE(c,_),_+=4,m.writeUInt8(p?1:0,_),_+=1,m.writeUInt8(String(e).length+1,_),_+=1,t.from(String(e)).copy(m,_),_+=g.kvKeyMaxStrSz+1,m.writeUInt8(String(f[e]).length+1,_),_+=1,t.from(String(f[e])).copy(m,_),_+=g.kvValMaxStrSz+1}))}catch(e){return a("Error building request: ".concat(e.message))}return n._request(m,"ADD_KV_RECORDS",(function(e,t){if(!e){var r=n._handleEncResponse(t,l.decResLengths.empty);return r.err?a(r.err):a(null)}if(e)return a(e)}))}))},e.prototype.removeKvRecords=function(e,r){var n=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,r),o=e.type,c=void 0===o?0:o,u=e.ids,f=void 0===u?[]:u,h=(0,l.getFwVersionConst)(n.fwVersion);if(!h.kvActionsAllowed)return a("Unsupported. Please update firmware.");if(!Array.isArray(f)||f.length<1)return a("You must include one or more `ids` to removed.");if(f.length>h.kvRemoveMaxNum)return a("Only up to ".concat(h.kvRemoveMaxNum," records may be removed at once."));var p=t.alloc(5+4*h.kvRemoveMaxNum);p.writeUInt32LE(c,0),p.writeUInt8(f.length,4);for(var g=0;g<f.length;g++)p.writeUInt32LE(f[g],5+4*g);return n._request(p,"REMOVE_KV_RECORDS",(function(e,t){if(!e){var r=n._handleEncResponse(t,l.decResLengths.empty);return r.err?a(r.err):a(null)}if(e)return a(e)}))}))},e.prototype.fetchActiveWallet=function(e){var r=this;return new Promise((function(n,i){var s=(0,d.promisifyCb)(n,i,e),a=t.alloc(0);return r._request(a,"GET_WALLETS",(function(e,t){return e?(r._resetActiveWallets(),s(e)):s(r._handleGetWallets(t))}))}))},e.prototype._getSharedSecret=function(){return t.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))},e.prototype._getEphemId=function(){if(null===this.ephemeralPub)return null;var e=this._getSharedSecret();return t.from((0,c.sha256)().update(e).digest("hex"),"hex").slice(0,4)},e.prototype._buildEncRequest=function(e,r){var n=parseInt(this._getEphemId().toString("hex"),16),i=t.concat([t.from([e]),r]),s=(0,d.checksum)(i),a=t.alloc(i.length+4);i.copy(a,0),a.writeUInt32LE(s,i.length);var o=this._getSharedSecret(),c=(0,d.aes256_encrypt)(a,o),u=t.alloc(l.ENC_MSG_LEN+4);return u.writeUInt32LE(n,0),c.copy(u,4),this._buildRequest(l.deviceCodes.ENCRYPTED_REQUEST,u)},e.prototype._buildRequest=function(e,r){var n=r&&t.isBuffer(r)?r.length+1:1;e===l.deviceCodes.ENCRYPTED_REQUEST&&(n=1+r.length);var i=0,s=t.alloc(n+8);i=s.writeUInt8(l.VERSION_BYTE,i),i=s.writeUInt8(l.REQUEST_TYPE_BYTE,i);var a=(0,d.randomBytes)(4);i=s.writeUInt32BE(parseInt("0x".concat(a.toString("hex"))),i),i=s.writeUInt16BE(n,i),i=s.writeUInt8(e,i),n>1&&(i=r.copy(s,i));var o=(0,d.checksum)(s),c=t.alloc(s.length+4);return i=s.copy(c),c.writeUInt32BE(o,i),c},e.prototype._request=function(e,t,r,n){var i=this;if(void 0===n&&(n=this.retryCount),!this.deviceId)return r("Device ID is not set. Please set it and try again.");if(t&&l.encReqCodes[t]===undefined)return r("Unknown encrypted request code.");var s=t?this._buildEncRequest(l.encReqCodes[t],e):e,o="".concat(this.baseUrl,"/").concat(this.deviceId);a.default.post(o).timeout(this.timeout).send({data:s}).then((function(s){if(!s||!s.body)return r("Invalid response: ".concat(s));if(200!==s.body.status)return r("Error code ".concat(s.body.status,": ").concat(s.body.message));var a=(0,d.parseLattice1Response)(s.body.message),o=a.responseCode===l.responseCodes.RESP_ERR_DEV_BUSY||a.responseCode===l.responseCodes.RESP_ERR_GCE_TIMEOUT,c=a.responseCode===l.responseCodes.RESP_ERR_WRONG_WALLET,u=a.responseCode===l.responseCodes.RESP_ERR_INVALID_EPHEM_ID,f=n>0;if(f&&o)setTimeout((function(){i._request(e,t,r,n-1)}),3e3);else if(f&&u)i.connect(i.deviceId,(function(s,a){return s?r(s):a?void i._request(e,t,r,n-1):r("Not paired to device.")}));else if(f&&c&&!i.skipRetryOnWrongWallet)i._resetActiveWallets(),i.fetchActiveWallet().then((function(){if(!(e=i._replaceWalletUID(t,e)))return r("Wrong wallet. Failed to switch. Please reconnect.");i._request(e,t,r,0)})).catch((function(e){return r(e)}));else if(a.responseCode||a.err){if(a.err)return r(a.err);r(l.responseMsgs[a.responseCode]||"Unknown request failure")}else r(null,a.data,a.responseCode)})).catch((function(e){var t="ECONNABORTED"===e.code&&"ETIME"===e.errno;return r(t?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device: ".concat(e.message))}))},e.prototype._handleConnect=function(e){var t=0,r=e.readUInt8(t)===l.messageConstants.PAIRED;t++;var n=e.slice(t,t+65).toString("hex");if(t+=65,this.fwVersion=e.slice(t,t+4),t+=4,this.ephemeralPub=(0,d.getP256KeyPairFromPub)(n),r&&this._fwVersionGTE(0,14,1)){var i=e.slice(t,t+160);t+=160;var s=this._getSharedSecret(),a=(0,d.aes256_decrypt)(i,s);if(0!==a[a.length-2]||0!==a[a.length-1])throw new Error("Failed to connect to Lattice.");this._parseAndAddWallets(a)}return r},e.prototype._handleEncResponse=function(e,t){var r=this._getSharedSecret(),n=e.slice(0,l.ENC_MSG_LEN),i=(0,d.aes256_decrypt)(n,r);t+=65;var s=i.slice(0,t),a=parseInt("0x".concat(i.slice(t,t+4).toString("hex"))),o=(0,d.checksum)(s);if(a!==o)return{err:"Checksum mismatch in response from Lattice (calculated ".concat(o,", wanted ").concat(a,")")};var c=i.slice(0,65).toString("hex");try{return this.ephemeralPub=(0,d.getP256KeyPairFromPub)(c),{err:null,data:i}}catch(e){return{err:"Error handling getAddresses response: ".concat(e.toString())}}},e.prototype._handlePair=function(e){var t=this._handleEncResponse(e,l.decResLengths.empty);return t.err?t.err:(this.isPaired=!0,null)},e.prototype._handleGetAddresses=function(e,t){var r=this._handleEncResponse(e,l.decResLengths.getAddresses);if(null!==r.err)return r;var n=r.data,i=65,s=[],a=u.Constants.GET_ADDR_FLAGS,o=a.ED25519_PUB,c=a.SECP256K1_PUB,f=t===o||t===c;for(f&&(i+=1);i+4<l.decResLengths.getAddresses;)if(f){var h=n.slice(i,i+65),d=h.every((function(e){return 0===e}));d||t!==o?d||s.push(h):s.push(h.slice(0,32)),i+=65}else{var p=n.slice(i,i+l.ADDR_STR_LEN);i+=l.ADDR_STR_LEN;var g=p.indexOf(0);g>0&&s.push(p.slice(0,g).toString())}return{data:s,err:null}},e.prototype._handleGetWallets=function(e){var t=this._handleEncResponse(e,l.decResLengths.getWallets);if(null!==t.err)return t;var r=t.data;return this._parseAndAddWallets(r.slice(65)),this.activeWallets.internal.uid.equals(p)&&this.activeWallets.external.uid.equals(p)?"No active wallet.":null},e.prototype._parseAndAddWallets=function(e){var t=0;this.activeWallets.internal.uid=e.slice(t,t+32),this.activeWallets.internal.capabilities=e.readUInt32BE(t+32),this.activeWallets.internal.name=e.slice(t+36,t+71),t+=71,this.activeWallets.external.uid=e.slice(t,t+32),this.activeWallets.external.capabilities=e.readUInt32BE(t+32),this.activeWallets.external.name=e.slice(t+36,t+71)},e.prototype._handleSign=function(e,r,n){void 0===n&&(n=null);var i=this._handleEncResponse(e,l.decResLengths.sign);if(null!==i.err)return{err:i.err};var s,a=65,u=i.data;if("BTC"===r){var p=o.default.getAddressFormat(n.origData.changePath),g=u.slice(a,a+20);a+=20,s=o.default.getBitcoinAddress(g,p)}if("BTC"===r){for(var m=[],_=[],b=0;a<u.length&&48===u[a];){var y=a,v=a+2+u[a+1];_.push(u.slice(y,v));var w=33*b+825,E=33*(b+1)+825;m.push(u.slice(w,E)),a+=74,b+=1}var k={inputs:[],outputs:[]};k.outputs.push({value:n.origData.value,recipient:n.origData.recipient}),n.changeData.value>0&&k.outputs.push({value:n.changeData.value,recipient:s});for(var S=0;S<_.length;S++)k.inputs.push({hash:n.origData.prevOuts[S].txHash,index:n.origData.prevOuts[S].index,sig:_[S],pubkey:m[S],signerPath:n.origData.prevOuts[S].signerPath});var T=o.default.serializeTx(k),A=T,x=t.from((0,c.sha256)().update(t.from(A,"hex")).digest("hex"),"hex");return{tx:T,txHash:(0,c.sha256)().update(x).digest("hex"),changeRecipient:s,sigs:_}}if("ETH"===r){var P=(0,d.parseDER)(u.slice(a,a+2+u[a+1]));a+=74;var I=u.slice(a,a+20),N=f.default.buildEthRawTx(n,P,I),C=N.rawTx,R=N.sigWithV;return{tx:"0x".concat(C),txHash:"0x".concat(f.default.hashTransaction(C)),sig:{v:R.v,r:R.r.toString("hex"),s:R.s.toString("hex")},signer:I}}if("ETH_MSG"===r){P=(0,d.parseDER)(u.slice(a,a+2+u[a+1]));a+=74;var O=u.slice(a,a+20),L=f.default.validateEthereumMsgResponse({signer:O,sig:P},n);return{sig:{v:L.v,r:L.r.toString("hex"),s:L.s.toString("hex")},signer:O}}return(0,h.parseGenericSigningResponse)(u,a,n.curveType,n.omitPubkey)},e.prototype._resetActiveWallets=function(){this.activeWallets.internal.uid=p,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=p,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null},e.prototype._replaceWalletUID=function(e,t){var r=this.getActiveWallet();return r?"GET_ADDRESSES"===e?(r.uid.copy(t,0),t):"SIGN_TRANSACTION"===e?(r.uid.copy(t,2),t):null:null},e.prototype._packStateData=function(){try{var e={activeWallets:{internal:{uid:this.activeWallets.internal.uid.toString("hex"),name:this.activeWallets.internal.name.toString(),capabilities:this.activeWallets.internal.capabilities},external:{uid:this.activeWallets.external.uid.toString("hex"),name:this.activeWallets.external.name.toString(),capabilities:this.activeWallets.external.capabilities}},ephemeralPub:this.ephemeralPub.getPublic().encode("hex"),fwVersion:this.fwVersion.toString("hex"),deviceId:this.deviceId,name:this.name,baseUrl:this.baseUrl,privKey:this.privKey.toString("hex"),retryCount:this.retryCount,timeout:this.timeout};return JSON.stringify(e)}catch(e){return console.warn("Could not pack state data."),null}},e.prototype._unpackAndApplyStateData=function(e){try{var r=JSON.parse(e),n={uid:t.from(r.activeWallets.internal.uid,"hex"),name:t.from(r.activeWallets.internal.name),capabilities:r.activeWallets.internal.capabilities,external:!1},i={uid:t.from(r.activeWallets.external.uid,"hex"),name:t.from(r.activeWallets.external.name),capabilities:r.activeWallets.external.capabilities,external:!0},s=t.from(r.ephemeralPub,"hex"),a=t.from(r.fwVersion,"hex"),o=t.from(r.privKey,"hex");this.activeWallets.internal=n,this.activeWallets.external=i,this.ephemeralPub=(0,d.getP256KeyPairFromPub)(s),this.fwVersion=a,this.deviceId=r.deviceId,this.name=r.name,this.baseUrl=r.baseUrl,this.privKey=o,this.key=(0,d.getP256KeyPair)(this.privKey),this.retryCount=r.retryCount,this.timeout=r.timeout}catch(e){console.warn("Could not apply state data.")}},e.prototype._fwVersionGTE=function(e,t,r){var n=this.getFwVersion(),i=n.major,s=n.minor,a=n.fix;return i>e||i>=e&&s>t||i>=e&&s>=t&&a>=r},e.prototype.getActiveWallet=function(){return p.equals(this.activeWallets.external.uid)?p.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external},e.prototype.hasActiveWallet=function(){return null!==this.getActiveWallet()},e.prototype.pubKeyBytes=function(e){void 0===e&&(e=!1);var r=this.key.getPublic().encode("hex"),n=t.from(r,"hex");if(!0===e){var i=n.slice(1,33).reverse(),s=n.slice(33,65).reverse();return t.concat([n[0],i,s])}return n},e}();r.Client=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4240,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.ETH_ABI_LATTICE_FW_TYPE_MAP=r.MAX_CHAIN_ID_BYTES=r.HANDLE_LARGER_CHAIN_ID=r.HARDENED_OFFSET=r.VERSION_BYTE=r.REQUEST_TYPE_BYTE=r.signingSchema=r.responseMsgs=r.responseCodes=r.messageConstants=r.ethMsgProtocol=r.encReqCodes=r.deviceCodes=r.decResLengths=r.addressSizes=r.ENC_MSG_LEN=r.BASE_URL=r.BIP_CONSTANTS=r.AES_IV=r.ADDR_STR_LEN=r.getFwVersionConst=r.ASCII_REGEX=r.EXTERNAL=void 0;r.AES_IV=[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100];r.ADDR_STR_LEN=129;var s={empty:0,getAddresses:1290,sign:1090,getWallets:142,getKvRecords:1395,getDecoders:1608,removeDecoders:4,test:1646};r.decResLengths=s;var a=0;r.ENC_MSG_LEN=a,Object.keys(s).forEach((function(e){s[e]+82>a&&(r.ENC_MSG_LEN=a=s[e]+82)}));r.deviceCodes={CONNECT:1,ENCRYPTED_REQUEST:2};r.encReqCodes={FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_DECODERS:6,GET_KV_RECORDS:7,ADD_KV_RECORDS:8,REMOVE_KV_RECORDS:9,GET_DECODERS:10,REMOVE_DECODERS:11,TEST:12};r.messageConstants={NOT_PAIRED:0,PAIRED:1};r.addressSizes={BTC:20,ETH:20};var o={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WRONG_WALLET:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141,RESP_ERR_INVALID_EPHEM_ID:142};r.responseCodes=o;var c=((n={})[o.RESP_SUCCESS]=0,n[o.RESP_ERR_INVALID_MSG]="Invalid request",n[o.RESP_ERR_UNSUPPORTED_VER]="Unsupported version",n[o.RESP_ERR_DEV_BUSY]="Device busy",n[o.RESP_ERR_USER_TIMEOUT]="Timeout waiting for user",n[o.RESP_ERR_USER_DECLINED]="Request declined by user",n[o.RESP_ERR_PAIR_FAIL]="Pairing failed",n[o.RESP_ERR_PAIR_DISABLED]="Pairing is currently disabled",n[o.RESP_ERR_PERMISSION_DISABLED]="Automated signing is currently disabled",n[o.RESP_ERR_INTERNAL]="Device error",n[o.RESP_ERR_GCE_TIMEOUT]="Timeout",n[o.RESP_ERR_WRONG_WALLET]="Active wallet does not match request",n[o.RESP_ERR_DEV_LOCKED]="Device locked",n[o.RESP_ERR_DISABLED]="Disabled",n[o.RESP_ERR_ALREADY]="Record already exists. You must first remove it on your device.",n[o.RESP_ERR_INVALID_EPHEM_ID]="Could not find requester. Please reconnect.",n);r.responseMsgs=c;r.signingSchema={BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3,EXTRA_DATA:4,GENERAL_SIGNING:5};var u=2147483648;r.HARDENED_OFFSET=u;var l={PURPOSES:{ETH:2147483692,BTC_LEGACY:2147483692,BTC_WRAPPED_SEGWIT:2147483697,BTC_SEGWIT:2147483732},COINS:{ETH:2147483708,BTC:u,BTC_TESTNET:2147483649}};r.BIP_CONSTANTS=l;r.REQUEST_TYPE_BYTE=2;r.VERSION_BYTE=1;r.HANDLE_LARGER_CHAIN_ID=255;r.MAX_CHAIN_ID_BYTES=8;r.BASE_URL="https://signing.gridpl.us";var f={address:1,bool:2,uint8:3,uint16:4,uint24:5,uint32:6,uint40:7,uint48:8,uint56:9,uint64:10,uint72:11,uint80:12,uint88:13,uint96:14,uint104:15,uint112:16,uint120:17,uint128:18,uint136:19,uint144:20,uint152:21,uint160:22,uint168:23,uint176:24,uint184:25,uint192:26,uint200:27,uint208:28,uint216:29,uint224:30,uint232:31,uint240:32,uint248:33,uint256:34,int8:35,int16:36,int24:37,int32:38,int40:39,int48:40,int56:41,int64:42,int72:43,int80:44,int88:45,int96:46,int104:47,int112:48,int120:49,int128:50,int136:51,int144:52,int152:53,int160:54,int168:55,int176:56,int184:57,int192:58,int200:59,int208:60,int216:61,int224:62,int232:63,int240:64,int248:65,int256:66,uint:67,bytes1:69,bytes2:70,bytes3:71,bytes4:72,bytes5:73,bytes6:74,bytes7:75,bytes8:76,bytes9:77,bytes10:78,bytes11:79,bytes12:80,bytes13:81,bytes14:82,bytes15:83,bytes16:84,bytes17:85,bytes18:86,bytes19:87,bytes20:88,bytes21:89,bytes22:90,bytes23:91,bytes24:92,bytes25:93,bytes26:94,bytes27:95,bytes28:96,bytes29:97,bytes30:98,bytes31:99,bytes32:100,bytes:101,string:102},h=i(i({},f),{tuple1:103,tuple2:104,tuple3:105,tuple4:106,tuple5:107,tuple6:108,tuple7:109,tuple8:110,tuple9:111,tuple10:112,tuple11:113,tuple12:114,tuple13:115,tuple14:116,tuple15:117,tuple16:118,tuple17:119});r.ETH_ABI_LATTICE_FW_TYPE_MAP=h;var d={SIGN_PERSONAL:{str:"signPersonal",enumIdx:0},TYPED_DATA:{str:"typedData",enumIdx:1,rawDataMaxLen:1629,typeCodes:f}};r.ethMsgProtocol=d,r.EXTERNAL={GET_ADDR_FLAGS:{SECP256K1_PUB:3,ED25519_PUB:4},SIGNING:{HASHES:{NONE:0,KECCAK256:1,SHA256:2},CURVES:{SECP256K1:0,ED25519:1},ENCODINGS:{NONE:1,SOLANA:2,TERRA:3,EVM:4}}},r.getFwVersionConst=function(e){var t={extraDataFrameSz:0,extraDataMaxFrames:0,genericSigning:{}};function n(e,t){return e[2]>t[0]||e[2]===t[0]&&e[1]>t[1]||e[2]===t[0]&&e[1]===t[1]&&e[0]>t[2]||e[2]===t[0]&&e[1]===t[1]&&e[0]===t[2]}var i=0===e.length;return!i&&n(e,[0,10,4])||!i&&n(e,[0,10,0])?(t.reqMaxDataSz=1678,t.ethMaxGasPrice=2e13,t.addrFlagsAllowed=!0):(t.reqMaxDataSz=1152,t.ethMaxGasPrice=5e11,t.addrFlagsAllowed=!1),t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.eip712MaxTypeParams=18,!i&&n(e,[0,10,4])&&(t.extraDataFrameSz=1500,t.extraDataMaxFrames=1),!i&&n(e,[0,10,5])&&(t.varAddrPathSzAllowed=!0,t.eip712Supported=!0),!i&&n(e,[0,10,8])&&(t.prehashAllowed=!0),!i&&n(e,[0,10,10])&&(t.ethMsgPreHashAllowed=!0),!i&&n(e,[0,11,0])&&(t.allowedEthTxTypes=[1,2],t.ethMaxDataSz-=10,t.ethMaxMsgSz=t.ethMaxDataSz),!i&&n(e,[0,11,2])&&(t.personalSignHeaderSz=72),!i&&n(e,[0,12,0])&&(t.kvActionsAllowed=!0,t.kvKeyMaxStrSz=63,t.kvValMaxStrSz=63,t.kvActionMaxNum=10,t.kvRemoveMaxNum=100),!i&&n(e,[0,13,0])&&(t.allowBtcLegacyAndSegwitAddrs=!0,t.contractDeployKey="0x08002e0fec8e6acf00835f43c9764f7364fa3f42"),!i&&n(e,[0,14,0])&&(t.abiCategorySz=32,t.abiMaxRmv=200,t.genericSigning.baseReqSz=1552,t.genericSigning.baseDataSz=1519,t.genericSigning.hashTypes=r.EXTERNAL.SIGNING.HASHES,t.genericSigning.curveTypes=r.EXTERNAL.SIGNING.CURVES,t.genericSigning.encodingTypes={NONE:r.EXTERNAL.SIGNING.ENCODINGS.NONE,SOLANA:r.EXTERNAL.SIGNING.ENCODINGS.SOLANA},t.getAddressFlags=[r.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB,r.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB],t.eip712MaxTypeParams=36),!i&&n(e,[0,14,1])&&(t.genericSigning.encodingTypes.TERRA=r.EXTERNAL.SIGNING.ENCODINGS.TERRA),!i&&n(e,[0,15,0])&&(t.genericSigning.encodingTypes.EVM=r.EXTERNAL.SIGNING.ENCODINGS.EVM,t.ethMaxDataSz=1519,t.maxDecoderBufSz=1600,t.genericSigning.calldataDecoding={reserved:2895728,maxSz:1024}),t};r.ASCII_REGEX=/^[\x00-\x7F]+$/}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4241,{"./constants":4240,"./util":4244,"@ethereumjs/common":405,"@ethereumjs/tx":409,"bignumber.js":4246,borc:1959,buffer:1996,"eth-eip712-util-browser":2279,"js-sha3":4633,rlp:4247,secp256k1:5671},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=s(e("@ethereumjs/common")),c=e("@ethereumjs/tx"),u=a(e("bignumber.js")),l=a(e("borc")),f=e("eth-eip712-util-browser"),h=e("js-sha3"),d=e("rlp"),p=a(e("secp256k1")),g=e("./constants"),m=e("./util");function _(e){for(var t=e[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}function b(e,r,n,i){void 0===i&&(i={});try{var s=new Uint8Array(e),a=0,o=(0,m.fixLen)(r.r,32);r.r=o;var c=(0,m.fixLen)(r.s,32);r.s=c;var u=new Uint8Array(t.concat([o,c])),l=p.default.ecdsaRecover(u,a,s,!1).slice(1);if(y(l)===n.toString("hex"))return r.v=v(a,i),r;if(a=1,y(l=p.default.ecdsaRecover(u,a,s,!1).slice(1))===n.toString("hex"))return r.v=v(a,i),r;throw new Error("Invalid Ethereum signature returned.")}catch(e){throw new Error(e)}}function y(e){return(0,h.keccak256)(e).slice(-40)}function v(e,r){void 0===r&&(r={});var n=r.chainId,i=r.useEIP155,s=r.type;if(1===s||2===s)return(0,m.ensureHexBuffer)(e,!0);if(!1===i||null===n)return t.from(new u.default(e).plus(27).toString(16),"hex");var a=E(n),o=new u.default(a.toString("hex"),16);return(0,m.ensureHexBuffer)("0x".concat(o.times(2).plus(35).plus(e).toString(16)))}var w={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function E(e){var r,n;if((r=!0===k(e)?(0,m.ensureHexBuffer)(e):(0,m.ensureHexBuffer)("0x".concat(new u.default(e).toString(16)))).length>8)throw new Error("ChainID provided is too large.");return r.length<=2||4===r.length||8===r.length?r:(3===r.length?(n=t.alloc(4)).writeUInt32BE(e):r.length<=8&&(n=t.alloc(8),r.copy(n,8-r.length)),n)}function k(e){if("string"!=typeof e)return!1;if("0x"!==e.slice(0,2))return!1;try{return!1===new u.default(e,16).isNaN()}catch(e){return!1}}function S(e,r){var n=r.fwConstants,i=n.ethMaxMsgSz,s=n.extraDataFrameSz,a=n.extraDataMaxFrames,o=i,c=s>0&&a>0,u=[];if(e.length>o){var l=o+a*s;if(!c)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(o));if(c&&e.length>l)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(l));(0,m.splitFrames)(e.slice(o),s).forEach((function(e){var r=t.alloc(4);r.writeUInt32LE(e.length,0),u.push(t.concat([r,e]))}))}return u}function T(e,t,r,n){void 0===n&&(n=!1);try{r[t].forEach((function(t){var i=t.type.indexOf("[")>-1,s=i?t.type.slice(0,t.type.indexOf("[")):t.type,a=Object.keys(r).indexOf(s)>-1;if(a&&Array.isArray(e))for(var o=0;o<e.length;o++)e[o][t.name]=T(e[o][t.name],s,r,n);else if(a)e[t.name]=T(e[t.name],s,r,n);else if(Array.isArray(e))for(o=0;o<e.length;o++)if(i)for(var c=0;c<e[o][t.name].length;c++)e[o][t.name][c]=A(e[o][t.name][c],s,n);else e[o][t.name]=A(e[o][t.name],s,n);else if(i)for(o=0;o<e[t.name].length;o++)e[t.name][o]=A(e[t.name][o],s,n);else e[t.name]=A(e[t.name],s,n)}))}catch(e){throw new Error(e.message)}return e}function A(e,r,n){if(void 0===n&&(n=!1),"bytes"===r)e=(0,m.ensureHexBuffer)(e),n&&(e="0x".concat(e.toString("hex")));else if("bytes"===r.slice(0,5)){var i=parseInt(r.slice(5));if((e=(0,m.ensureHexBuffer)(e)).length!==i)throw new Error("Expected ".concat(r," type, but got ").concat(e.length," bytes"));n&&(e="0x".concat(e.toString("hex")))}else if("address"===r){if(0===(e=(0,m.ensureHexBuffer)(e)).length&&(e=t.alloc(20)),20!==e.length)throw new Error("Address type must be 20 bytes, but got ".concat(e.length," bytes"));n&&(e="0x".concat(e.toString("hex")))}else if(g.ethMsgProtocol.TYPED_DATA.typeCodes[r]&&(r.indexOf("uint")>-1||r.indexOf("int")>-1)){var s=(0,m.ensureHexBuffer)(e);0===s.length&&(s=t.from("00","hex")),e=n?"0x".concat(s.toString("hex")):(new l.default.Encoder).semanticTypes[1][0](s.toString("hex"),16)}else"bool"===r&&(e=!0===e?1:0);return e}function x(e){return t.from("Ethereum Signed Message:\n".concat(e.toString()),"utf-8")}function P(e,r){return r?t.concat([t.from([r]),(0,d.encode)(e)]):(0,d.encode)(e)}r.default={buildEthereumMsgRequest:function(e){if(!e.payload||!e.protocol||!e.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");if(e.signerPath.length>5||e.signerPath.length<2)throw new Error("Please provide a signer path with 2-5 indices");var r={schema:g.signingSchema.ETH_MSG,payload:null,input:e,msg:null};try{switch(e.protocol){case"signPersonal":return function(e,r){var n=r.fwConstants.ethMaxMsgSz,i=r.fwConstants.varAddrPathSzAllowed,s=24+n+4,a=0;e.payload=t.alloc(s),e.payload.writeUInt8(g.ethMsgProtocol.SIGN_PERSONAL,0),a+=1;var o=(0,m.buildSignerPathBuf)(r.signerPath,i);o.copy(e.payload,a),a+=o.length;var c=r.payload,u=!1;if("string"==typeof r.payload)if("0x"===r.payload.slice(0,2))c=(0,m.ensureHexBuffer)(r.payload),u=!1===g.ASCII_REGEX.test(t.from(r.payload.slice(2),"hex").toString());else{if(!1===(0,m.isAsciiStr)(r.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");c=t.from(r.payload)}else if("boolean"==typeof r.displayHex)u=r.displayHex;else{if(!r.payload.toString)throw new Error("Unsupported input data type");u=!1===g.ASCII_REGEX.test(r.payload.toString())}var l=r.fwConstants,f=n+l.extraDataMaxFrames*l.extraDataFrameSz;l.personalSignHeaderSz&&(f-=l.personalSignHeaderSz);if(l.ethMsgPreHashAllowed&&c.length>f){e.payload.writeUInt8(u,a),a+=1,e.payload.writeUInt16LE(c.length,a),a+=2;var d=t.from((0,h.keccak256)(t.concat([x(c.length),c])),"hex");d.copy(e.payload,a),e.prehash=d}else{var p=S(c,r);e.extraDataPayloads=p,e.msg=c,e.payload.writeUInt8(u,a),a+=1,e.payload.writeUInt16LE(c.length,a),a+=2,c.copy(e.payload,a)}return e}(r,e);case"eip712":if(!e.fwConstants.eip712Supported)throw new Error("EIP712 is not supported by your Lattice firmware version. Please upgrade.");return function(e,r){try{var n=r.fwConstants,i=n.ethMaxMsgSz,s=n.varAddrPathSzAllowed,a=n.eip712MaxTypeParams,o=g.ethMsgProtocol.TYPED_DATA,c=24+i+4,u=0;e.payload=t.alloc(c),e.payload.writeUInt8(o.enumIdx,0),u+=1;var h=(0,m.buildSignerPathBuf)(r.signerPath,s);h.copy(e.payload,u),u+=h.length;var d=JSON.parse(JSON.stringify(r.payload));if(!d.primaryType||!d.types[d.primaryType])throw new Error("primaryType must be specified and the type must be included.");if(!d.message||!d.domain)throw new Error("message and domain must be specified.");if(0>Object.keys(d.types).indexOf("EIP712Domain"))throw new Error("EIP712Domain type must be defined.");r.payload.message=T(JSON.parse(JSON.stringify(d.message)),JSON.parse(JSON.stringify(d.primaryType)),JSON.parse(JSON.stringify(d.types)),!0),r.payload.domain=T(JSON.parse(JSON.stringify(d.domain)),"EIP712Domain",JSON.parse(JSON.stringify(d.types)),!0),d.domain=T(d.domain,"EIP712Domain",d.types,!1),d.message=T(d.message,d.primaryType,d.types,!1);var p=t.from(l.default.encode(d)),_=r.fwConstants,b=i+_.extraDataMaxFrames*_.extraDataFrameSz,y=p.length>b;if(Object.keys(d.types).forEach((function(e){d.types[e].length>a&&(y=!0)})),_.ethMsgPreHashAllowed&&y){e.payload.writeUInt16LE(p.length,u),u+=2;var v=f.TypedDataUtils.hash(e.input.payload);v.copy(e.payload,u),e.prehash=v}else{var w=S(p,r);e.extraDataPayloads=w,e.payload.writeUInt16LE(p.length,u),u+=2,p.copy(e.payload,u),u+=p.length,e.payload=e.payload.slice(0,u)}return e}catch(e){return{err:"Failed to build EIP712 request: ".concat(e.message)}}}(r,e);default:throw new Error("Unsupported protocol")}}catch(e){return{err:e.toString()}}},validateEthereumMsgResponse:function(e,r){var n=e.signer,i=e.sig,s=r.input,a=r.msg,o=r.prehash,c=void 0===o?null:o;if("signPersonal"===s.protocol)return b(c||t.from((0,h.keccak256)(t.concat([x(a.length),a])),"hex"),i,n,{chainId:1,useEIP155:!1});if("eip712"===s.protocol){var u=f.TypedDataUtils.hash(r.input.payload);return b(c||u,i,n,{useEIP155:!1})}throw new Error("Unsupported protocol")},buildEthereumTxRequest:function(e){try{var r=e.chainId,n=void 0===r?1:r,i=e.signerPath,s=e.eip155,a=void 0===s?null:s,o=e.fwConstants,c=e.type,u=void 0===c?null:c,l=o.contractDeployKey,f=o.extraDataFrameSz,d=o.extraDataMaxFrames,p=o.prehashAllowed,_=f>0&&d>0,b=o.ethMaxDataSz,y=o.varAddrPathSzAllowed;if("number"!=typeof n&&!1===k(n)&&(n=w[n]),!n)throw new Error("Unsupported chain ID or name");if(!i)throw new Error("`signerPath` not provided");if(null===e.to&&!l)throw new Error("Contract deployment not supported. Please update your Lattice firmware.");var v=null===e.to&&l,S=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(2)>-1,T=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(1)>-1,A=S&&(2===u||"eip1559"===u),x=T&&(1===u||"eip2930"===u);if(null!==u&&!A&&!x)throw new Error("Unsupported Ethereum transaction type");var I=function(e){switch(e){case 3:case 4:return!1;default:return!0}}(n);null!==a&&"boolean"==typeof a?I=a:(A||x)&&(I=!1),e.value||(e.value=0);var N=[],C=(0,m.ensureHexBuffer)(n),R=(0,m.ensureHexBuffer)(e.nonce),O=void 0,L=(0,m.ensureHexBuffer)(e.gasLimit),D=void 0,B=void 0;v?(D=t.alloc(0),B=(0,m.ensureHexBuffer)(l)):(D=(0,m.ensureHexBuffer)(e.to),B=(0,m.ensureHexBuffer)(e.to));var M=(0,m.ensureHexBuffer)(e.value),U=(0,m.ensureHexBuffer)(e.data);(A||x)&&N.push(C),N.push(R);var F=void 0,G=void 0;if(A){if(!e.maxPriorityFeePerGas)throw new Error("EIP1559 transactions must include `maxPriorityFeePerGas`");F=(0,m.ensureHexBuffer)(e.maxPriorityFeePerGas),N.push(F),G=(0,m.ensureHexBuffer)(e.maxFeePerGas),N.push(G),O=G}else O=(0,m.ensureHexBuffer)(e.gasPrice),N.push(O);N.push(L),N.push(D),N.push(M),N.push(U);var j=!1;if(A||x){var V=[];Array.isArray(e.accessList)&&e.accessList.forEach((function(e){var t=[];e.storageKeys.forEach((function(e){t.push((0,m.ensureHexBuffer)(e))})),V.push([(0,m.ensureHexBuffer)(e.address),t]),j=!0})),N.push(V)}else!0===I&&(N.push(C),N.push((0,m.ensureHexBuffer)(null)),N.push((0,m.ensureHexBuffer)(null)));var K=t.alloc(b+122),z=0;K.writeUInt8(Number(I),z),z++;var H=void 0,q=0;if(!0==(1!==(re=E(n)).length||255===re.readUInt8(0))){if((q=(H=E(n)).length)>g.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");K.writeUInt8(g.HANDLE_LARGER_CHAIN_ID,z),z++}else{if(1!==(H=(0,m.ensureHexBuffer)(n)).length)throw new Error("Error parsing chainID");H.copy(K,z),z+=H.length}var Y=(0,m.buildSignerPathBuf)(i,y);if(Y.copy(K,z),z+=Y.length,R.length>4)throw new Error("Nonce too large");if(R.copy(K,z+(4-R.length)),z+=4,O.length>8)throw new Error("Gas price too large");if(O.copy(K,z+(8-O.length)),z+=8,L.length>4)throw new Error("Gas limit too large");if(L.copy(K,z+(4-L.length)),z+=4,20!==B.length)throw new Error("Invalid `to` address");if(B.copy(K,z),z+=20,M.length>32)throw new Error("Value too large");M.copy(K,z+(32-M.length)),z+=32;var W=!1;if(o.allowedEthTxTypes)if(j&&(W=!0),K.writeUInt8(W?1:0,z),z+=1,A){if(K.writeUInt8(2,z),z+=1,F.length>8)throw new Error("maxPriorityFeePerGasBytes too large");F.copy(K,z+(8-F.length)),z+=8}else x?(K.writeUInt8(1,z),z+=1,z+=8):z+=9;var Z=[],$=null,J=U.length||0,Q=q>0?q+1:0,X=t.alloc(J+Q);if(Q>0&&(X.writeUInt8(q,0),H.copy(X,1)),U.copy(X,Q),J>b){var ee=J+Q,te=b+d*f;if(p&&ee>te)$=t.from((0,h.keccak256)(P(N,u)),"hex");else{if(!_||_&&ee>te)throw new Error("Data field too large (got ".concat(U.length,"; must be <=").concat(te-Q," bytes)"));(0,m.splitFrames)(X.slice(b),f).forEach((function(e){var r=t.alloc(4);r.writeUInt32LE(e.length,0),Z.push(t.concat([r,e]))}))}}else W&&($=t.from((0,h.keccak256)(P(N,u)),"hex"));return K.writeUInt16BE(U.length,z),z+=2,q>0&&(K.writeUInt8(q,z),z++,H.copy(K,z),z+=q),$?($.copy(K,z),z+=b):(U.slice(0,b).copy(K,z),z+=b),{rawTx:N,type:u,payload:K.slice(0,z),extraDataPayloads:Z,schema:g.signingSchema.ETH_TRANSFER,chainId:n,useEIP155:I,signerPath:i}}catch(e){return{err:e.message}}var re},buildEthRawTx:function(e,r,n){var i=b(t.from((0,h.keccak256)(P(e.rawTx,e.type)),"hex"),r,n,e),s=e.useEIP155?e.rawTx.slice(0,-3):e.rawTx;s.push(i.v),s.push(_(i.r)),s.push(_(i.s));var a=(0,d.encode)(s);return e.type&&(a=t.concat([t.from([e.type]),a])),{rawTx:t.from(a).toString("hex"),sigWithV:i}},hashTransaction:function(e){return(0,h.keccak256)(t.from(e,"hex"))},chainIds:w,ensureHexBuffer:m.ensureHexBuffer,ethConvertLegacyToGenericReq:function(e){var r;r=e.chainId&&"01"!==(0,m.ensureHexBuffer)(e.chainId).toString("hex")?o.default.custom({chainId:e.chainId},{hardfork:o.Hardfork.London,eips:[1559,2930]}):new o.default({chain:o.Chain.Mainnet,hardfork:o.Hardfork.London});var n=c.TransactionFactory.fromTxData(e,{common:r});return e.type?n.getMessageToSign(!1):t.from((0,d.encode)(n.getMessageToSign(!1)))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4242,{"./constants":4240,"./index":4243,"./util":4244,buffer:1996,"hash.js/lib/hash/sha":4282,"js-sha3":4633},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.getEncodedPayload=r.parseGenericSigningResponse=r.buildGenericSigningMsgRequest=void 0;var n=e("hash.js/lib/hash/sha"),i=e("js-sha3"),s=e("./constants"),a=e("./index"),o=e("./util");r.buildGenericSigningMsgRequest=function(e){var a=e.signerPath,c=e.curveType,u=e.hashType,l=e.encodingType,f=void 0===l?null:l,h=e.decoder,d=void 0===h?null:h,p=e.omitPubkey,g=void 0!==p&&p,m=e.fwConstants,_=m.extraDataFrameSz,b=m.extraDataMaxFrames,y=m.prehashAllowed,v=m.genericSigning,w=m.varAddrPathSzAllowed,E=v.curveTypes,k=v.encodingTypes,S=v.hashTypes,T=v.baseDataSz,A=v.baseReqSz,x=v.calldataDecoding,P=(0,r.getEncodedPayload)(e.payload,f,k),I=P.encoding,N=P.payloadBuf,C=N.length,R=T+b*_;if(!C)throw new Error("Payload could not be handled.");if(!(v&&_&&b&&y))throw new Error("Unsupported. Please update your Lattice firmware.");if(!(0,o.existsIn)(c,E))throw new Error("Unsupported curve type.");if(!(0,o.existsIn)(u,S))throw new Error("Unsupported hash type.");var O=d&&x&&d.length<=x.maxSz,L=O&&N.length+d.length<=R;if(O&&L){var D=t.alloc(8+d.length);D.writeUInt32LE(x.reserved,0),D.writeUInt32LE(d.length,4),t.from(d).copy(D,8),N=t.concat([N,D])}if(c===E.ED25519){if(u!==S.NONE)throw new Error("Signing on ed25519 requires unhashed message");a.forEach((function(e){if(e<s.HARDENED_OFFSET)throw new Error("Signing on ed25519 requires all signer path indices be hardened.")}))}var B=t.alloc(A),M=0;B.writeUInt32LE(I,M),M+=4,B.writeUInt8(u,M),M+=1,B.writeUInt8(c,M),M+=1;var U=(0,o.buildSignerPathBuf)(a,w);U.copy(B,M),M+=U.length,B.writeUInt8(g?1:0,M),M+=1;var F=[],G=null,j=!1;if(N.length>T)if(y&&N.length>R){B.writeUInt16LE(N.length,M),M+=2,j=!0;var V=N.slice(0,C);if(u===S.NONE)throw new Error("Message too large to send and could not be prehashed (hashType=NONE).");if(u===S.KECCAK256)G=t.from((0,i.keccak256)(V),"hex");else{if(u!==S.SHA256)throw new Error("Unsupported hash type.");G=t.from((0,n.sha256)().update(V).digest("hex"),"hex")}}else{(0,o.splitFrames)(N.slice(T),_).forEach((function(e){var r=t.alloc(4);r.writeUInt32LE(e.length,0),F.push(t.concat([r,e]))}))}return j||(B.writeUInt16LE(C,M),M+=2),(G||N).copy(B,M),{payload:B,extraDataPayloads:F,schema:s.signingSchema.GENERAL_SIGNING,curveType:c,omitPubkey:g}};r.parseGenericSigningResponse=function(e,r,n,i){var s={pubkey:null,sig:null};if(n===a.Constants.SIGNING.CURVES.SECP256K1){if(i)r+=65;else{var c=e.readUInt8(r);if(r+=1,2===c||3===c)s.pubkey=t.alloc(33),s.pubkey.writeUInt8(c,0),e.slice(r,r+32).copy(s.pubkey,1);else{if(4!==c)throw new Error("Bad compression byte in signing response.");s.pubkey=t.alloc(65),s.pubkey.writeUInt8(c,0),e.slice(r).copy(s.pubkey,1)}r+=64}s.sig=(0,o.parseDER)(e.slice(r,r+2+e[r+1])),s.sig.r=(0,o.fixLen)(s.sig.r,32),s.sig.s=(0,o.fixLen)(s.sig.s,32)}else{if(n!==a.Constants.SIGNING.CURVES.ED25519)throw new Error("Unsupported curve.");i||(s.pubkey=t.alloc(32),e.slice(r,r+32).copy(s.pubkey)),r+=32,s.sig={r:e.slice(r,r+32),s:e.slice(r+32,r+64)}}return s};r.getEncodedPayload=function(e,r,n){if(r||(r=a.Constants.SIGNING.ENCODINGS.NONE),!(0,o.existsIn)(r,n))throw new Error("Encoding not supported by Lattice firmware. You may want to update.");return{payloadBuf:"string"==typeof e&&"0x"===e.slice(0,2)?t.from(e.slice(2),"hex"):t.from(e),encoding:r}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4243,{"./calldata/index":4238,"./client":4239,"./constants":4240,"./util":4244},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Utils=r.Constants=r.Client=r.Calldata=void 0;var n=e("./calldata/index");Object.defineProperty(r,"Calldata",{enumerable:!0,get:function(){return n.CALLDATA}});var i=e("./client");Object.defineProperty(r,"Client",{enumerable:!0,get:function(){return i.Client}});var s=e("./constants");Object.defineProperty(r,"Constants",{enumerable:!0,get:function(){return s.EXTERNAL}});var a=e("./util");Object.defineProperty(r,"Utils",{enumerable:!0,get:function(){return a.EXTERNAL}})}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4244,{"./constants":4240,"@ethereumjs/tx":409,"aes-js":1590,"bignumber.js":4246,"bn.js":1952,buffer:1996,"crc-32":2070,elliptic:2230,"hash.js/lib/hash/sha":4282,"lodash/inRange":5071,"lodash/isInteger":5080,secp256k1:5671},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.EXTERNAL=r.getV=r.generateAppSecret=r.isUInt4=r.randomBytes=r.promisifyCb=r.existsIn=r.isAsciiStr=r.buildSignerPathBuf=r.getP256KeyPairFromPub=r.getP256KeyPair=r.parseDER=r.aes256_decrypt=r.aes256_encrypt=r.fixLen=r.ensureHexBuffer=r.splitFrames=r.isValidAssetPath=r.toPaddedDER=r.checksum=r.parseLattice1Response=void 0;var s,a=e("@ethereumjs/tx"),o=i(e("aes-js")),c=e("bn.js"),u=i(e("bignumber.js")),l=i(e("crc-32")),f=i(e("elliptic")),h=e("hash.js/lib/hash/sha"),d=e("secp256k1"),p=e("./constants"),g=p.BIP_CONSTANTS.COINS,m=p.BIP_CONSTANTS.PURPOSES,_=f.default.ec,b=i(e("lodash/isInteger")),y=i(e("lodash/inRange"));r.parseLattice1Response=function(e){var n={err:null,data:null},i=t.from(e,"hex"),s=0,a=i.readUInt8(s);if(s++,a!==p.VERSION_BYTE)return n.err="Incorrect protocol version. Please update your SDK",n;var o=i.readUInt8(s);if(s++,0!==o)return n.err="Incorrect response from Lattice1",n;i.readUInt32BE(s),s+=4;var c=i.readUInt16BE(s);s+=2;var u=i.slice(s,s+c);s+=c;var l=u.readUInt8(0);return l!==p.responseCodes.RESP_SUCCESS?(n.err="".concat(p.responseMsgs[l]?p.responseMsgs[l]:"Unknown Error"," (Lattice)"),n.responseCode=l,n):(n.data=u.slice(1,u.length),i.readUInt32BE(s)!==(0,r.checksum)(i.slice(0,i.length-4))?(n.err="Invalid checksum from device response",n.data=null,n):n)};r.checksum=function(e){return l.default.buf(e)>>>0};r.toPaddedDER=function(e){var r=t.alloc(74);return t.from(e.toDER()).copy(r),r};r.isValidAssetPath=function(e,t){var r=[m.ETH,m.BTC_LEGACY,m.BTC_WRAPPED_SEGWIT,m.BTC_SEGWIT],n=[g.ETH,g.BTC,g.BTC_TESTNET];return!((e[1]===g.BTC||e[1]===g.BTC_TESTNET)&&e[0]!==m.BTC_WRAPPED_SEGWIT&&!t.allowBtcLegacyAndSegwitAddrs)&&(r.indexOf(e[0])>=0&&(n.indexOf(e[1])>=0||[60,61,966,700,9006,9e3,1007,553,178,137,37310,108,40,889,1987,820,6060,1620,1313114,76,246529,246785,1001,227,916,464,2221,344,73799,246].indexOf(e[1]-p.HARDENED_OFFSET)>0))};r.splitFrames=function(e,t){for(var r=[],n=Math.ceil(e.length/t),i=0,s=0;s<n;s++)r.push(e.slice(i,i+t)),i+=t;return r};r.ensureHexBuffer=function(e,r){void 0===r&&(r=!0);try{if(null===e||0===e&&!0===r)return t.alloc(0);var n="number"==typeof e||function(e){var t=new u.default(e).toString().split(".").join(""),r=new String(e);return t.slice(0,8)===r.slice(0,8)}(e);return(e=n?"".concat(new u.default(e).toString(16)):"string"==typeof e&&"0x"===e.slice(0,2)?e.slice(2):e.toString("hex")).length%2>0&&(e="0".concat(e)),"00"!==e||n?t.from(e,"hex"):t.alloc(0)}catch(t){throw new Error("Cannot convert ".concat(e.toString()," to hex buffer (").concat(t.toString(),")"))}};r.fixLen=function(e,r){var n=t.alloc(r);return e.length<r?(e.copy(n,r-e.length),n):e.slice(-r)};r.aes256_encrypt=function(e,r){var n=t.from(p.AES_IV),i=new o.default.ModeOfOperation.cbc(r,n),s=e.length%16==0?e:o.default.padding.pkcs7.pad(e);return t.from(i.encrypt(s))};r.aes256_decrypt=function(e,r){var n=t.from(p.AES_IV),i=new o.default.ModeOfOperation.cbc(r,n);return t.from(i.decrypt(e))};r.parseDER=function(e){if(48!==e[0]||2!==e[2])return null;var t=3,r={r:null,s:null},n=e[t];if(t++,r.r=e.slice(t,t+n),2!==e[t+=n])return null;var i=e[++t];return t++,r.s=e.slice(t,t+i),r};r.getP256KeyPair=function(e){return s===undefined&&(s=new _("p256")),s.keyFromPrivate(e,"hex")};r.getP256KeyPairFromPub=function(e){return s===undefined&&(s=new _("p256")),s.keyFromPublic(e,"hex")};r.buildSignerPathBuf=function(e,r){var n=t.alloc(24),i=0;if(r&&e.length>5)throw new Error("Signer path must be <=5 indices.");if(!r&&5!==e.length)throw new Error("Your Lattice firmware only supports 5-index derivation paths. Please upgrade.");n.writeUInt32LE(e.length,i),i+=4;for(var s=0;s<5;s++)s<e.length?n.writeUInt32LE(e[s],i):n.writeUInt32LE(0,i),i+=4;return n};r.isAsciiStr=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)return!1;for(var r=t?[32,10]:[],n=0;n<e.length;n++){var i=e.charCodeAt(n);if(r.indexOf(i)<0&&(i<32||i>127))return!1}return!0};r.existsIn=function(e,t){return Object.keys(t).some((function(r){return t[r]===e}))};r.promisifyCb=function(e,t,r){return function(i){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return r&&"function"==typeof r?r.apply(void 0,n([i],s,!1)):i&&"string"==typeof i?t(i):e.apply(void 0,s)}};r.randomBytes=function(e){for(var r=t.alloc(e),n=0;n<e;n++)r[n]=Math.round(255*Math.random());return r};r.isUInt4=function(e){return(0,b.default)(e)&&(0,y.default)(0,16)};r.generateAppSecret=function(e,r,n){var i=t.concat([e,r,n]);return t.from((0,h.sha256)().update(i).digest("hex"),"hex")};r.getV=function(e,r){var n,i=e.getMessageToSign(!0),s=new Uint8Array(t.concat([r.sig.r,r.sig.s])),o=new Uint8Array(r.pubkey),u=(0,d.ecdsaRecover)(s,0,i,!1),l=(0,d.ecdsaRecover)(s,1,i,!1),f=t.from(o).toString("hex"),h=t.from(u).toString("hex"),p=t.from(l).toString("hex");if(f===h)n=0;else{if(f!==p)return null;n=1}if(e._type)return new c.BN(n);var g=null;return e.common&&"function"==typeof e.common.chainIdBN?g=e.common.chainIdBN():e.chainId&&(g=new c.BN(e.chainId)),g&&e.supports(a.Capability.EIP155ReplayProtection)?g.muln(2).addn(35).addn(n):new c.BN(n).addn(27)},r.EXTERNAL={getV:r.getV,generateAppSecret:r.generateAppSecret}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4245,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.bech32m=r.bech32=void 0;const n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={};for(let e=0;e<n.length;e++){const t=n.charAt(e);i[t]=e}function s(e){const t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function a(e){let t=1;for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=s(t)^n>>5}t=s(t);for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);t=s(t)^31&n}return t}function o(e,t,r,n){let i=0,s=0;const a=(1<<r)-1,o=[];for(let n=0;n<e.length;++n)for(i=i<<t|e[n],s+=t;s>=r;)s-=r,o.push(i>>s&a);if(n)s>0&&o.push(i<<r-s&a);else{if(s>=t)return"Excess padding";if(i<<r-s&a)return"Non-zero padding"}return o}function c(e){return o(e,8,5,!0)}function u(e){const t=o(e,5,8,!1);if(Array.isArray(t))return t}function l(e){const t=o(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function f(e){let t;function r(e,r){if(r=r||90,e.length<8)return e+" too short";if(e.length>r)return"Exceeds length limit";const n=e.toLowerCase(),o=e.toUpperCase();if(e!==n&&e!==o)return"Mixed-case string "+e;const c=(e=n).lastIndexOf("1");if(-1===c)return"No separator character for "+e;if(0===c)return"Missing prefix for "+e;const u=e.slice(0,c),l=e.slice(c+1);if(l.length<6)return"Data too short";let f=a(u);if("string"==typeof f)return f;const h=[];for(let e=0;e<l.length;++e){const t=l.charAt(e),r=i[t];if(r===undefined)return"Unknown character "+t;f=s(f)^r,e+6>=l.length||h.push(r)}return f!==t?"Invalid checksum for "+e:{prefix:u,words:h}}return t="bech32"===e?1:734539939,{decodeUnsafe:function(e,t){const n=r(e,t);if("object"==typeof n)return n},decode:function(e,t){const n=r(e,t);if("object"==typeof n)return n;throw new Error(n)},encode:function(e,r,i){if(i=i||90,e.length+7+r.length>i)throw new TypeError("Exceeds length limit");let o=a(e=e.toLowerCase());if("string"==typeof o)throw new Error(o);let c=e+"1";for(let e=0;e<r.length;++e){const t=r[e];if(t>>5!=0)throw new Error("Non 5-bit word");o=s(o)^t,c+=n.charAt(t)}for(let e=0;e<6;++e)o=s(o);o^=t;for(let e=0;e<6;++e){c+=n.charAt(o>>5*(5-e)&31)}return c},toWords:c,fromWordsUnsafe:u,fromWords:l}}r.bech32=f("bech32"),r.bech32m=f("bech32m")}}},{package:"eth-lattice-keyring>gridplus-sdk>bech32"}],[4246,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(t=e[n++]+"",r=u-t.length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function m(e,t){var r,n,i=e.c,s=t.c,a=e.s,o=t.s,c=e.e,u=t.e;if(!a||!o)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-o:a;if(a!=o)return a;if(r=a<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(o=(c=i.length)<(u=s.length)?c:u,a=0;a<o;a++)if(i[a]!=s[a])return i[a]>s[a]^r?1:-1;return c==u?0:c>u^r?1:-1}function _(e,t,r,n){if(e<t||e>r||e!==s(e))throw Error(a+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function b(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}r=function e(t){var r,w,E,k,S,T,A,x,P,I,N=K.prototype={constructor:K,toString:null,valueOf:null},C=new K(1),R=20,O=4,L=-7,D=21,B=-1e7,M=1e7,U=!1,F=1,G=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},V="0123456789abcdefghijklmnopqrstuvwxyz";function K(e,t){var r,i,a,c,f,h,d,p,g=this;if(!(g instanceof K))return new K(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>M?g.c=g.e=null:e.e<B?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,f=e;f>=10;f/=10,c++);return void(c>M?g.c=g.e=null:(g.e=c,g.c=[e]))}p=String(e)}else{if(!n.test(p=String(e)))return E(g,p,h);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(f=p.search(/e/i))>0?(c<0&&(c=f),c+=+p.slice(f+1),p=p.substring(0,f)):c<0&&(c=p.length)}else{if(_(t,2,V.length,"Base"),10==t)return Y(g=new K(e),R+g.e+1,O);if(p=String(e),h="number"==typeof e){if(0*e!=0)return E(g,p,h,t);if(g.s=1/e<0?(p=p.slice(1),-1):1,K.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=V.slice(0,t),c=f=0,d=p.length;f<d;f++)if(r.indexOf(i=p.charAt(f))<0){if("."==i){if(f>c){c=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,c=0;continue}return E(g,String(e),h,t)}h=!1,(c=(p=w(p,t,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(f=0;48===p.charCodeAt(f);f++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(f,++d)){if(d-=f,h&&K.DEBUG&&d>15&&(e>l||e!==s(e)))throw Error(o+g.s*e);if((c=c-f-1)>M)g.c=g.e=null;else if(c<B)g.c=[g.e=0];else{if(g.e=c,g.c=[],f=(c+1)%u,c<0&&(f+=u),f<d){for(f&&g.c.push(+p.slice(0,f)),d-=u;f<d;)g.c.push(+p.slice(f,f+=u));f=u-(p=p.slice(f)).length}else f-=d;for(;f--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function z(e,t,r,n){var i,s,a,o,c;if(null==r?r=O:_(r,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)c=g(e.c),c=1==n||2==n&&(a<=L||a>=D)?y(c,a):v(c,a,"0");else if(s=(e=Y(new K(e),t,r)).e,o=(c=g(e.c)).length,1==n||2==n&&(t<=s||s<=L)){for(;o<t;c+="0",o++);c=y(c,s)}else if(t-=a,c=v(c,s,"0"),s+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-o)>0)for(s+1==o&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function H(e,t){for(var r,n=1,i=new K(e[0]);n<e.length;n++){if(!(r=new K(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function q(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*u-1)>M?e.c=e.e=null:r<B?e.c=[e.e=0]:(e.e=r,e.c=t),e}function Y(e,t,r,n){var a,o,l,h,d,p,g,m=e.c,_=f;if(m){e:{for(a=1,h=m[0];h>=10;h/=10,a++);if((o=t-a)<0)o+=u,l=t,g=(d=m[p=0])/_[a-l-1]%10|0;else if((p=i((o+1)/u))>=m.length){if(!n)break e;for(;m.length<=p;m.push(0));d=g=0,a=1,l=(o%=u)-u+1}else{for(d=h=m[p],a=1;h>=10;h/=10,a++);g=(l=(o%=u)-u+a)<0?0:d/_[a-l-1]%10|0}if(n=n||t<0||null!=m[p+1]||(l<0?d:d%_[a-l-1]),n=r<4?(g||n)&&(0==r||r==(e.s<0?3:2)):g>5||5==g&&(4==r||n||6==r&&(o>0?l>0?d/_[a-l]:0:m[p-1])%10&1||r==(e.s<0?8:7)),t<1||!m[0])return m.length=0,n?(t-=e.e+1,m[0]=_[(u-t%u)%u],e.e=-t||0):m[0]=e.e=0,e;if(0==o?(m.length=p,h=1,p--):(m.length=p+1,h=_[u-o],m[p]=l>0?s(d/_[a-l]%_[l])*h:0),n)for(;;){if(0==p){for(o=1,l=m[0];l>=10;l/=10,o++);for(l=m[0]+=h,h=1;l>=10;l/=10,h++);o!=h&&(e.e++,m[0]==c&&(m[0]=1));break}if(m[p]+=h,m[p]!=c)break;m[p--]=0,h=1}for(o=m.length;0===m[--o];m.pop());}e.e>M?e.c=e.e=null:e.e<B&&(e.c=[e.e=0])}return e}function W(e){var t,r=e.e;return null===r?e.toString():(t=g(e.c),t=r<=L||r>=D?y(t,r):v(t,r,"0"),e.s<0?"-"+t:t)}return K.clone=e,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(_(r=e[t],0,d,t),R=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(_(r=e[t],0,8,t),O=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(_(r[0],-d,0,t),_(r[1],0,d,t),L=r[0],D=r[1]):(_(r,-d,d,t),L=-(D=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)_(r[0],-d,-1,t),_(r[1],1,d,t),B=r[0],M=r[1];else{if(_(r,-d,d,t),!r)throw Error(a+t+" cannot be zero: "+r);B=-(M=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(a+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw U=!r,Error(a+"crypto unavailable");U=r}else U=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(_(r=e[t],0,9,t),F=r),e.hasOwnProperty(t="POW_PRECISION")&&(_(r=e[t],0,d,t),G=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(a+t+" not an object: "+r);j=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(a+t+" invalid: "+r);V=r}}return{DECIMAL_PLACES:R,ROUNDING_MODE:O,EXPONENTIAL_AT:[L,D],RANGE:[B,M],CRYPTO:U,MODULO_MODE:F,POW_PRECISION:G,FORMAT:j,ALPHABET:V}},K.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!K.DEBUG)return!0;var t,r,n=e.c,i=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===o||-1===o)&&i>=-d&&i<=d&&i===s(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%u)<1&&(t+=u),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=c||r!==s(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===o||1===o||-1===o))return!0;throw Error(a+"Invalid BigNumber: "+e)},K.maximum=K.max=function(){return H(arguments,N.lt)},K.minimum=K.min=function(){return H(arguments,N.gt)},K.random=(k=9007199254740992,S=Math.random()*k&2097151?function(){return s(Math.random()*k)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,o,c,l=0,h=[],p=new K(C);if(null==e?e=R:_(e,0,d),o=i(e/u),U)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));l<o;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[l]=r[0],t[l+1]=r[1]):(h.push(c%1e14),l+=2);l=o/2}else{if(!crypto.randomBytes)throw U=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(o*=7);l<o;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(h.push(c%1e14),l+=7);l=o/7}if(!U)for(;l<o;)(c=S())<9e15&&(h[l++]=c%1e14);for(o=h[--l],e%=u,o&&e&&(c=f[u-e],h[l]=s(o/c)*c);0===h[l];h.pop(),l--);if(l<0)h=[n=0];else{for(n=-1;0===h[0];h.splice(0,1),n-=u);for(l=1,c=h[0];c>=10;c/=10,l++);l<u&&(n-=u-l)}return p.e=n,p.c=h,p}),K.sum=function(){for(var e=1,t=arguments,r=new K(t[0]);e<t.length;)r=r.plus(t[e++]);return r},w=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,a=[0],o=0,c=e.length;o<c;){for(s=a.length;s--;a[s]*=t);for(a[0]+=n.indexOf(e.charAt(o++)),i=0;i<a.length;i++)a[i]>r-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/r|0,a[i]%=r)}return a.reverse()}return function(n,i,s,a,o){var c,u,l,f,h,d,p,m,_=n.indexOf("."),b=R,y=O;for(_>=0&&(f=G,G=0,n=n.replace(".",""),d=(m=new K(i)).pow(n.length-_),G=f,m.c=t(v(g(d.c),d.e,"0"),10,s,e),m.e=m.c.length),l=f=(p=t(n,i,s,o?(c=V,e):(c=e,V))).length;0==p[--f];p.pop());if(!p[0])return c.charAt(0);if(_<0?--l:(d.c=p,d.e=l,d.s=a,p=(d=r(d,m,b,y,s)).c,h=d.r,l=d.e),_=p[u=l+b+1],f=s/2,h=h||u<0||null!=p[u+1],h=y<4?(null!=_||h)&&(0==y||y==(d.s<0?3:2)):_>f||_==f&&(4==y||h||6==y&&1&p[u-1]||y==(d.s<0?8:7)),u<1||!p[0])n=h?v(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(p.length=u,h)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(f=p.length;!p[--f];);for(_=0,n="";_<=f;n+=c.charAt(p[_++]));n=v(n,l,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,s,a,o=0,c=e.length,u=t%h,l=t/h|0;for(e=e.slice();c--;)o=((i=u*(s=e[c]%h)+(n=l*s+(a=e[c]/h|0)*u)%h*h+o)/r|0)+(n/h|0)+l*a,e[c]=i%r;return o&&(e=[o].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,a,o,l){var f,h,d,g,m,_,b,y,v,w,E,k,S,T,A,x,P,I=n.s==i.s?1:-1,N=n.c,C=i.c;if(!(N&&N[0]&&C&&C[0]))return new K(n.s&&i.s&&(N?!C||N[0]!=C[0]:C)?N&&0==N[0]||!C?0*I:I/0:NaN);for(v=(y=new K(I)).c=[],I=a+(h=n.e-i.e)+1,l||(l=c,h=p(n.e/u)-p(i.e/u),I=I/u|0),d=0;C[d]==(N[d]||0);d++);if(C[d]>(N[d]||0)&&h--,I<0)v.push(1),g=!0;else{for(T=N.length,x=C.length,d=0,I+=2,(m=s(l/(C[0]+1)))>1&&(C=e(C,m,l),N=e(N,m,l),x=C.length,T=N.length),S=x,E=(w=N.slice(0,x)).length;E<x;w[E++]=0);P=C.slice(),P=[0].concat(P),A=C[0],C[1]>=l/2&&A++;do{if(m=0,(f=t(C,w,x,E))<0){if(k=w[0],x!=E&&(k=k*l+(w[1]||0)),(m=s(k/A))>1)for(m>=l&&(m=l-1),b=(_=e(C,m,l)).length,E=w.length;1==t(_,w,b,E);)m--,r(_,x<b?P:C,b,l),b=_.length,f=1;else 0==m&&(f=m=1),b=(_=C.slice()).length;if(b<E&&(_=[0].concat(_)),r(w,_,E,l),E=w.length,-1==f)for(;t(C,w,x,E)<1;)m++,r(w,x<E?P:C,E,l),E=w.length}else 0===f&&(m++,w=[0]);v[d++]=m,w[0]?w[E++]=N[S]||0:(w=[N[S]],E=1)}while((S++<T||null!=w[0])&&I--);g=null!=w[0],v[0]||v.splice(0,1)}if(l==c){for(d=1,I=v[0];I>=10;I/=10,d++);Y(y,a+(y.e=d+h*u-1)+1,o,g)}else y.e=h,y.r=+g;return y}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,x=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,E=function(e,t,r,n){var i,s=r?t:t.replace(I,"");if(P.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(T,(function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t})),n&&(i=n,s=s.replace(A,"$1").replace(x,"0.$1")),t!=s))return new K(s,i);if(K.DEBUG)throw Error(a+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},N.absoluteValue=N.abs=function(){var e=new K(this);return e.s<0&&(e.s=1),e},N.comparedTo=function(e,t){return m(this,new K(e,t))},N.decimalPlaces=N.dp=function(e,t){var r,n,i,s=this;if(null!=e)return _(e,0,d),null==t?t=O:_(t,0,8),Y(new K(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=((i=r.length-1)-p(this.e/u))*u,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},N.dividedBy=N.div=function(e,t){return r(this,new K(e,t),R,O)},N.dividedToIntegerBy=N.idiv=function(e,t){return r(this,new K(e,t),0,1)},N.exponentiatedBy=N.pow=function(e,t){var r,n,o,c,l,f,h,d,p=this;if((e=new K(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+W(e));if(null!=t&&(t=new K(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new K(Math.pow(+W(p),l?2-b(e):+W(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new K(NaN);(n=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&b(e)?-0:0,p.e>-1&&(c=1/c),new K(f?1/c:c);G&&(c=i(G/u+2))}for(l?(r=new K(.5),f&&(e.s=1),h=b(e)):h=(o=Math.abs(+W(e)))%2,d=new K(C);;){if(h){if(!(d=d.times(p)).c)break;c?d.c.length>c&&(d.c.length=c):n&&(d=d.mod(t))}if(o){if(0===(o=s(o/2)))break;h=o%2}else if(Y(e=e.times(r),e.e+1,1),e.e>14)h=b(e);else{if(0===(o=+W(e)))break;h=o%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):n&&(p=p.mod(t))}return n?d:(f&&(d=C.div(d)),t?d.mod(t):c?Y(d,G,O,undefined):d)},N.integerValue=function(e){var t=new K(this);return null==e?e=O:_(e,0,8),Y(t,t.e+1,e)},N.isEqualTo=N.eq=function(e,t){return 0===m(this,new K(e,t))},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(e,t){return m(this,new K(e,t))>0},N.isGreaterThanOrEqualTo=N.gte=function(e,t){return 1===(t=m(this,new K(e,t)))||0===t},N.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},N.isLessThan=N.lt=function(e,t){return m(this,new K(e,t))<0},N.isLessThanOrEqualTo=N.lte=function(e,t){return-1===(t=m(this,new K(e,t)))||0===t},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return this.s>0},N.isZero=function(){return!!this.c&&0==this.c[0]},N.minus=function(e,t){var r,n,i,s,a=this,o=a.s;if(t=(e=new K(e,t)).s,!o||!t)return new K(NaN);if(o!=t)return e.s=-t,a.plus(e);var l=a.e/u,f=e.e/u,h=a.c,d=e.c;if(!l||!f){if(!h||!d)return h?(e.s=-t,e):new K(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new K(h[0]?a:3==O?-0:0)}if(l=p(l),f=p(f),h=h.slice(),o=l-f){for((s=o<0)?(o=-o,i=h):(f=l,i=d),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(n=(s=(o=h.length)<(t=d.length))?o:t,o=t=0;t<n;t++)if(h[t]!=d[t]){s=h[t]<d[t];break}if(s&&(i=h,h=d,d=i,e.s=-e.s),(t=(n=d.length)-(r=h.length))>0)for(;t--;h[r++]=0);for(t=c-1;n>o;){if(h[--n]<d[n]){for(r=n;r&&!h[--r];h[r]=t);--h[r],h[n]+=c}h[n]-=d[n]}for(;0==h[0];h.splice(0,1),--f);return h[0]?q(e,h,f):(e.s=3==O?-1:1,e.c=[e.e=0],e)},N.modulo=N.mod=function(e,t){var n,i,s=this;return e=new K(e,t),!s.c||!e.s||e.c&&!e.c[0]?new K(NaN):!e.c||s.c&&!s.c[0]?new K(s):(9==F?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,F),(e=s.minus(n.times(e))).c[0]||1!=F||(e.s=s.s),e)},N.multipliedBy=N.times=function(e,t){var r,n,i,s,a,o,l,f,d,g,m,_,b,y,v,w=this,E=w.c,k=(e=new K(e,t)).c;if(!(E&&k&&E[0]&&k[0]))return!w.s||!e.s||E&&!E[0]&&!k||k&&!k[0]&&!E?e.c=e.e=e.s=null:(e.s*=w.s,E&&k?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=p(w.e/u)+p(e.e/u),e.s*=w.s,(l=E.length)<(g=k.length)&&(b=E,E=k,k=b,i=l,l=g,g=i),i=l+g,b=[];i--;b.push(0));for(y=c,v=h,i=g;--i>=0;){for(r=0,m=k[i]%v,_=k[i]/v|0,s=i+(a=l);s>i;)r=((f=m*(f=E[--a]%v)+(o=_*f+(d=E[a]/v|0)*m)%v*v+b[s]+r)/y|0)+(o/v|0)+_*d,b[s--]=f%y;b[s]=r}return r?++n:b.splice(0,1),q(e,b,n)},N.negated=function(){var e=new K(this);return e.s=-e.s||null,e},N.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new K(e,t)).s,!i||!t)return new K(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/u,a=e.e/u,o=n.c,l=e.c;if(!s||!a){if(!o||!l)return new K(i/0);if(!o[0]||!l[0])return l[0]?e:new K(o[0]?n:0*i)}if(s=p(s),a=p(a),o=o.slice(),i=s-a){for(i>0?(a=s,r=l):(i=-i,r=o),r.reverse();i--;r.push(0));r.reverse()}for((i=o.length)-(t=l.length)<0&&(r=l,l=o,o=r,t=i),i=0;t;)i=(o[--t]=o[t]+l[t]+i)/c|0,o[t]=c===o[t]?0:o[t]%c;return i&&(o=[i].concat(o),++a),q(e,o,a)},N.precision=N.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return _(e,1,d),null==t?t=O:_(t,0,8),Y(new K(s),e,t);if(!(r=s.c))return null;if(n=(i=r.length-1)*u+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},N.shiftedBy=function(e){return _(e,-9007199254740991,l),this.times("1e"+e)},N.squareRoot=N.sqrt=function(){var e,t,n,i,s,a=this,o=a.c,c=a.s,u=a.e,l=R+4,f=new K("0.5");if(1!==c||!o||!o[0])return new K(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(c=Math.sqrt(+W(a)))||c==1/0?(((t=g(o)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),n=new K(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):n=new K(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(s=n,n=f.times(s.plus(r(a,s,l,1))),g(s.c).slice(0,c)===(t=g(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Y(n,n.e+R+2,1),e=!n.times(n).eq(a));break}if(!i&&(Y(s,s.e+R+2,0),s.times(s).eq(a))){n=s;break}l+=4,c+=4,i=1}return Y(n,n.e+R+1,O,e)},N.toExponential=function(e,t){return null!=e&&(_(e,0,d),e++),z(this,e,t,1)},N.toFixed=function(e,t){return null!=e&&(_(e,0,d),e=e+this.e+1),z(this,e,t)},N.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=j;else if("object"!=typeof r)throw Error(a+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var s,o=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",f=o[0],h=o[1],d=i.s<0,p=d?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),d&&(f="-"+f)}n=h?f+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):f}return(r.prefix||"")+n+(r.suffix||"")},N.toFraction=function(e){var t,n,i,s,o,c,l,h,d,p,m,_,b=this,y=b.c;if(null!=e&&(!(l=new K(e)).isInteger()&&(l.c||1!==l.s)||l.lt(C)))throw Error(a+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+W(l));if(!y)return new K(b);for(t=new K(C),d=n=new K(C),i=h=new K(C),_=g(y),o=t.e=_.length-b.e-1,t.c[0]=f[(c=o%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?o>0?t:d:l,c=M,M=1/0,l=new K(_),h.c[0]=0;p=r(l,t,0,1),1!=(s=n.plus(p.times(i))).comparedTo(e);)n=i,i=s,d=h.plus(p.times(s=d)),h=s,t=l.minus(p.times(s=t)),l=s;return s=r(e.minus(n),i,0,1),h=h.plus(s.times(d)),n=n.plus(s.times(i)),h.s=d.s=b.s,m=r(d,i,o*=2,O).minus(b).abs().comparedTo(r(h,n,o,O).minus(b).abs())<1?[d,i]:[h,n],M=c,m},N.toNumber=function(){return+W(this)},N.toPrecision=function(e,t){return null!=e&&_(e,1,d),z(this,e,t,2)},N.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=L||i>=D?y(g(r.c),i):v(g(r.c),i,"0"):10===e?t=v(g((r=Y(new K(r),R+i+1,O)).c),r.e,"0"):(_(e,2,V.length,"Base"),t=w(v(g(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},N.valueOf=N.toJSON=function(){return W(this)},N._isBigNumber=!0,null!=t&&K.set(t),K}(),r.default=r.BigNumber=r,"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)}}},{package:"eth-lattice-keyring>gridplus-sdk>bignumber.js"}],[4247,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(n(e[r]));const r=d(...t);return d(a(r.length,192),r)}const t=_(e);return 1===t.length&&t[0]<128?t:d(a(t.length,128),t)}function i(e,t,r){if(r>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,r)}function s(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return f(l(e))}function a(e,t){if(e<56)return Uint8Array.from([e+t]);const r=g(e),n=g(t+55+r.length/2);return Uint8Array.from(h(n+r))}function o(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const r=c(_(e));if(t)return r;if(0!==r.remainder.length)throw new Error("invalid RLP: remainder must be zero");return r.data}function c(e){let t,r,n,a,o;const u=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(t=l-127,n=128===l?Uint8Array.from([]):i(e,1,t),2===t&&n[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:n,remainder:e.slice(t)}}if(l<=191){if(r=l-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=s(i(e,1,r)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return n=i(e,r,t+r),{data:n,remainder:e.slice(t+r)}}if(l<=247){for(t=l-191,a=i(e,1,t);a.length;)o=c(a),u.push(o.data),a=o.remainder;return{data:u,remainder:e.slice(t)}}{if(r=l-246,t=s(i(e,1,r)),t<56)throw new Error("invalid RLP: encoded list too short");const n=r+t;if(n>e.length)throw new Error("invalid RLP: total length is larger than the data");for(a=i(e,r,n);a.length;)o=c(a),u.push(o.data),a=o.remainder;return{data:u,remainder:e.slice(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.decode=r.encode=void 0,r.encode=n,r.decode=o;const u=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function l(e){let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t}function f(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r;t[r]=f(e.slice(n,n+2))}return t}function d(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}function p(e){return(new TextEncoder).encode(e)}function g(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function m(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function _(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return m(e)?h((t="string"!=typeof(r=e)?r:m(r)?r.slice(2):r).length%2?`0${t}`:t):p(e);var t,r;if("number"==typeof e||"bigint"==typeof e)return e?h(g(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}r.utils={bytesToHex:l,concatBytes:d,hexToBytes:h,utf8ToBytes:p};const b={encode:n,decode:o};r.default=b}}},{package:"eth-lattice-keyring>gridplus-sdk>rlp"}],[4249,{"is-deflate":4605,"is-gzip":4608,"peek-stream":5328,pumpify:4265,through2:4266,zlib:4251},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("zlib"),i=e("peek-stream"),s=e("through2"),a=e("pumpify"),o=e("is-gzip"),c=e("is-deflate"),u=function(e){return e===undefined&&(e=3),i({newline:!1,maxBuffer:10},(function(t,r){if(e<0)return r(new Error("Maximum recursion reached"));switch(function(e){return o(e)?1:c(e)?2:0}(t)){case 1:r(null,a(n.createGunzip(),u(e-1)));break;case 2:r(null,a(n.createInflate(),u(e-1)));break;default:r(null,s())}}))};t.exports=u}}},{package:"@metamask/snap-controllers>gunzip-maybe"}],[4250,{_process:5342,buffer:1996,"pako/lib/zlib/constants":4255,"pako/lib/zlib/deflate.js":4257,"pako/lib/zlib/inflate.js":4259,"pako/lib/zlib/messages":4261,"pako/lib/zlib/zstream":4263},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){var i=e("pako/lib/zlib/messages"),s=e("pako/lib/zlib/zstream"),a=e("pako/lib/zlib/deflate.js"),o=e("pako/lib/zlib/inflate.js"),c=e("pako/lib/zlib/constants");for(var u in c)r[u]=c[u];function l(e){if(e<r.DEFLATE||e>r.UNZIP)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function f(e,t){for(var r=0;r<e.length;r++)this[t+r]=e[r]}r.NONE=0,r.DEFLATE=1,r.INFLATE=2,r.GZIP=3,r.GUNZIP=4,r.DEFLATERAW=5,r.INFLATERAW=6,r.UNZIP=7,l.prototype.init=function(e,t,n,i,c){switch(this.windowBits=e,this.level=t,this.memLevel=n,this.strategy=i,this.mode!==r.GZIP&&this.mode!==r.GUNZIP||(this.windowBits+=16),this.mode===r.UNZIP&&(this.windowBits+=32),this.mode!==r.DEFLATERAW&&this.mode!==r.INFLATERAW||(this.windowBits=-this.windowBits),this.strm=new s,this.mode){case r.DEFLATE:case r.GZIP:case r.DEFLATERAW:var u=a.deflateInit2(this.strm,this.level,r.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case r.INFLATE:case r.GUNZIP:case r.INFLATERAW:case r.UNZIP:u=o.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}u===r.Z_OK?(this.write_in_progress=!1,this.init_done=!0):this._error(u)},l.prototype.params=function(){throw new Error("deflateParams Not supported")},l.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===r.NONE)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},l.prototype.write=function(e,r,n,i,s,a,o){this._writeCheck(),this.write_in_progress=!0;var c=this;return t.nextTick((function(){c.write_in_progress=!1;var t=c._write(e,r,n,i,s,a,o);c.callback(t[0],t[1]),c.pending_close&&c.close()})),this},l.prototype.writeSync=function(e,t,r,n,i,s,a){return this._writeCheck(),this._write(e,t,r,n,i,s,a)},l.prototype._write=function(e,t,i,s,c,u,l){if(this.write_in_progress=!0,e!==r.Z_NO_FLUSH&&e!==r.Z_PARTIAL_FLUSH&&e!==r.Z_SYNC_FLUSH&&e!==r.Z_FULL_FLUSH&&e!==r.Z_FINISH&&e!==r.Z_BLOCK)throw new Error("Invalid flush value");null==t&&(t=new n(0),s=0,i=0),c._set?c.set=c._set:c.set=f;var h=this.strm;switch(h.avail_in=s,h.input=t,h.next_in=i,h.avail_out=l,h.output=c,h.next_out=u,this.mode){case r.DEFLATE:case r.GZIP:case r.DEFLATERAW:var d=a.deflate(h,e);break;case r.UNZIP:case r.INFLATE:case r.GUNZIP:case r.INFLATERAW:d=o.inflate(h,e);break;default:throw new Error("Unknown mode "+this.mode)}return d!==r.Z_STREAM_END&&d!==r.Z_OK&&this._error(d),this.write_in_progress=!1,[h.avail_in,h.avail_out]},l.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===r.DEFLATE||this.mode===r.GZIP||this.mode===r.DEFLATERAW?a.deflateEnd(this.strm):o.inflateEnd(this.strm),this.mode=r.NONE)},l.prototype.reset=function(){switch(this.mode){case r.DEFLATE:case r.DEFLATERAW:var e=a.deflateReset(this.strm);break;case r.INFLATE:case r.INFLATERAW:e=o.inflateReset(this.strm)}e!==r.Z_OK&&this._error(e)},l.prototype._error=function(e){this.onerror(i[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()},r.Zlib=l}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib"}],[4251,{"./binding":4250,_process:5342,_stream_transform:5623,assert:1615,buffer:1996,util:2002},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){var i=e("_stream_transform"),s=e("./binding"),a=e("util"),o=e("assert").ok;function c(e,t,r){var i=[],s=0;function a(){for(var t;null!==(t=e.read());)i.push(t),s+=t.length;e.once("readable",a)}function o(){var t=n.concat(i,s);i=[],r(null,t),e.close()}e.on("error",(function(t){e.removeListener("end",o),e.removeListener("readable",a),r(t)})),e.on("end",o),e.end(t),a()}function u(e,t){if("string"==typeof t&&(t=new n(t)),!n.isBuffer(t))throw new TypeError("Not a string or buffer");var r=s.Z_FINISH;return e._processChunk(t,r)}function l(e){if(!(this instanceof l))return new l(e);_.call(this,e,s.DEFLATE)}function f(e){if(!(this instanceof f))return new f(e);_.call(this,e,s.INFLATE)}function h(e){if(!(this instanceof h))return new h(e);_.call(this,e,s.GZIP)}function d(e){if(!(this instanceof d))return new d(e);_.call(this,e,s.GUNZIP)}function p(e){if(!(this instanceof p))return new p(e);_.call(this,e,s.DEFLATERAW)}function g(e){if(!(this instanceof g))return new g(e);_.call(this,e,s.INFLATERAW)}function m(e){if(!(this instanceof m))return new m(e);_.call(this,e,s.UNZIP)}function _(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||r.Z_DEFAULT_CHUNK,i.call(this,e),e.flush&&e.flush!==s.Z_NO_FLUSH&&e.flush!==s.Z_PARTIAL_FLUSH&&e.flush!==s.Z_SYNC_FLUSH&&e.flush!==s.Z_FULL_FLUSH&&e.flush!==s.Z_FINISH&&e.flush!==s.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||s.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<r.Z_MIN_CHUNK||e.chunkSize>r.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<r.Z_MIN_WINDOWBITS||e.windowBits>r.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<r.Z_MIN_LEVEL||e.level>r.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<r.Z_MIN_MEMLEVEL||e.memLevel>r.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=r.Z_FILTERED&&e.strategy!=r.Z_HUFFMAN_ONLY&&e.strategy!=r.Z_RLE&&e.strategy!=r.Z_FIXED&&e.strategy!=r.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!n.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new s.Zlib(t);var a=this;this._hadError=!1,this._binding.onerror=function(e,t){a._binding=null,a._hadError=!0;var n=new Error(e);n.errno=t,n.code=r.codes[t],a.emit("error",n)};var o=r.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(o=e.level);var c=r.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(c=e.strategy),this._binding.init(e.windowBits||r.Z_DEFAULT_WINDOWBITS,o,e.memLevel||r.Z_DEFAULT_MEMLEVEL,c,e.dictionary),this._buffer=new n(this._chunkSize),this._offset=0,this._closed=!1,this._level=o,this._strategy=c,this.once("end",this.close)}s.Z_MIN_WINDOWBITS=8,s.Z_MAX_WINDOWBITS=15,s.Z_DEFAULT_WINDOWBITS=15,s.Z_MIN_CHUNK=64,s.Z_MAX_CHUNK=Infinity,s.Z_DEFAULT_CHUNK=16384,s.Z_MIN_MEMLEVEL=1,s.Z_MAX_MEMLEVEL=9,s.Z_DEFAULT_MEMLEVEL=8,s.Z_MIN_LEVEL=-1,s.Z_MAX_LEVEL=9,s.Z_DEFAULT_LEVEL=s.Z_DEFAULT_COMPRESSION,Object.keys(s).forEach((function(e){e.match(/^Z/)&&(r[e]=s[e])})),r.codes={Z_OK:s.Z_OK,Z_STREAM_END:s.Z_STREAM_END,Z_NEED_DICT:s.Z_NEED_DICT,Z_ERRNO:s.Z_ERRNO,Z_STREAM_ERROR:s.Z_STREAM_ERROR,Z_DATA_ERROR:s.Z_DATA_ERROR,Z_MEM_ERROR:s.Z_MEM_ERROR,Z_BUF_ERROR:s.Z_BUF_ERROR,Z_VERSION_ERROR:s.Z_VERSION_ERROR},Object.keys(r.codes).forEach((function(e){r.codes[r.codes[e]]=e})),r.Deflate=l,r.Inflate=f,r.Gzip=h,r.Gunzip=d,r.DeflateRaw=p,r.InflateRaw=g,r.Unzip=m,r.createDeflate=function(e){return new l(e)},r.createInflate=function(e){return new f(e)},r.createDeflateRaw=function(e){return new p(e)},r.createInflateRaw=function(e){return new g(e)},r.createGzip=function(e){return new h(e)},r.createGunzip=function(e){return new d(e)},r.createUnzip=function(e){return new m(e)},r.deflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new l(t),e,r)},r.deflateSync=function(e,t){return u(new l(t),e)},r.gzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new h(t),e,r)},r.gzipSync=function(e,t){return u(new h(t),e)},r.deflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new p(t),e,r)},r.deflateRawSync=function(e,t){return u(new p(t),e)},r.unzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new m(t),e,r)},r.unzipSync=function(e,t){return u(new m(t),e)},r.inflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new f(t),e,r)},r.inflateSync=function(e,t){return u(new f(t),e)},r.gunzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new d(t),e,r)},r.gunzipSync=function(e,t){return u(new d(t),e)},r.inflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),c(new g(t),e,r)},r.inflateRawSync=function(e,t){return u(new g(t),e)},a.inherits(_,i),_.prototype.params=function(e,n,i){if(e<r.Z_MIN_LEVEL||e>r.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(n!=r.Z_FILTERED&&n!=r.Z_HUFFMAN_ONLY&&n!=r.Z_RLE&&n!=r.Z_FIXED&&n!=r.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==e||this._strategy!==n){var a=this;this.flush(s.Z_SYNC_FLUSH,(function(){a._binding.params(e,n),a._hadError||(a._level=e,a._strategy=n,i&&i())}))}else t.nextTick(i)},_.prototype.reset=function(){return this._binding.reset()},_.prototype._flush=function(e){this._transform(new n(0),"",e)},_.prototype.flush=function(e,r){var i=this._writableState;if(("function"==typeof e||void 0===e&&!r)&&(r=e,e=s.Z_FULL_FLUSH),i.ended)r&&t.nextTick(r);else if(i.ending)r&&this.once("end",r);else if(i.needDrain){var a=this;this.once("drain",(function(){a.flush(r)}))}else this._flushFlag=e,this.write(new n(0),"",r)},_.prototype.close=function(e){if(e&&t.nextTick(e),!this._closed){this._closed=!0,this._binding.close();var r=this;t.nextTick((function(){r.emit("close")}))}},_.prototype._transform=function(e,t,r){var i,a=this._writableState,o=(a.ending||a.ended)&&(!e||a.length===e.length);if(null===!e&&!n.isBuffer(e))return r(new Error("invalid input"));o?i=s.Z_FINISH:(i=this._flushFlag,e.length>=a.length&&(this._flushFlag=this._opts.flush||s.Z_NO_FLUSH));this._processChunk(e,i,r)},_.prototype._processChunk=function(e,t,r){var i=e&&e.length,s=this._chunkSize-this._offset,a=0,c=this,u="function"==typeof r;if(!u){var l,f=[],h=0;this.on("error",(function(e){l=e}));do{var d=this._binding.writeSync(t,e,a,i,this._buffer,this._offset,s)}while(!this._hadError&&m(d[0],d[1]));if(this._hadError)throw l;var p=n.concat(f,h);return this.close(),p}var g=this._binding.write(t,e,a,i,this._buffer,this._offset,s);function m(l,d){if(!c._hadError){var p=s-d;if(o(p>=0,"have should not go down"),p>0){var g=c._buffer.slice(c._offset,c._offset+p);c._offset+=p,u?c.push(g):(f.push(g),h+=g.length)}if((0===d||c._offset>=c._chunkSize)&&(s=c._chunkSize,c._offset=0,c._buffer=new n(c._chunkSize)),0===d){if(a+=i-l,i=l,!u)return!0;var _=c._binding.write(t,e,a,i,c._buffer,c._offset,c._chunkSize);return _.callback=m,void(_.buffer=e)}if(!u)return!1;r()}}g.buffer=e,g.callback=m},a.inherits(l,_),a.inherits(f,_),a.inherits(h,_),a.inherits(d,_),a.inherits(p,_),a.inherits(g,_),a.inherits(m,_)}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib"}],[4252,{_process:5342,buffer:1996,"end-of-stream":2253,inherits:4319,"readable-stream":5622,"stream-shift":5816},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r,n){(function(){var i=e("readable-stream"),s=e("end-of-stream"),a=e("inherits"),o=e("stream-shift"),c=n.from&&n.from!==Uint8Array.from?n.from([0]):new n([0]),u=function(e,t){e._corked?e.once("uncork",t):t()},l=function(e,t){return function(r){r?function(e,t){e._autoDestroy&&e.destroy(t)}(e,"premature close"===r.message?null:r):t&&!e._ended&&e.end()}},f=function(e,t,r){if(!(this instanceof f))return new f(e,t,r);i.Duplex.call(this,r),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!r||!1!==r.autoDestroy,this._forwardDestroy=!r||!1!==r.destroy,this._forwardEnd=!r||!1!==r.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};a(f,i.Duplex),f.obj=function(e,t,r){return r||(r={}),r.objectMode=!0,r.highWaterMark=16,new f(e,t,r)},f.prototype.cork=function(){1==++this._corked&&this.emit("cork")},f.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},f.prototype.setWritable=function(e){if(this._unwrite&&this._unwrite(),this.destroyed)e&&e.destroy&&e.destroy();else if(null!==e&&!1!==e){var t=this,n=s(e,{writable:!0,readable:!1},l(this,this._forwardEnd)),i=function(){var e=t._ondrain;t._ondrain=null,e&&e()};this._unwrite&&r.nextTick(i),this._writable=e,this._writable.on("drain",i),this._unwrite=function(){t._writable.removeListener("drain",i),n()},this.uncork()}else this.end()},f.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)e&&e.destroy&&e.destroy();else{if(null===e||!1===e)return this.push(null),void this.resume();var t,r=this,n=s(e,{writable:!1,readable:!0},l(this)),a=function(){r._forward()},o=function(){r.push(null)};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(t=e,new i.Readable({objectMode:!0,highWaterMark:16}).wrap(t)),this._readable2.on("readable",a),this._readable2.on("end",o),this._unread=function(){r._readable2.removeListener("readable",a),r._readable2.removeListener("end",o),n()},this._forward()}},f.prototype._read=function(){this._drained=!0,this._forward()},f.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(e=o(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},f.prototype.destroy=function(e){if(!this.destroyed){this.destroyed=!0;var t=this;r.nextTick((function(){t._destroy(e)}))}},f.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},f.prototype._write=function(e,t,r){return this.destroyed?r():this._corked?u(this,this._write.bind(this,e,t,r)):e===c?this._finish(r):this._writable?void(!1===this._writable.write(e)?this._ondrain=r:r()):r()},f.prototype._finish=function(e){var t=this;this.emit("preend"),u(this,(function(){var r,n;r=t._forwardEnd&&t._writable,n=function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),u(t,e)},r?r._writableState&&r._writableState.finished?n():r._writableState?r.end(n):(r.end(),n()):n()}))},f.prototype.end=function(e,t,r){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this.write(c),i.Writable.prototype.end.call(this,r))},t.exports=f}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>gunzip-maybe>pumpify>duplexify"}],[4253,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){var t,r,n,i,s,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)s=e[t],a.set(s,i),i+=s.length;return a}},s={arraySet:function(e,t,r,n,i){for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4254,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r,n){for(var i=65535&e|0,s=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{s=s+(i=i+t[n++]|0)|0}while(--a);i%=65521,s%=65521}return i|s<<16|0}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4255,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4256,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var s=n,a=i+r;e^=-1;for(var o=i;o<a;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4257,{"../utils/common":4253,"./adler32":4254,"./crc32":4256,"./messages":4261,"./trees":4262},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=e("../utils/common"),s=e("./trees"),a=e("./adler32"),o=e("./crc32"),c=e("./messages"),u=-2,l=258,f=262,h=103,d=113,p=666;function g(e,t){return e.msg=c[t],t}function m(e){return(e<<1)-(e>4?9:0)}function _(e){for(var t=e.length;--t>=0;)e[t]=0}function b(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function y(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,b(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function w(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function E(e,t){var r,n,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,c=e.strstart>e.w_size-f?e.strstart-(e.w_size-f):0,u=e.window,h=e.w_mask,d=e.prev,p=e.strstart+l,g=u[s+a-1],m=u[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(u[(r=t)+a]===m&&u[r+a-1]===g&&u[r]===u[s]&&u[++r]===u[s+1]){s+=2,r++;do{}while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<p);if(n=l-(p-s),s=p-l,n>a){if(e.match_start=t,a=n,n>=o)break;g=u[s+a-1],m=u[s+a]}}}while((t=d[t&h])>c&&0!=--i);return a<=e.lookahead?a:e.lookahead}function k(e){var t,r,n,s,c,u,l,h,d,p,g=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=g+(g-f)){i.arraySet(e.window,e.window,g,g,0),e.match_start-=g,e.strstart-=g,e.block_start-=g,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=g?n-g:0}while(--r);t=r=g;do{n=e.prev[--t],e.prev[t]=n>=g?n-g:0}while(--r);s+=g}if(0===e.strm.avail_in)break;if(u=e.strm,l=e.window,h=e.strstart+e.lookahead,d=s,p=void 0,(p=u.avail_in)>d&&(p=d),r=0===p?0:(u.avail_in-=p,i.arraySet(l,u.input,u.next_in,p,h),1===u.state.wrap?u.adler=a(u.adler,l,p,h):2===u.state.wrap&&(u.adler=o(u.adler,l,p,h)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<f&&0!==e.strm.avail_in)}function S(e,t){for(var r,n;;){if(e.lookahead<f){if(k(e),e.lookahead<f&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-f&&(e.match_length=E(e,r)),e.match_length>=3)if(n=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function T(e,t){for(var r,n,i;;){if(e.lookahead<f){if(k(e),e.lookahead<f&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-f&&(e.match_length=E(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=s._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function A(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function x(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function P(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):g(e,u)}function I(e){var t,r=P(e);return 0===r&&((t=e.state).window_size=2*t.w_size,_(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function N(e,t,r,n,s,a){if(!e)return u;var o=1;if(-1===t&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||8!==r||n<8||n>15||t<0||t>9||a<0||a>4)return g(e,u);8===n&&(n=9);var c=new x;return e.state=c,c.strm=e,c.wrap=o,c.gzhead=null,c.w_bits=n,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=s+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<s+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=a,c.method=r,I(e)}n=[new A(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(k(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,y(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-f&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(y(e,!1),e.strm.avail_out),1)})),new A(4,4,8,4,S),new A(4,5,16,8,S),new A(4,6,32,32,S),new A(4,4,16,16,T),new A(8,16,32,32,T),new A(8,16,128,128,T),new A(8,32,128,256,T),new A(32,128,258,1024,T),new A(32,258,258,4096,T)],r.deflateInit=function(e,t){return N(e,t,8,15,8,0)},r.deflateInit2=N,r.deflateReset=I,r.deflateResetKeep=P,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,0):u},r.deflate=function(e,t){var r,i,a,c;if(!e||!e.state||t>5||t<0)return e?g(e,u):u;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===p&&4!==t)return g(e,0===e.avail_out?-5:u);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,v(i,31),v(i,139),v(i,8),i.gzhead?(v(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),v(i,255&i.gzhead.time),v(i,i.gzhead.time>>8&255),v(i,i.gzhead.time>>16&255),v(i,i.gzhead.time>>24&255),v(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),v(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(v(i,255&i.gzhead.extra.length),v(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=o(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(v(i,0),v(i,0),v(i,0),v(i,0),v(i,0),v(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),v(i,3),i.status=d);else{var f=8+(i.w_bits-8<<4)<<8;f|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(f|=32),f+=31-f%31,i.status=d,w(i,f),0!==i.strstart&&(w(i,e.adler>>>16),w(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),b(e),a=i.pending,i.pending!==i.pending_buf_size));)v(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),b(e),a=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,v(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),0===c&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),b(e),a=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,v(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),0===c&&(i.status=h)}else i.status=h;if(i.status===h&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&b(e),i.pending+2<=i.pending_buf_size&&(v(i,255&e.adler),v(i,e.adler>>8&255),e.adler=0,i.status=d)):i.status=d),0!==i.pending){if(b(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&m(t)<=m(r)&&4!==t)return g(e,-5);if(i.status===p&&0!==e.avail_in)return g(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&i.status!==p){var E=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(k(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,a,o=e.window;;){if(e.lookahead<=l){if(k(e),e.lookahead<=l&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=o[i=e.strstart-1])===o[++i]&&n===o[++i]&&n===o[++i]){a=e.strstart+l;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<a);e.match_length=l-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==E&&4!==E||(i.status=p),1===E||3===E)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===E&&(1===t?s._tr_align(i):5!==t&&(s._tr_stored_block(i,0,0,!1),3===t&&(_(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),b(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(v(i,255&e.adler),v(i,e.adler>>8&255),v(i,e.adler>>16&255),v(i,e.adler>>24&255),v(i,255&e.total_in),v(i,e.total_in>>8&255),v(i,e.total_in>>16&255),v(i,e.total_in>>24&255)):(w(i,e.adler>>>16),w(i,65535&e.adler)),b(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==h&&t!==d&&t!==p?g(e,u):(e.state=null,t===d?g(e,-3):0):u},r.deflateSetDictionary=function(e,t){var r,n,s,o,c,l,f,h,d=t.length;if(!e||!e.state)return u;if(2===(o=(r=e.state).wrap)||1===o&&42!==r.status||r.lookahead)return u;for(1===o&&(e.adler=a(e.adler,t,d,0)),r.wrap=0,d>=r.w_size&&(0===o&&(_(r.head),r.strstart=0,r.block_start=0,r.insert=0),h=new i.Buf8(r.w_size),i.arraySet(h,t,d-r.w_size,r.w_size,0),t=h,d=r.w_size),c=e.avail_in,l=e.next_in,f=e.input,e.avail_in=d,e.next_in=0,e.input=t,k(r);r.lookahead>=3;){n=r.strstart,s=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--s);r.strstart=n,r.lookahead=2,k(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=l,e.input=f,e.avail_in=c,r.wrap=o,0},r.deflateInfo="pako deflate (from Nodeca project)"}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4258,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){var r,n,i,s,a,o,c,u,l,f,h,d,p,g,m,_,b,y,v,w,E,k,S,T,A;r=e.state,n=e.next_in,T=e.input,i=n+(e.avail_in-5),s=e.next_out,A=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),c=r.dmax,u=r.wsize,l=r.whave,f=r.wnext,h=r.window,d=r.hold,p=r.bits,g=r.lencode,m=r.distcode,_=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{p<15&&(d+=T[n++]<<p,p+=8,d+=T[n++]<<p,p+=8),y=g[d&_];t:for(;;){if(d>>>=v=y>>>24,p-=v,0===(v=y>>>16&255))A[s++]=65535&y;else{if(!(16&v)){if(0==(64&v)){y=g[(65535&y)+(d&(1<<v)-1)];continue t}if(32&v){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&y,(v&=15)&&(p<v&&(d+=T[n++]<<p,p+=8),w+=d&(1<<v)-1,d>>>=v,p-=v),p<15&&(d+=T[n++]<<p,p+=8,d+=T[n++]<<p,p+=8),y=m[d&b];r:for(;;){if(d>>>=v=y>>>24,p-=v,!(16&(v=y>>>16&255))){if(0==(64&v)){y=m[(65535&y)+(d&(1<<v)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(E=65535&y,p<(v&=15)&&(d+=T[n++]<<p,(p+=8)<v&&(d+=T[n++]<<p,p+=8)),(E+=d&(1<<v)-1)>c){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=v,p-=v,E>(v=s-a)){if((v=E-v)>l&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(k=0,S=h,0===f){if(k+=u-v,v<w){w-=v;do{A[s++]=h[k++]}while(--v);k=s-E,S=A}}else if(f<v){if(k+=u+f-v,(v-=f)<w){w-=v;do{A[s++]=h[k++]}while(--v);if(k=0,f<w){w-=v=f;do{A[s++]=h[k++]}while(--v);k=s-E,S=A}}}else if(k+=f-v,v<w){w-=v;do{A[s++]=h[k++]}while(--v);k=s-E,S=A}for(;w>2;)A[s++]=S[k++],A[s++]=S[k++],A[s++]=S[k++],w-=3;w&&(A[s++]=S[k++],w>1&&(A[s++]=S[k++]))}else{k=s-E;do{A[s++]=A[k++],A[s++]=A[k++],A[s++]=A[k++],w-=3}while(w>2);w&&(A[s++]=A[k++],w>1&&(A[s++]=A[k++]))}break}}break}}while(n<i&&s<o);n-=w=p>>3,d&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<o?o-s+257:257-(s-o),r.hold=d,r.bits=p}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4259,{"../utils/common":4253,"./adler32":4254,"./crc32":4256,"./inffast":4258,"./inftrees":4260},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../utils/common"),i=e("./adler32"),s=e("./crc32"),a=e("./inffast"),o=e("./inftrees"),c=-2,u=12,l=30;function f(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):c}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):c}function g(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?c:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,p(e))):c}function m(e,t){var r,n;return e?(n=new h,e.state=n,n.window=null,0!==(r=g(e,t))&&(e.state=null),r):c}var _,b,y=!0;function v(e){if(y){var t;for(_=new n.Buf32(512),b=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,_,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,b,0,e.work,{bits:5}),y=!1}e.lencode=_,e.lenbits=9,e.distcode=b,e.distbits=5}function w(e,t,r,i){var s,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((s=a.wsize-a.wnext)>i&&(s=i),n.arraySet(a.window,t,r-i,s,a.wnext),(i-=s)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}r.inflateReset=p,r.inflateReset2=g,r.inflateResetKeep=d,r.inflateInit=function(e){return m(e,15)},r.inflateInit2=m,r.inflate=function(e,t){var r,h,d,p,g,m,_,b,y,E,k,S,T,A,x,P,I,N,C,R,O,L,D,B,M=0,U=new n.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;(r=e.state).mode===u&&(r.mode=13),g=e.next_out,d=e.output,_=e.avail_out,p=e.next_in,h=e.input,m=e.avail_in,b=r.hold,y=r.bits,E=m,k=_,L=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;y<16;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(2&r.wrap&&35615===b){r.check=0,U[0]=255&b,U[1]=b>>>8&255,r.check=s(r.check,U,2,0),b=0,y=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",r.mode=l;break}if(8!=(15&b)){e.msg="unknown compression method",r.mode=l;break}if(y-=4,O=8+(15&(b>>>=4)),0===r.wbits)r.wbits=O;else if(O>r.wbits){e.msg="invalid window size",r.mode=l;break}r.dmax=1<<O,e.adler=r.check=1,r.mode=512&b?10:u,b=0,y=0;break;case 2:for(;y<16;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(r.flags=b,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=l;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=l;break}r.head&&(r.head.text=b>>8&1),512&r.flags&&(U[0]=255&b,U[1]=b>>>8&255,r.check=s(r.check,U,2,0)),b=0,y=0,r.mode=3;case 3:for(;y<32;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}r.head&&(r.head.time=b),512&r.flags&&(U[0]=255&b,U[1]=b>>>8&255,U[2]=b>>>16&255,U[3]=b>>>24&255,r.check=s(r.check,U,4,0)),b=0,y=0,r.mode=4;case 4:for(;y<16;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}r.head&&(r.head.xflags=255&b,r.head.os=b>>8),512&r.flags&&(U[0]=255&b,U[1]=b>>>8&255,r.check=s(r.check,U,2,0)),b=0,y=0,r.mode=5;case 5:if(1024&r.flags){for(;y<16;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}r.length=b,r.head&&(r.head.extra_len=b),512&r.flags&&(U[0]=255&b,U[1]=b>>>8&255,r.check=s(r.check,U,2,0)),b=0,y=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((S=r.length)>m&&(S=m),S&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,h,p,S,O)),512&r.flags&&(r.check=s(r.check,h,S,p)),m-=S,p+=S,r.length-=S),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===m)break e;S=0;do{O=h[p+S++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O))}while(O&&S<m);if(512&r.flags&&(r.check=s(r.check,h,S,p)),m-=S,p+=S,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===m)break e;S=0;do{O=h[p+S++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O))}while(O&&S<m);if(512&r.flags&&(r.check=s(r.check,h,S,p)),m-=S,p+=S,O)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;y<16;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(b!==(65535&r.check)){e.msg="header crc mismatch",r.mode=l;break}b=0,y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=u;break;case 10:for(;y<32;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}e.adler=r.check=f(b),b=0,y=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=g,e.avail_out=_,e.next_in=p,e.avail_in=m,r.hold=b,r.bits=y,2;e.adler=r.check=1,r.mode=u;case u:if(5===t||6===t)break e;case 13:if(r.last){b>>>=7&y,y-=7&y,r.mode=27;break}for(;y<3;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}switch(r.last=1&b,y-=1,3&(b>>>=1)){case 0:r.mode=14;break;case 1:if(v(r),r.mode=20,6===t){b>>>=2,y-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=l}b>>>=2,y-=2;break;case 14:for(b>>>=7&y,y-=7&y;y<32;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",r.mode=l;break}if(r.length=65535&b,b=0,y=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(S=r.length){if(S>m&&(S=m),S>_&&(S=_),0===S)break e;n.arraySet(d,h,p,S,g),m-=S,p+=S,_-=S,g+=S,r.length-=S;break}r.mode=u;break;case 17:for(;y<14;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(r.nlen=257+(31&b),b>>>=5,y-=5,r.ndist=1+(31&b),b>>>=5,y-=5,r.ncode=4+(15&b),b>>>=4,y-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=l;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;y<3;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}r.lens[F[r.have++]]=7&b,b>>>=3,y-=3}for(;r.have<19;)r.lens[F[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,D={bits:r.lenbits},L=o(0,r.lens,0,19,r.lencode,0,r.work,D),r.lenbits=D.bits,L){e.msg="invalid code lengths set",r.mode=l;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;P=(M=r.lencode[b&(1<<r.lenbits)-1])>>>16&255,I=65535&M,!((x=M>>>24)<=y);){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(I<16)b>>>=x,y-=x,r.lens[r.have++]=I;else{if(16===I){for(B=x+2;y<B;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(b>>>=x,y-=x,0===r.have){e.msg="invalid bit length repeat",r.mode=l;break}O=r.lens[r.have-1],S=3+(3&b),b>>>=2,y-=2}else if(17===I){for(B=x+3;y<B;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}y-=x,O=0,S=3+(7&(b>>>=x)),b>>>=3,y-=3}else{for(B=x+7;y<B;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}y-=x,O=0,S=11+(127&(b>>>=x)),b>>>=7,y-=7}if(r.have+S>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=l;break}for(;S--;)r.lens[r.have++]=O}}if(r.mode===l)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=l;break}if(r.lenbits=9,D={bits:r.lenbits},L=o(1,r.lens,0,r.nlen,r.lencode,0,r.work,D),r.lenbits=D.bits,L){e.msg="invalid literal/lengths set",r.mode=l;break}if(r.distbits=6,r.distcode=r.distdyn,D={bits:r.distbits},L=o(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,D),r.distbits=D.bits,L){e.msg="invalid distances set",r.mode=l;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(m>=6&&_>=258){e.next_out=g,e.avail_out=_,e.next_in=p,e.avail_in=m,r.hold=b,r.bits=y,a(e,k),g=e.next_out,d=e.output,_=e.avail_out,p=e.next_in,h=e.input,m=e.avail_in,b=r.hold,y=r.bits,r.mode===u&&(r.back=-1);break}for(r.back=0;P=(M=r.lencode[b&(1<<r.lenbits)-1])>>>16&255,I=65535&M,!((x=M>>>24)<=y);){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(P&&0==(240&P)){for(N=x,C=P,R=I;P=(M=r.lencode[R+((b&(1<<N+C)-1)>>N)])>>>16&255,I=65535&M,!(N+(x=M>>>24)<=y);){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}b>>>=N,y-=N,r.back+=N}if(b>>>=x,y-=x,r.back+=x,r.length=I,0===P){r.mode=26;break}if(32&P){r.back=-1,r.mode=u;break}if(64&P){e.msg="invalid literal/length code",r.mode=l;break}r.extra=15&P,r.mode=22;case 22:if(r.extra){for(B=r.extra;y<B;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}r.length+=b&(1<<r.extra)-1,b>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;P=(M=r.distcode[b&(1<<r.distbits)-1])>>>16&255,I=65535&M,!((x=M>>>24)<=y);){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(0==(240&P)){for(N=x,C=P,R=I;P=(M=r.distcode[R+((b&(1<<N+C)-1)>>N)])>>>16&255,I=65535&M,!(N+(x=M>>>24)<=y);){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}b>>>=N,y-=N,r.back+=N}if(b>>>=x,y-=x,r.back+=x,64&P){e.msg="invalid distance code",r.mode=l;break}r.offset=I,r.extra=15&P,r.mode=24;case 24:if(r.extra){for(B=r.extra;y<B;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}r.offset+=b&(1<<r.extra)-1,b>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=l;break}r.mode=25;case 25:if(0===_)break e;if(S=k-_,r.offset>S){if((S=r.offset-S)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=l;break}S>r.wnext?(S-=r.wnext,T=r.wsize-S):T=r.wnext-S,S>r.length&&(S=r.length),A=r.window}else A=d,T=g-r.offset,S=r.length;S>_&&(S=_),_-=S,r.length-=S;do{d[g++]=A[T++]}while(--S);0===r.length&&(r.mode=21);break;case 26:if(0===_)break e;d[g++]=r.length,_--,r.mode=21;break;case 27:if(r.wrap){for(;y<32;){if(0===m)break e;m--,b|=h[p++]<<y,y+=8}if(k-=_,e.total_out+=k,r.total+=k,k&&(e.adler=r.check=r.flags?s(r.check,d,k,g-k):i(r.check,d,k,g-k)),k=_,(r.flags?b:f(b))!==r.check){e.msg="incorrect data check",r.mode=l;break}b=0,y=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;y<32;){if(0===m)break e;m--,b+=h[p++]<<y,y+=8}if(b!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=l;break}b=0,y=0}r.mode=29;case 29:L=1;break e;case l:L=-3;break e;case 31:return-4;default:return c}return e.next_out=g,e.avail_out=_,e.next_in=p,e.avail_in=m,r.hold=b,r.bits=y,(r.wsize||k!==e.avail_out&&r.mode<l&&(r.mode<27||4!==t))&&w(e,e.output,e.next_out,k-e.avail_out)?(r.mode=31,-4):(E-=e.avail_in,k-=e.avail_out,e.total_in+=E,e.total_out+=k,r.total+=k,r.wrap&&k&&(e.adler=r.check=r.flags?s(r.check,d,k,e.next_out-k):i(r.check,d,k,e.next_out-k)),e.data_type=r.bits+(r.last?64:0)+(r.mode===u?128:0)+(20===r.mode||15===r.mode?256:0),(0===E&&0===k||4===t)&&0===L&&(L=-5),L)},r.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?c:(r.head=t,t.done=!1,0):c},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?c:11===r.mode&&i(1,t,n,0)!==r.check?-3:w(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):c},r.inflateInfo="pako inflate (from Nodeca project)"}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4260,{"../utils/common":4253},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../utils/common"),i=15,s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,u,l,f,h,d){var p,g,m,_,b,y,v,w,E,k=d.bits,S=0,T=0,A=0,x=0,P=0,I=0,N=0,C=0,R=0,O=0,L=null,D=0,B=new n.Buf16(16),M=new n.Buf16(16),U=null,F=0;for(S=0;S<=i;S++)B[S]=0;for(T=0;T<u;T++)B[t[r+T]]++;for(P=k,x=i;x>=1&&0===B[x];x--);if(P>x&&(P=x),0===x)return l[f++]=20971520,l[f++]=20971520,d.bits=1,0;for(A=1;A<x&&0===B[A];A++);for(P<A&&(P=A),C=1,S=1;S<=i;S++)if(C<<=1,(C-=B[S])<0)return-1;if(C>0&&(0===e||1!==x))return-1;for(M[1]=0,S=1;S<i;S++)M[S+1]=M[S]+B[S];for(T=0;T<u;T++)0!==t[r+T]&&(h[M[t[r+T]]++]=T);if(0===e?(L=U=h,y=19):1===e?(L=s,D-=257,U=a,F-=257,y=256):(L=o,U=c,y=-1),O=0,T=0,S=A,b=f,I=P,N=0,m=-1,_=(R=1<<P)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){v=S-N,h[T]<y?(w=0,E=h[T]):h[T]>y?(w=U[F+h[T]],E=L[D+h[T]]):(w=96,E=0),p=1<<S-N,A=g=1<<I;do{l[b+(O>>N)+(g-=p)]=v<<24|w<<16|E|0}while(0!==g);for(p=1<<S-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,T++,0==--B[S]){if(S===x)break;S=t[r+h[T]]}if(S>P&&(O&_)!==m){for(0===N&&(N=P),b+=A,C=1<<(I=S-N);I+N<x&&!((C-=B[I+N])<=0);)I++,C<<=1;if(R+=1<<I,1===e&&R>852||2===e&&R>592)return 1;l[m=O&_]=P<<24|I<<16|b-f|0}}return 0!==O&&(l[b+O]=S-N<<24|64<<16|0),d.bits=P,0}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4261,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4262,{"../utils/common":4253},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../utils/common");function i(e){for(var t=e.length;--t>=0;)e[t]=0}var s=256,a=286,o=30,c=15,u=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],d=new Array(576);i(d);var p=new Array(60);i(p);var g=new Array(512);i(g);var m=new Array(256);i(m);var _=new Array(29);i(_);var b,y,v,w=new Array(o);function E(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function k(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function S(e){return e<256?g[e]:g[256+(e>>>7)]}function T(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,T(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function x(e,t,r){A(e,r[2*t],r[2*t+1])}function P(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function I(e,t,r){var n,i,s=new Array(16),a=0;for(n=1;n<=c;n++)s[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=P(s[o]++,o))}}function N(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?T(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function R(e,t,r,n){var i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]}function O(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&R(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!R(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function L(e,t,r){var n,i,a,o,c=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===n?x(e,i,t):(x(e,(a=m[i])+s+1,t),0!==(o=u[a])&&A(e,i-=_[a],o),x(e,a=S(--n),r),0!==(o=l[a])&&A(e,n-=w[a],o))}while(c<e.last_lit);x(e,256,t)}function D(e,t){var r,n,i,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,u=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<u;r++)0!==s[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=a[2*i+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)O(e,s,r);i=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],O(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*i]=s[2*r]+s[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=i,e.heap[1]=i++,O(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,s,a,o,u=t.dyn_tree,l=t.max_code,f=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,m=0;for(s=0;s<=c;s++)e.bl_count[s]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(s=u[2*u[2*(n=e.heap[r])+1]+1]+1)>g&&(s=g,m++),u[2*n+1]=s,n>l||(e.bl_count[s]++,a=0,n>=p&&(a=d[n-p]),o=u[2*n],e.opt_len+=o*(s+a),h&&(e.static_len+=o*(f[2*n+1]+a)));if(0!==m){do{for(s=g-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[g]--,m-=2}while(m>0);for(s=g;0!==s;s--)for(n=e.bl_count[s];0!==n;)(i=e.heap[--r])>l||(u[2*i+1]!==s&&(e.opt_len+=(s-u[2*i+1])*u[2*i],u[2*i+1]=s),n--)}}(e,t),I(s,l,e.bl_count)}function B(e,t,r){var n,i,s=-1,a=t[1],o=0,c=7,u=4;for(0===a&&(c=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++o<c&&i===a||(o<u?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=i,0===a?(c=138,u=3):i===a?(c=6,u=3):(c=7,u=4))}function M(e,t,r){var n,i,s=-1,a=t[1],o=0,c=7,u=4;for(0===a&&(c=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++o<c&&i===a)){if(o<u)do{x(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==s&&(x(e,i,e.bl_tree),o--),x(e,16,e.bl_tree),A(e,o-3,2)):o<=10?(x(e,17,e.bl_tree),A(e,o-3,3)):(x(e,18,e.bl_tree),A(e,o-11,7));o=0,s=i,0===a?(c=138,u=3):i===a?(c=6,u=3):(c=7,u=4)}}i(w);var U=!1;function F(e,t,r,i){A(e,0+(i?1:0),3),function(e,t,r,i){C(e),i&&(T(e,r),T(e,~r)),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}r._tr_init=function(e){U||(!function(){var e,t,r,n,i,s=new Array(16);for(r=0,n=0;n<28;n++)for(_[n]=r,e=0;e<1<<u[n];e++)m[r++]=n;for(m[r-1]=n,i=0,n=0;n<16;n++)for(w[n]=i,e=0;e<1<<l[n];e++)g[i++]=n;for(i>>=7;n<o;n++)for(w[n]=i<<7,e=0;e<1<<l[n]-7;e++)g[256+i++]=n;for(t=0;t<=c;t++)s[t]=0;for(e=0;e<=143;)d[2*e+1]=8,e++,s[8]++;for(;e<=255;)d[2*e+1]=9,e++,s[9]++;for(;e<=279;)d[2*e+1]=7,e++,s[7]++;for(;e<=287;)d[2*e+1]=8,e++,s[8]++;for(I(d,287,s),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=P(e,5);b=new E(d,u,257,a,c),y=new E(p,l,0,o,c),v=new E(new Array(0),f,0,19,7)}(),U=!0),e.l_desc=new k(e.dyn_ltree,b),e.d_desc=new k(e.dyn_dtree,y),e.bl_desc=new k(e.bl_tree,v),e.bi_buf=0,e.bi_valid=0,N(e)},r._tr_stored_block=F,r._tr_flush_block=function(e,t,r,n){var i,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<s;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),D(e,e.l_desc),D(e,e.d_desc),o=function(e){var t;for(B(e,e.dyn_ltree,e.l_desc.max_code),B(e,e.dyn_dtree,e.d_desc.max_code),D(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?F(e,t,r,n):4===e.strategy||a===i?(A(e,2+(n?1:0),3),L(e,d,p)):(A(e,4+(n?1:0),3),function(e,t,r,n){var i;for(A(e,t-257,5),A(e,r-1,5),A(e,n-4,4),i=0;i<n;i++)A(e,e.bl_tree[2*h[i]+1],3);M(e,e.dyn_ltree,t-1),M(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),L(e,e.dyn_ltree,e.dyn_dtree)),N(e),n&&C(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(m[r]+s+1)]++,e.dyn_dtree[2*S(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){A(e,2,3),x(e,256,d),function(e){16===e.bi_valid?(T(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4263,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4264,{"end-of-stream":2253,fs:1995,once:5229},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("once"),i=e("end-of-stream"),s=e("fs"),a=function(){},o=function(e){return"function"==typeof e},c=function(e,t,r,c){c=n(c);var u=!1;e.on("close",(function(){u=!0})),i(e,{readable:t,writable:r},(function(e){if(e)return c(e);u=!0,c()}));var l=!1;return function(t){if(!u&&!l)return l=!0,function(e){return!!s&&(e instanceof(s.ReadStream||a)||e instanceof(s.WriteStream||a))&&o(e.close)}(e)?e.close(a):function(e){return e.setHeader&&o(e.abort)}(e)?e.abort():o(e.destroy)?e.destroy():void c(t||new Error("stream was destroyed"))}},u=function(e){e()},l=function(e,t){return e.pipe(t)};t.exports=function(){var e,t=Array.prototype.slice.call(arguments),r=o(t[t.length-1]||a)&&t.pop()||a;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var n=t.map((function(i,s){var a=s<t.length-1;return c(i,a,s>0,(function(t){e||(e=t),t&&n.forEach(u),a||(n.forEach(u),r(e))}))}));return t.reduce(l)}}}},{package:"@metamask/snap-controllers>gunzip-maybe>pumpify>pump"}],[4265,{duplexify:4252,inherits:4319,pump:4264},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("pump"),i=e("inherits"),s=e("duplexify"),a=function(e){return e.length?Array.isArray(e[0])?e[0]:Array.prototype.slice.call(e):[]},o=function(e){var t=function(){var r=a(arguments);if(!(this instanceof t))return new t(r);s.call(this,null,null,e),r.length&&this.setPipeline(r)};return i(t,s),t.prototype.setPipeline=function(){var e=a(arguments),t=this,r=!1,i=e[0],s=e[e.length-1];s=s.readable?s:null,i=i.writable?i:null;var o=function(){e[0].emit("error",new Error("stream was destroyed"))};if(this.on("close",o),this.on("prefinish",(function(){r||t.cork()})),n(e,(function(e){if(t.removeListener("close",o),e)return t.destroy(e);r=!0,t.uncork()})),this.destroyed)return o();this.setWritable(i),this.setReadable(s)},t};t.exports=o({destroy:!1}),t.exports.obj=o({destroy:!1,objectMode:!0,highWaterMark:16})}}},{package:"@metamask/snap-controllers>gunzip-maybe>pumpify"}],[4266,{_process:5342,"readable-stream":5622,util:2002,xtend:6092},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,i=e("util").inherits,s=e("xtend");function a(e){n.call(this,e),this._destroyed=!1}function o(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=o),"function"!=typeof n&&(n=null),e(t,r,n)}}i(a,n),a.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new a(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=s(e,t),a.call(this,this.options)}return i(n,a),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new a(s({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>gunzip-maybe>through2"}],[4267,{"./consumable-hash":4269,"sparse-array":5783},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("sparse-array"),i=e("./consumable-hash"),s={bits:8};class a{constructor(e,t,r){if(this._options=Object.assign({},s,e),this._popCount=0,this._parent=t,this._posAtParent=r,!this._options.hashFn)throw new Error("please define an options.hashFn");this._options.hash||(this._options.hash=i(this._options.hashFn)),this._children=new n}static isBucket(e){return e instanceof a}async put(e,t){const r=await this._findNewBucketAndPos(e);await r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof a?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)if(t instanceof a)for(const e of t.eachLeafSeries())yield e;else yield t}serialize(e,t){return t(this._children.reduce(((r,n,i)=>(n&&(n instanceof a?r.push(n.serialize(e,t)):r.push(e(n,i))),r)),[]))}async asyncTransform(e,t){return l(this,e,t)}toJSON(){return this.serialize(c,u)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(r&&r.key===e)return r}async _findPlace(e){const t=this._options.hash(e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof a?n._findPlace(t):{bucket:this,pos:r,hash:t}}async _findNewBucketAndPos(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(r&&r.key!==e){const e=new a(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const n=await e._findPlace(r.hash);return n.bucket._putAt(n,r.key,r.value),e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(o);if(!(e instanceof a)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function o(e){return Boolean(e)}function c(e,t){return e.key}function u(e){return e}async function l(e,t,r){const n=[];for(const i of e._children.compactArray()){if(i instanceof a)await l(i,t,r);else{const r=await t(i);n.push({bitField:e._children.bitField(),children:r})}return r(n)}}t.exports=a}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4268,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=[255,254,252,248,240,224,192,128],i=[1,3,7,15,31,63,127,255];function s(e,t,r){const s=function(e,t){return n[e]&i[Math.min(t+e-1,7)]}(t,r);return(e&s)>>>t}t.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t);r=(r<<i)+s(e,n-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4269,{"../../is-buffer/index.js":4601,"./consumable-buffer":4268},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("./consumable-buffer");t.exports=function(e){return function(t){return t instanceof i?t:new i(t,e)}};class i{constructor(e,t){if("string"!=typeof e&&!r.isBuffer(e))throw new Error("can only hash strings or buffers");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth?this._value+this._depth:this._value,t=await this._hashFn(e),r=new n(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4270,{"./bucket":4267},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./bucket");t.exports=function(e){return new n(e)},t.exports.isBucket=n.isBucket}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4271,{buffer:1996,isarray:4272},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("isarray"),i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(n(t)){for(var i=0,o=t.length;i<o;i++)if(e(t[i]))return!0;return!1}if("function"==typeof r&&r.isBuffer&&r.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)&&e(t[c]))return!0;return!1}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io>has-binary2"}],[4272,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io>has-binary2>isarray"}],[4273,{},function(){with(this)return function(){"use strict";return function(e,t,r){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>has-cors"}],[4290,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),n=Object.create(null);function i(i,s){r[i]=s,++t>=e&&(t=0,n=r,r=Object.create(null))}return{has:function(e){return r[e]!==undefined||n[e]!==undefined},remove:function(e){r[e]!==undefined&&(r[e]=undefined),n[e]!==undefined&&(n[e]=undefined)},get:function(e){var t=r[e];return t!==undefined?t:(t=n[e])!==undefined?(i(e,t),t):void 0},set:function(e,t){r[e]!==undefined?r[e]=t:i(e,t)},clear:function(){r=Object.create(null),n=Object.create(null)}}}}}},{package:"3box>ipfs>libp2p-kad-dht>hashlru"}],[4293,{"./lib/heap":4294},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/heap")}}},{package:"3box>ipfs>libp2p-kad-dht>heap"}]],[],{});